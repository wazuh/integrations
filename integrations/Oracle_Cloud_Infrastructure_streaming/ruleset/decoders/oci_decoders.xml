<!-- OCI Custom Decoders -->
<decoder name="custom_oci">
    <prematch>^oci-stream-logs:\p"\.+"data":</prematch>
    <plugin_decoder offset="after_prematch">JSON_Decoder</plugin_decoder>
</decoder>

<decoder name="custom_oci_child">
    <parent>custom_oci</parent>
    <plugin_decoder offset="after_parent">JSON_Decoder</plugin_decoder>
</decoder>

<decoder name="custom_oci_child">
  <parent>custom_oci</parent>
  <regex>^oci-stream-logs:\p"@version":"(\d+)","oracle":\p"loggroupid":"(\.+)","compartmentid":"(\.+)","ingestedtime":"(\.+)","tenantid":"(\.+)"\p,"specversion":"(\.+)","dataschema":"(\.+)","id":"(\.+)","@timestamp":"(\.+)","source":"(\.*)","data"</regex>
  <order>version,oracle.loggroupid,oracle.compartmentid,oracle.ingestedtime,oracle.tenantid,specversion,dataschema,id,timeoci,source</order>
</decoder>

<decoder name="custom_oci_child">
  <parent>custom_oci</parent>
  <regex>"type":"(\.+)","time":"(\.+)"\p</regex>
  <order>type,ocitime</order>
</decoder>
