<!-- TYPE 3: DHCP_CLI Logs -->

<!-- Decoder father -->
<decoder name="fortif200_dhcp_cli">
    <prematch>DHCP_CLI[</prematch>
</decoder>

<!-- Sibling 1: IP extended -->
<decoder name="fortif200_dhcp_cli_fields">
    <parent>fortif200_dhcp_cli</parent>
    <regex>(\S+) DHCP_CLI</regex>
    <order>srcip_extended</order>
</decoder>

<!-- Sibling 2: IP -->
<decoder name="fortif200_dhcp_cli_fields">
    <parent>fortif200_dhcp_cli</parent>
    <regex type="pcre2">(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?=-\d+ DHCP_CLI)</regex>
    <order>srcip</order>
</decoder>

<!-- Sibling 3: Stack member -->
<decoder name="fortif200_dhcp_cli_fields">
    <parent>fortif200_dhcp_cli</parent>
    <regex>-(\d+) DHCP_CLI</regex>
    <order>stack_member</order>
</decoder>

<!-- Sibling 4: Process ID -->
<decoder name="fortif200_dhcp_cli_fields">
    <parent>fortif200_dhcp_cli</parent>
    <regex offset="after_parent">(\d+)</regex>
    <order>process_id</order>
</decoder>

<!-- Sibling 5: Device Timestamp -->
<decoder name="fortif200_dhcp_cli_fields">
    <parent>fortif200_dhcp_cli</parent>
    <regex>(\w+ \d+ \d+:\d+:\d+) \S+ DHCP_CLI</regex>
    <order>device_timestamp</order>
</decoder>

<!-- Sibling 6: Event Code -->
<decoder name="fortif200_dhcp_cli_fields">
    <parent>fortif200_dhcp_cli</parent>
    <regex>\) (\d+) %%</regex>
    <order>event_code</order>
</decoder>

<!-- Sibling 7: DHCP Action and Reason -->
<decoder name="fortif200_dhcp_cli_fields">
    <parent>fortif200_dhcp_cli</parent>
    <regex>%% (\w+ \w+ \w+ \w+ \w+ \w+ \w+ \w+); (\w+ \w+ \w+ \w+ \w+)</regex>
    <order>dhcp_action, dhcp_reason</order>
</decoder>

<!-- End of TYPE 3 -->
