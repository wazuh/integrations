# Security Configuration Assessment
# CIS Benchmark for Arch Linux
# Developed by Kevin David MuÃ±oz (MrHacker) Wazuh Ambassador
# Based on CIS Controls and adapted for Arch Linux Rolling Release
#
# This program is free software; you can redistribute it
# and/or modify it under the terms of the GNU General Public
# License (version 2) as published by the FSF - Free Software
# Foundation

policy:
  id: cis_arch_linux
  file: cis_arch_linux.yml
  name: CIS Benchmark for Arch Linux
  description: 'Security Configuration Assessment based on CIS Controls adapted for
    Arch Linux Rolling Release distribution.

    '
  references:
  - https://www.cisecurity.org/cis-benchmarks/
  - https://wiki.archlinux.org/title/Security
  - https://www.archlinux.org/
requirements:
  title: Check Arch Linux system requirements
  description: 'Requirements for running the SCA scan against Arch Linux systems.

    '
  condition: all
  rules:
  - f:/etc/arch-release
  - f:/etc/os-release -> r:ID=arch
  - f:/usr/bin/pacman

variables:
  $sshd_config: /etc/ssh/sshd_config
  $sysctl_files: /etc/sysctl.conf,/etc/sysctl.d/*.conf
  $pam_files: /etc/pam.d/system-auth,/etc/pam.d/system-login,/etc/pam.d/passwd
  $audit_conf: /etc/audit/auditd.conf
  $journald_conf: /etc/systemd/journald.conf
  $grub_cfg: /boot/grub/grub.cfg
  $pacman_conf: /etc/pacman.conf
  $passwd_file: /etc/passwd
  $shadow_file: /etc/shadow
  $group_file: /etc/group
  $gshadow_file: /etc/gshadow
checks:
- id: 1001
  title: CIS 3.1.1 - Disable unused network protocols
  description: Ensure unused network protocols are disabled.
  rationale: 'If the protocol is not being used, it is recommended that kernel module
    not be loaded, disabling the service to reduce the potential attack surface.

    '
  remediation: 'Add ''install <protocol> /bin/true'' to a file in /etc/modprobe.d/

    '
  compliance:
  - cis:
    - 3.1.1
  - pci_dss:
    - 2.2.3
  condition: all
  rules:
  - c:lsmod -> !r:dccp
  - c:lsmod -> !r:sctp
  - c:lsmod -> !r:rds
  - c:lsmod -> !r:tipc
- id: 1002
  title: CIS 3.2.1 - Ensure IP forwarding is disabled
  description: 'The net.ipv4.ip_forward flag is used to tell the system whether it
    can forward packets or not.

    '
  rationale: 'Setting the flag to 0 ensures that a system with multiple interfaces
    (for example, a hard proxy), will never be able to forward packets, and therefore,
    never serve as a router.

    '
  remediation: 'Set net.ipv4.ip_forward = 0 and net.ipv6.conf.all.forwarding = 0 in
    /etc/sysctl.conf

    '
  compliance:
  - cis:
    - 3.2.1
  - nist_800_53:
    - CM.1
  condition: all
  rules:
  - c:sysctl net.ipv4.ip_forward -> r:^net.ipv4.ip_forward\s*=\s*0$
  - c:sysctl net.ipv6.conf.all.forwarding -> r:^net.ipv6.conf.all.forwarding\s*=\s*0$
- id: 1003
  title: CIS 3.2.2 - Ensure packet redirect sending is disabled
  description: 'ICMP Redirects are used to send routing information to other hosts.

    '
  rationale: 'An attacker could use a compromised host to send invalid ICMP redirects
    to other router devices in an attempt to corrupt routing and have users access
    a system set up by the attacker as opposed to a valid system.

    '
  remediation: 'Set net.ipv4.conf.all.send_redirects = 0 and net.ipv4.conf.default.send_redirects
    = 0 in sysctl

    '
  compliance:
  - cis:
    - 3.2.2
  condition: all
  rules:
  - c:sysctl net.ipv4.conf.all.send_redirects -> r:^net.ipv4.conf.all.send_redirects\s*=\s*0$
  - c:sysctl net.ipv4.conf.default.send_redirects -> r:^net.ipv4.conf.default.send_redirects\s*=\s*0$
- id: 2001
  title: CIS 3.2.3 - Ensure source routed packets are not accepted
  description: 'In networking, source routing allows a sender to partially or fully
    specify the route packets take through a network.

    '
  rationale: 'Setting net.ipv4.conf.all.accept_source_route and net.ipv6.conf.all.accept_source_route
    to 0 disables the system from accepting source routed packets.

    '
  remediation: 'Set net.ipv4.conf.all.accept_source_route = 0 and net.ipv6.conf.all.accept_source_route
    = 0

    '
  compliance:
  - cis:
    - 3.2.3
  condition: all
  rules:
  - c:sysctl net.ipv4.conf.all.accept_source_route -> r:^net.ipv4.conf.all.accept_source_route\s*=\s*0$
  - c:sysctl net.ipv6.conf.all.accept_source_route -> r:^net.ipv6.conf.all.accept_source_route\s*=\s*0$
- id: 2002
  title: CIS 3.2.4 - Ensure ICMP redirects are not accepted
  description: 'ICMP redirect messages are packets that convey routing information
    and tell your host to send packets via an alternate path.

    '
  rationale: 'Attackers could use bogus ICMP redirect messages to maliciously alter
    the system routing tables and get them to send packets to incorrect networks and
    allow your system packets to be captured.

    '
  remediation: 'Set net.ipv4.conf.all.accept_redirects = 0 and net.ipv6.conf.all.accept_redirects
    = 0

    '
  compliance:
  - cis:
    - 3.2.4
  condition: all
  rules:
  - c:sysctl net.ipv4.conf.all.accept_redirects -> r:^net.ipv4.conf.all.accept_redirects\s*=\s*0$
  - c:sysctl net.ipv6.conf.all.accept_redirects -> r:^net.ipv6.conf.all.accept_redirects\s*=\s*0$
- id: 3001
  title: CIS 4.1.1 - Ensure auditing is enabled
  description: Turn on the auditd daemon to record system events.
  rationale: 'The capturing of system events provides system administrators with information
    to allow them to determine if unauthorized access to their system is occurring.

    '
  remediation: Install audit package and enable auditd service
  compliance:
  - cis:
    - 4.1.1
  - pci_dss:
    - '10.1'
    - '10.7'
  condition: all
  rules:
  - c:pacman -Q audit
  - c:systemctl is-enabled auditd -> r:^enabled
  - c:systemctl is-active auditd -> r:^active
- id: 3002
  title: CIS 4.2.1 - Ensure journald is configured to send logs to rsyslog
  description: 'Data from journald may be stored in volatile memory or persisted locally
    on the server.

    '
  rationale: 'Storing log data on a remote host protects log integrity from local
    attacks.

    '
  remediation: Set ForwardToSyslog=yes in /etc/systemd/journald.conf
  compliance:
  - cis:
    - 4.2.1
  condition: any
  rules:
  - f:$journald_conf -> !r:^# && r:^ForwardToSyslog=yes
  - f:$journald_conf -> !r:^# && r:^Storage=persistent
- id: 3003
  title: CIS 4.2.2 - Ensure journald is configured to compress large log files
  description: 'The journald system includes the capability of compressing overly
    large files to avoid filling up the system with logs or making the logs unmanageable.

    '
  rationale: 'Uncompressed large files may unexpectedly fill a filesystem leading
    to availability issues.

    '
  remediation: Set Compress=yes in /etc/systemd/journald.conf
  compliance:
  - cis:
    - 4.2.2
  condition: all
  rules:
  - f:$journald_conf -> !r:^# && r:^Compress=yes
- id: 4001
  title: CIS 5.1.1 - Ensure cron daemon is enabled
  description: The cron daemon is used to execute batch jobs on the system.
  rationale: 'While there may not be user jobs that need to be run on the system,
    the system does have maintenance jobs that may include security monitoring that
    have to run, and cron is used to execute them.

    '
  remediation: Enable cronie service
  compliance:
  - cis:
    - 5.1.1
  condition: all
  rules:
  - c:pacman -Q cronie
  - c:systemctl is-enabled cronie -> r:^enabled
- id: 4002
  title: CIS 5.2.1 - Ensure permissions on /etc/ssh/sshd_config are configured
  description: 'The /etc/ssh/sshd_config file contains configuration parameters for
    sshd.

    '
  rationale: 'If this file is writable by a group or other users, then an unprivileged
    user could make configuration changes.

    '
  remediation: 'chown root:root /etc/ssh/sshd_config and chmod 600 /etc/ssh/sshd_config

    '
  compliance:
  - cis:
    - 5.2.1
  condition: all
  rules:
  - c:stat -c %a /etc/ssh/sshd_config -> r:^600$
  - c:stat -c %U:%G /etc/ssh/sshd_config -> r:^root:root$
- id: 4003
  title: CIS 5.2.4 - Ensure SSH X11 forwarding is disabled
  description: 'The X11Forwarding parameter provides the ability to tunnel X11 traffic
    through the connection to enable remote graphic connections.

    '
  rationale: 'Disable X11 forwarding unless there is an operational requirement to
    use X11 applications directly.

    '
  remediation: Set X11Forwarding no in /etc/ssh/sshd_config
  compliance:
  - cis:
    - 5.2.4
  condition: all
  rules:
  - f:$sshd_config -> !r:^# && r:^X11Forwarding\s+no
- id: 4004
  title: CIS 5.2.5 - Ensure SSH MaxAuthTries is set to 4 or less
  description: 'The MaxAuthTries parameter specifies the maximum number of authentication
    attempts permitted per connection.

    '
  rationale: 'Setting the MaxAuthTries parameter to a low number will minimize the
    risk of successful brute force attacks to the SSH server.

    '
  remediation: Set MaxAuthTries 4 in /etc/ssh/sshd_config
  compliance:
  - cis:
    - 5.2.5
  condition: all
  rules:
  - f:$sshd_config -> n:^MaxAuthTries\s+(\d+) compare <= 4
- id: 4005
  title: CIS 5.2.6 - Ensure SSH IgnoreRhosts is enabled
  description: 'The IgnoreRhosts parameter specifies that .rhosts and .shosts files
    will not be used in RhostsRSAAuthentication or HostbasedAuthentication.

    '
  rationale: 'Setting this parameter forces users to enter a password when authenticating
    with ssh.

    '
  remediation: Set IgnoreRhosts yes in /etc/ssh/sshd_config
  compliance:
  - cis:
    - 5.2.6
  condition: all
  rules:
  - f:$sshd_config -> !r:^# && r:^IgnoreRhosts\s+yes
- id: 4006
  title: CIS 5.2.7 - Ensure SSH HostbasedAuthentication is disabled
  description: 'The HostbasedAuthentication parameter specifies if authentication
    is allowed through trusted hosts via the user of .rhosts, or /etc/hosts.equiv.

    '
  rationale: 'Even though the .rhosts files are ineffective if support is disabled
    in /etc/pam.conf, disabling the ability to use .rhosts files in SSH provides an
    additional layer of protection.

    '
  remediation: Set HostbasedAuthentication no in /etc/ssh/sshd_config
  compliance:
  - cis:
    - 5.2.7
  condition: all
  rules:
  - f:$sshd_config -> !r:^# && r:^HostbasedAuthentication\s+no
- id: 4007
  title: CIS 5.2.8 - Ensure SSH root login is disabled
  description: 'The PermitRootLogin parameter specifies if the root user can log in
    using ssh.

    '
  rationale: 'Disallowing root logins over SSH requires system admins to authenticate
    using their own individual account, then escalating to root via sudo or su.

    '
  remediation: Set PermitRootLogin no in /etc/ssh/sshd_config
  compliance:
  - cis:
    - 5.2.8
  condition: all
  rules:
  - f:$sshd_config -> !r:^# && r:^PermitRootLogin\s+no
- id: 4008
  title: CIS 5.2.10 - Ensure SSH PermitUserEnvironment is disabled
  description: 'The PermitUserEnvironment option allows users to present environment
    options to the ssh daemon.

    '
  rationale: 'Permitting users the ability to set environment variables through the
    SSH daemon could potentially allow users to bypass security controls.

    '
  remediation: Set PermitUserEnvironment no in /etc/ssh/sshd_config
  compliance:
  - cis:
    - 5.2.10
  condition: all
  rules:
  - f:$sshd_config -> !r:^# && r:^PermitUserEnvironment\s+no
- id: 5001
  title: CIS 5.3.1 - Ensure password creation requirements are configured
  description: The pam_pwquality.so module checks the strength of passwords.
  rationale: 'Strong passwords protect systems from being hacked through brute force
    methods.

    '
  remediation: Install libpwquality and configure in PAM
  compliance:
  - cis:
    - 5.3.1
  - pci_dss:
    - 8.2.3
  condition: all
  rules:
  - c:pacman -Q libpwquality
  - f:/etc/pam.d/passwd -> r:pam_pwquality\.so
- id: 5002
  title: CIS 5.4.1.1 - Ensure password expiration is 365 days or less
  description: 'The PASS_MAX_DAYS parameter in /etc/login.defs allows an administrator
    to force passwords to expire once they reach a defined age.

    '
  rationale: 'The window of opportunity for an attacker to leverage compromised credentials
    or successfully compromise credentials via an online brute force attack is limited
    by the age of the password.

    '
  remediation: Set PASS_MAX_DAYS 365 in /etc/login.defs
  compliance:
  - cis:
    - 5.4.1.1
  condition: all
  rules:
  - f:/etc/login.defs -> n:^PASS_MAX_DAYS\s+(\d+) compare <= 365
- id: 5003
  title: CIS 5.4.1.2 - Ensure minimum days between password changes is 7 or more
  description: 'The PASS_MIN_DAYS parameter in /etc/login.defs allows an administrator
    to prevent users from changing their password until a minimum number of days have
    passed since the last time the user changed their password.

    '
  rationale: 'By restricting the frequency of password changes, an administrator can
    prevent users from repeatedly changing their password in an attempt to circumvent
    password reuse controls.

    '
  remediation: Set PASS_MIN_DAYS 7 in /etc/login.defs
  compliance:
  - cis:
    - 5.4.1.2
  condition: all
  rules:
  - f:/etc/login.defs -> n:^PASS_MIN_DAYS\s+(\d+) compare >= 7
- id: 6001
  title: CIS 6.1.2 - Ensure permissions on /etc/passwd are configured
  description: 'The /etc/passwd file contains user account information that is used
    by many system utilities and therefore must be readable for these utilities to
    operate.

    '
  rationale: 'If attackers can gain read access to the /etc/passwd file, they can
    easily run a password cracking program against the hashed passwords to break them.

    '
  remediation: chown root:root /etc/passwd and chmod 644 /etc/passwd
  compliance:
  - cis:
    - 6.1.2
  condition: all
  rules:
  - c:stat -c %a $passwd_file -> r:^644$
  - c:stat -c %U:%G $passwd_file -> r:^root:root$
- id: 6002
  title: CIS 6.1.3 - Ensure permissions on /etc/shadow are configured
  description: 'The /etc/shadow file is used to store the information about user accounts
    that is critical to the security of those accounts, such as the hashed password
    and other security information.

    '
  rationale: 'If attackers can gain read access to the /etc/shadow file, they can
    easily run a password cracking program against the hashed passwords to break them.

    '
  remediation: chown root:shadow /etc/shadow and chmod 640 /etc/shadow
  compliance:
  - cis:
    - 6.1.3
  condition: all
  rules:
  - c:stat -c %a $shadow_file -> r:^640$
  - c:stat -c %U:%G $shadow_file -> r:^root:shadow$
- id: 6003
  title: CIS 6.1.4 - Ensure permissions on /etc/group are configured
  description: 'The /etc/group file contains a list of all the valid groups defined
    in the system.

    '
  rationale: 'The /etc/group file needs to be protected from unauthorized changes
    by non-privileged users, but needs to be readable as many command utilities use
    it to map a group ID to a group name.

    '
  remediation: chown root:root /etc/group and chmod 644 /etc/group
  compliance:
  - cis:
    - 6.1.4
  condition: all
  rules:
  - c:stat -c %a $group_file -> r:^644$
  - c:stat -c %U:%G $group_file -> r:^root:root$
- id: 6004
  title: CIS 6.1.5 - Ensure permissions on /etc/gshadow are configured
  description: 'The /etc/gshadow file is used to store the information about groups
    that is critical to the security of those accounts, such as the hashed password
    and other security information.

    '
  rationale: 'If attackers can gain read access to the /etc/gshadow file, they can
    easily run a password cracking program against the hashed passwords to break them.

    '
  remediation: chown root:shadow /etc/gshadow and chmod 640 /etc/gshadow
  compliance:
  - cis:
    - 6.1.5
  condition: all
  rules:
  - c:stat -c %a $gshadow_file -> r:^640$
  - c:stat -c %U:%G $gshadow_file -> r:^root:shadow$
- id: 7001
  title: Arch Linux - Ensure pacman package signatures are required
  description: 'Pacman should verify package signatures to ensure package integrity.

    '
  rationale: 'Package signature verification helps ensure that packages have not been
    tampered with and come from trusted sources.

    '
  remediation: Set SigLevel = Required DatabaseOptional in /etc/pacman.conf
  compliance:
  - cis_arch:
    - '7.1'
  condition: all
  rules:
  - f:$pacman_conf -> !r:^# && r:^SigLevel.*Required
- id: 7002
  title: Arch Linux - Ensure system is up to date
  description: 'The system should be regularly updated with the latest security patches.

    '
  rationale: 'Installing security updates is a fundamental security practice to protect
    against known vulnerabilities.

    '
  remediation: Run pacman -Syu regularly to update the system
  compliance:
  - cis_arch:
    - '7.2'
  condition: all
  rules:
  - c:pacman -Qu -> r:^$
- id: 7003
  title: Arch Linux - Ensure no orphaned packages exist
  description: 'Orphaned packages are packages that were installed as dependencies
    but are no longer required by any installed package.

    '
  rationale: 'Removing orphaned packages reduces the attack surface and frees up disk
    space.

    '
  remediation: Run pacman -Qtdq | pacman -Rns - to remove orphaned packages
  compliance:
  - cis_arch:
    - '7.3'
  condition: all
  rules:
  - c:pacman -Qtdq -> r:^$
- id: 7004
  title: Arch Linux - Ensure bootloader is password protected
  description: 'The bootloader should be configured with a password to prevent unauthorized
    system modifications.

    '
  rationale: 'An unprotected bootloader allows an attacker to modify boot parameters
    or boot from removable media.

    '
  remediation: 'Configure GRUB with a password or use systemd-boot with secure boot

    '
  compliance:
  - cis_arch:
    - '7.4'
  condition: any
  rules:
  - f:$grub_cfg -> r:password
  - c:bootctl status -> r:Secure Boot.*enabled
- id: 7005
  title: Arch Linux - Ensure tmpfiles.d is properly configured
  description: 'systemd-tmpfiles should be configured to clean temporary files securely.

    '
  rationale: 'Proper temporary file management prevents information disclosure and
    ensures system cleanliness.

    '
  remediation: Review and configure /etc/tmpfiles.d/ files appropriately
  compliance:
  - cis_arch:
    - '7.5'
  condition: all
  rules:
  - d:/etc/tmpfiles.d
  - c:systemctl is-enabled systemd-tmpfiles-clean.timer -> r:^enabled$
- id: 8001
  title: SystemD - Ensure core dumps are restricted
  description: A core dump is the memory of an executable program.
  rationale: 'Core dumps may contain sensitive information and should be restricted.

    '
  remediation: Configure systemd to limit core dumps
  compliance:
  - cis:
    - 1.5.1
  condition: all
  rules:
  - c:systemctl show systemd-coredump | grep -i limitcore -> r:LimitCORE=0
  - f:/etc/systemd/coredump.conf -> !r:^# && r:^Storage=none
- id: 8002
  title: SystemD - Ensure address space layout randomization is enabled
  description: 'Address space layout randomization (ASLR) is an exploit mitigation
    technique.

    '
  rationale: 'Randomly placing virtual memory regions will make it difficult to write
    memory page exploits as the memory placement will be consistently shifting.

    '
  remediation: Set kernel.randomize_va_space = 2
  compliance:
  - cis:
    - 1.5.3
  condition: all
  rules:
  - c:sysctl kernel.randomize_va_space -> r:kernel.randomize_va_space = 2
- id: 8003
  title: SystemD - Ensure prelink is disabled
  description: 'Prelink is a program that modifies ELF shared libraries and ELF dynamically
    linked binaries.

    '
  rationale: 'The prelinking feature can interfere with the operation of AIDE, because
    it changes binaries.

    '
  remediation: Ensure prelink is not installed
  compliance:
  - cis:
    - 1.5.4
  condition: all
  rules:
  - not c:pacman -Q prelink
- id: 9001
  title: Network - Ensure xinetd is not installed
  description: 'The eXtended InterNET Daemon (xinetd) is an open source super daemon.

    '
  rationale: 'If there are no xinetd services required, it is recommended that the
    daemon be disabled.

    '
  remediation: Remove xinetd package
  compliance:
  - cis:
    - 2.1.1
  condition: all
  rules:
  - not c:pacman -Q xinetd
- id: 9002
  title: Network - Ensure openbsd-inetd is not installed
  description: 'The inetd daemon listens for network requests and spawns the appropriate
    service for that request.

    '
  rationale: 'If there are no inetd services required, it is recommended that the
    daemon be removed.

    '
  remediation: Remove openbsd-inetd package
  compliance:
  - cis:
    - 2.1.2
  condition: all
  rules:
  - not c:pacman -Q openbsd-inetd
- id: 9003
  title: Network - Ensure unnecessary services are not enabled
  description: 'Legacy network services that use unencrypted authentication should
    not be enabled.

    '
  rationale: 'These services provide unencrypted remote access and are therefore subject
    to interception.

    '
  remediation: Disable or remove unnecessary network services
  compliance:
  - cis:
    - '2.2'
  condition: all
  rules:
  - not c:systemctl is-enabled telnet.socket
  - not c:systemctl is-enabled rsh.socket
  - not c:systemctl is-enabled rlogin.socket
  - not c:systemctl is-enabled vsftpd
- id: 10001
  title: Firewall - Ensure iptables is installed
  description: 'iptables allows configuration of the IPv4 tables in the linux kernel
    firewall.

    '
  rationale: 'Without a firewall, it may be possible for unauthorized users to access
    system services.

    '
  remediation: Install iptables
  compliance:
  - cis:
    - 3.5.1.1
  condition: any
  rules:
  - c:pacman -Q iptables
  - c:pacman -Q nftables
- id: 10002
  title: Firewall - Ensure default deny firewall policy
  description: 'A default deny all policy on connections ensures that any unconfigured
    network usage will be rejected.

    '
  rationale: 'With a default accept policy the firewall will accept any packet that
    is not configured to be denied.

    '
  remediation: Configure iptables default policies to DROP
  compliance:
  - cis:
    - 3.5.1.3
  condition: any
  rules:
  - c:iptables -L INPUT -> r:policy DROP
  - c:nft list table inet filter -> r:policy drop
- id: 11001
  title: Services - Ensure NFS and RPC are not enabled
  description: 'The Network File System (NFS) is one of the first and most widely
    distributed file systems in the UNIX environment.

    '
  rationale: 'If the system does not export NFS shares or act as an NFS client, it
    is recommended that these services be disabled to reduce remote attack surface.

    '
  remediation: Disable nfs-server and rpcbind services
  compliance:
  - cis:
    - 2.2.5
  condition: all
  rules:
  - not c:systemctl is-enabled nfs-server
  - not c:systemctl is-enabled rpcbind
- id: 11002
  title: Services - Ensure DNS Server is not enabled
  description: 'The Domain Name System (DNS) is a hierarchical naming system that
    maps names to IP addresses for computers, services and other resources connected
    to a network.

    '
  rationale: 'Unless a system is specifically designated to act as a DNS server, it
    is recommended that the package be deleted to reduce the potential attack surface.

    '
  remediation: Disable named service
  compliance:
  - cis:
    - 2.2.6
  condition: all
  rules:
  - not c:systemctl is-enabled named
  - not c:systemctl is-enabled bind9
- id: 11003
  title: Services - Ensure FTP Server is not enabled
  description: 'The File Transfer Protocol (FTP) provides networked computers with
    the ability to transfer files.

    '
  rationale: 'FTP does not protect the confidentiality of data or authentication credentials.
    It is recommended sftp be used if file transfer is required.

    '
  remediation: Disable vsftpd service
  compliance:
  - cis:
    - 2.2.7
  condition: all
  rules:
  - not c:systemctl is-enabled vsftpd
  - not c:systemctl is-enabled proftpd
- id: 11004
  title: Services - Ensure HTTP server is not enabled
  description: 'HTTP or web servers provide the ability to host web site content.

    '
  rationale: 'Unless there is a need to run the system as a web server, it is recommended
    that the package be deleted to reduce the potential attack surface.

    '
  remediation: Disable httpd/apache2/nginx services
  compliance:
  - cis:
    - 2.2.8
  condition: all
  rules:
  - not c:systemctl is-enabled httpd
  - not c:systemctl is-enabled apache2
  - not c:systemctl is-enabled nginx
- id: 11005
  title: Services - Ensure IMAP and POP3 server is not enabled
  description: 'dovecot is an open source IMAP and POP3 server for Linux based systems.

    '
  rationale: 'Unless POP3 and/or IMAP servers are to be provided by this system, it
    is recommended that the package be removed to reduce the potential attack surface.

    '
  remediation: Disable dovecot service
  compliance:
  - cis:
    - 2.2.9
  condition: all
  rules:
  - not c:systemctl is-enabled dovecot
- id: 11006
  title: Services - Ensure Samba is not enabled
  description: 'The Samba daemon allows system administrators to configure their Linux
    systems to share file systems and directories with Windows desktops.

    '
  rationale: 'If there is no need to mount directories and file systems to Windows
    systems, then this package can be removed to reduce the potential attack surface.

    '
  remediation: Disable smb service
  compliance:
  - cis:
    - 2.2.10
  condition: all
  rules:
  - not c:systemctl is-enabled smb
  - not c:systemctl is-enabled nmb
- id: 11007
  title: Services - Ensure HTTP Proxy Server is not enabled
  description: 'Squid is a standard proxy server used in many distributions and environments.

    '
  rationale: 'If there is no need for a proxy server, it is recommended that the squid
    proxy be deleted to reduce the potential attack surface.

    '
  remediation: Disable squid service
  compliance:
  - cis:
    - 2.2.11
  condition: all
  rules:
  - not c:systemctl is-enabled squid
- id: 11008
  title: Services - Ensure SNMP Server is not enabled
  description: 'The Simple Network Management Protocol (SNMP) server is used to listen
    for SNMP commands from an SNMP management system, execute the commands or collect
    the information and then send results back to the requesting system.

    '
  rationale: 'The SNMP server can communicate using SNMP v1, which transmits data
    in the clear and does not require authentication to execute commands.

    '
  remediation: Disable snmpd service
  compliance:
  - cis:
    - 2.2.12
  condition: all
  rules:
  - not c:systemctl is-enabled snmpd
- id: 12001
  title: MTA - Ensure mail transfer agent is configured for local-only mode
  description: 'Mail Transfer Agents (MTA), such as sendmail and Postfix, are used
    to listen for incoming mail and transfer the messages to the appropriate user
    or mail server.

    '
  rationale: 'The software for all Mail Transfer Agents is complex and most have a
    long history of security issues.

    '
  remediation: Configure postfix/sendmail for local delivery only
  compliance:
  - cis:
    - 2.2.15
  condition: any
  rules:
  - not c:systemctl is-enabled postfix
  - f:/etc/postfix/main.cf -> !r:^# && r:^inet_interfaces\s*=\s*localhost
  - not c:systemctl is-enabled sendmail
- id: 13001
  title: Filesystem - Ensure separate partition exists for /tmp
  description: 'The /tmp directory is a world-writable directory used for temporary
    storage by all users and some applications.

    '
  rationale: 'Since the /tmp directory is intended to be world-writable, there is
    a risk of resource exhaustion if it is not bound to a separate partition.

    '
  remediation: Create separate partition for /tmp
  compliance:
  - cis:
    - 1.1.2
  condition: all
  rules:
  - c:mount -> r:/tmp
- id: 13002
  title: Filesystem - Ensure nodev option set on /tmp partition
  description: 'The nodev mount option specifies that the filesystem cannot contain
    special devices.

    '
  rationale: 'Since the /tmp filesystem is not intended to support devices, set this
    option to ensure that users cannot attempt to create block or character special
    devices in /tmp.

    '
  remediation: Add nodev option to /tmp in /etc/fstab
  compliance:
  - cis:
    - 1.1.3
  condition: all
  rules:
  - c:mount -> r:/tmp.*nodev
- id: 13003
  title: Filesystem - Ensure nosuid option set on /tmp partition
  description: 'The nosuid mount option specifies that the filesystem cannot contain
    setuid files.

    '
  rationale: 'Since the /tmp filesystem is only intended for temporary file storage,
    set this option to ensure that users cannot create setuid files in /tmp.

    '
  remediation: Add nosuid option to /tmp in /etc/fstab
  compliance:
  - cis:
    - 1.1.4
  condition: all
  rules:
  - c:mount -> r:/tmp.*nosuid
- id: 13004
  title: Filesystem - Ensure noexec option set on /tmp partition
  description: 'The noexec mount option specifies that the filesystem cannot contain
    executable binaries.

    '
  rationale: 'Since the /tmp filesystem is only intended for temporary file storage,
    set this option to ensure that users cannot run executable binaries from /tmp.

    '
  remediation: Add noexec option to /tmp in /etc/fstab
  compliance:
  - cis:
    - 1.1.5
  condition: all
  rules:
  - c:mount -> r:/tmp.*noexec
- id: 13005
  title: Filesystem - Ensure separate partition exists for /var
  description: 'The /var directory is used by daemons and other system services to
    temporarily store dynamic data.

    '
  rationale: 'Since the /var directory may contain world-writable files and directories,
    there is a risk of resource exhaustion if it is not bound to a separate partition.

    '
  remediation: Create separate partition for /var
  compliance:
  - cis:
    - 1.1.6
  condition: all
  rules:
  - c:mount -> r:/var
- id: 13006
  title: Filesystem - Ensure separate partition exists for /var/log
  description: 'The /var/log directory is used by system services to store log data.

    '
  rationale: 'There are two important reasons to ensure that system logs are stored
    on a separate partition: protection against resource exhaustion and protection
    of audit data.

    '
  remediation: Create separate partition for /var/log
  compliance:
  - cis:
    - 1.1.11
  condition: all
  rules:
  - c:mount -> r:/var/log
- id: 14001
  title: Security - Ensure mounting of cramfs filesystems is disabled
  description: 'The cramfs filesystem type is a compressed read-only Linux filesystem
    embedded in small footprint systems.

    '
  rationale: 'Removing support for unneeded filesystem types reduces the local attack
    surface of the system.

    '
  remediation: Add 'install cramfs /bin/true' to /etc/modprobe.d/
  compliance:
  - cis:
    - 1.1.1.1
  condition: all
  rules:
  - not c:lsmod -> r:cramfs
  - c:modprobe -n -v cramfs -> r:install /bin/true
- id: 14002
  title: Security - Ensure mounting of freevxfs filesystems is disabled
  description: 'The freevxfs filesystem type is a free version of the Veritas type
    filesystem.

    '
  rationale: 'Removing support for unneeded filesystem types reduces the local attack
    surface of the system.

    '
  remediation: Add 'install freevxfs /bin/true' to /etc/modprobe.d/
  compliance:
  - cis:
    - 1.1.1.2
  condition: all
  rules:
  - not c:lsmod -> r:freevxfs
  - c:modprobe -n -v freevxfs -> r:install /bin/true
- id: 14003
  title: Security - Ensure mounting of jffs2 filesystems is disabled
  description: 'The jffs2 (journaling flash filesystem 2) filesystem type is a log-
    structured filesystem used in flash memory devices.

    '
  rationale: 'Removing support for unneeded filesystem types reduces the local attack
    surface of the system.

    '
  remediation: Add 'install jffs2 /bin/true' to /etc/modprobe.d/
  compliance:
  - cis:
    - 1.1.1.3
  condition: all
  rules:
  - not c:lsmod -> r:jffs2
  - c:modprobe -n -v jffs2 -> r:install /bin/true
- id: 14004
  title: Security - Ensure mounting of hfs filesystems is disabled
  description: 'The hfs filesystem type is a hierarchical filesystem that allows you
    to mount Mac OS filesystems.

    '
  rationale: 'Removing support for unneeded filesystem types reduces the local attack
    surface of the system.

    '
  remediation: Add 'install hfs /bin/true' to /etc/modprobe.d/
  compliance:
  - cis:
    - 1.1.1.4
  condition: all
  rules:
  - not c:lsmod -> r:hfs
  - c:modprobe -n -v hfs -> r:install /bin/true
- id: 14005
  title: Security - Ensure mounting of hfsplus filesystems is disabled
  description: 'The hfsplus filesystem type is a hierarchical filesystem designed
    to replace hfs that allows you to mount Mac OS filesystems.

    '
  rationale: 'Removing support for unneeded filesystem types reduces the local attack
    surface of the system.

    '
  remediation: Add 'install hfsplus /bin/true' to /etc/modprobe.d/
  compliance:
  - cis:
    - 1.1.1.5
  condition: all
  rules:
  - not c:lsmod -> r:hfsplus
  - c:modprobe -n -v hfsplus -> r:install /bin/true
- id: 14006
  title: Security - Ensure mounting of udf filesystems is disabled
  description: 'The udf filesystem type is the universal disk format used to implement
    ISO/IEC 13346 and ECMA-167 specifications.

    '
  rationale: 'Removing support for unneeded filesystem types reduces the local attack
    surface of the system.

    '
  remediation: Add 'install udf /bin/true' to /etc/modprobe.d/
  compliance:
  - cis:
    - 1.1.1.6
  condition: all
  rules:
  - not c:lsmod -> r:udf
  - c:modprobe -n -v udf -> r:install /bin/true
- id: 15001
  title: Process - Ensure core dumps are restricted
  description: A core dump is the memory of an executable program.
  rationale: 'Setting a hard limit of 0 prevents users from creating core dump files.

    '
  remediation: Add '* hard core 0' to /etc/security/limits.conf
  compliance:
  - cis:
    - 1.5.1
  condition: all
  rules:
  - f:/etc/security/limits.conf -> r:hard.*core.*0
  - c:sysctl fs.suid_dumpable -> r:fs.suid_dumpable = 0
- id: 16001
  title: MAC - Ensure SELinux is not disabled in bootloader configuration
  description: 'Configure SELINUX to be enabled at boot time and verify that it has
    not been overwritten by the grub boot parameters.

    '
  rationale: 'SELinux must be enabled at boot time in /etc/default/grub to ensure
    that the controls it provides are not overridden.

    '
  remediation: Remove selinux=0 and enforcing=0 from GRUB_CMDLINE_LINUX
  compliance:
  - cis:
    - 1.6.1.1
  condition: any
  rules:
  - not f:/etc/default/grub -> r:selinux=0
  - not f:/etc/default/grub -> r:enforcing=0
  - not c:pacman -Q selinux-refpolicy-arch
- id: 16002
  title: MAC - Ensure AppArmor is enabled in the bootloader configuration
  description: 'Configure AppArmor to be enabled at boot time and verify that it has
    not been overwritten by the grub boot parameters.

    '
  rationale: 'AppArmor must be enabled at boot time in /etc/default/grub to ensure
    that the controls it provides are in place during the integrity of the kernel.

    '
  remediation: Add apparmor=1 and security=apparmor to GRUB_CMDLINE_LINUX
  compliance:
  - cis:
    - 1.6.1.1
  condition: any
  rules:
  - f:/etc/default/grub -> r:apparmor=1
  - f:/etc/default/grub -> r:security=apparmor
  - c:pacman -Q apparmor
- id: 17001
  title: Banners - Ensure message of the day is configured properly
  description: 'The contents of the /etc/motd file are displayed to users after login
    and function as a message of the day for authenticated users.

    '
  rationale: 'Warning messages inform users who are attempting to login to the system
    of their legal status regarding the system and must include the name of the organization
    that owns the system and any monitoring policies that are in place.

    '
  remediation: Edit /etc/motd with appropriate contents
  compliance:
  - cis:
    - 1.7.1
  condition: all
  rules:
  - f:/etc/motd
  - not f:/etc/motd -> r:\\v
  - not f:/etc/motd -> r:\\r
  - not f:/etc/motd -> r:\\m
  - not f:/etc/motd -> r:\\s
- id: 17002
  title: Banners - Ensure local login warning banner is configured properly
  description: 'The contents of the /etc/issue file are displayed to users prior to
    login for local terminals.

    '
  rationale: 'Warning messages inform users who are attempting to login to the system
    of their legal status regarding the system and must include the name of the organization
    that owns the system and any monitoring policies that are in place.

    '
  remediation: Edit /etc/issue with appropriate contents
  compliance:
  - cis:
    - 1.7.2
  condition: all
  rules:
  - f:/etc/issue
  - not f:/etc/issue -> r:\\v
  - not f:/etc/issue -> r:\\r
  - not f:/etc/issue -> r:\\m
  - not f:/etc/issue -> r:\\s
- id: 17003
  title: Banners - Ensure remote login warning banner is configured properly
  description: 'The contents of the /etc/issue.net file are displayed to users prior
    to login for remote connections from configured services.

    '
  rationale: 'Warning messages inform users who are attempting to login to the system
    of their legal status regarding the system and must include the name of the organization
    that owns the system and any monitoring policies that are in place.

    '
  remediation: Edit /etc/issue.net with appropriate contents
  compliance:
  - cis:
    - 1.7.3
  condition: all
  rules:
  - f:/etc/issue.net
  - not f:/etc/issue.net -> r:\\v
  - not f:/etc/issue.net -> r:\\r
  - not f:/etc/issue.net -> r:\\m
  - not f:/etc/issue.net -> r:\\s
- id: 18001
  title: GDM - Ensure GDM login banner is configured
  description: 'GDM is the GNOME Display Manager which handles graphical login for
    GNOME based systems.

    '
  rationale: 'Warning messages inform users who are attempting to login to the system
    of their legal status regarding the system and must include the name of the organization
    that owns the system and any monitoring policies that are in place.

    '
  remediation: Configure GDM banner in /etc/gdm/custom.conf
  compliance:
  - cis:
    - 1.7.4
  condition: any
  rules:
  - not c:pacman -Q gdm
  - f:/etc/gdm/custom.conf -> !r:^# && r:banner-message-enable=true
- id: 19001
  title: Updates - Ensure gpgcheck is globally activated
  description: 'The gpgcheck option, found in the main section of the /etc/pacman.conf
    file determines if an Pacman package''s signature is checked prior to its installation.

    '
  rationale: 'It is important to ensure that an Pacman''s package signature is always
    checked prior to installation to ensure that the software is legitimate.

    '
  remediation: Set SigLevel = Required DatabaseOptional in /etc/pacman.conf
  compliance:
  - cis:
    - 1.2.3
  condition: all
  rules:
  - f:$pacman_conf -> !r:^# && r:^SigLevel.*Required
- id: 20001
  title: Sudo - Ensure sudo is installed
  description: 'sudo allows a permitted user to execute a command as the superuser
    or another user, as specified by the security policy.

    '
  rationale: 'sudo supports a plugin architecture for security policies and input/output
    logging.

    '
  remediation: Install sudo package
  compliance:
  - cis:
    - 5.1.1
  condition: all
  rules:
  - c:pacman -Q sudo
- id: 20002
  title: Sudo - Ensure sudo commands use pty
  description: sudo can be configured to run only from a pseudo-terminal.
  rationale: 'Attackers can run a malicious program using sudo which would fork a
    background process that remains even when the main program has finished executing.

    '
  remediation: Add 'Defaults use_pty' to /etc/sudoers
  compliance:
  - cis:
    - 5.1.2
  condition: all
  rules:
  - f:/etc/sudoers -> !r:^# && r:Defaults use_pty
- id: 20003
  title: Sudo - Ensure sudo log file exists
  description: sudo can use a custom log file.
  rationale: A sudo log file simplifies auditing of sudo commands.
  remediation: Add 'Defaults logfile="/var/log/sudo.log"' to /etc/sudoers
  compliance:
  - cis:
    - 5.1.3
  condition: all
  rules:
  - f:/etc/sudoers -> !r:^# && r:Defaults logfile
- id: 36024
  title: Disable Automounting.
  description: autofs allows automatic mounting of devices, typically including CD/DVDs
    and USB drives.
  rationale: With automounting enabled anyone with physical access could attach a
    USB drive or disc and have its contents available in system even if they lacked
    permissions to mount it themselves.
  impact: 'The use of portable hard drives is very common for workstation users. If
    your organization allows the use of portable storage or media on workstations
    and physical access controls to workstations is considered adequate there is little
    value add in turning off automounting. Notes: Additional methods of disabling
    a service exist. Consult your distribution documentation for appropriate methods.
    This control should align with the tolerance of the use of portable drives and
    optical media in the organization. On a server requiring an admin to manually
    mount media can be part of defense-in-depth to reduce the risk of unapproved software
    or information being introduced or proprietary software or information being exfiltrated.
    If admins commonly use flash drives and Server access has sufficient physical
    controls, requiring manual mounting may not increase security.'
  remediation: 'Run one of the following commands to disable autofs : # chkconfig
    autofs off # systemctl disable autofs # update-rc.d autofs disable.'
  compliance:
  - cis:
    - 1.1.22
  - cis_csc_v7:
    - '8.4'
  - cmmc_v2.0:
    - SI.1.213
  - iso_27001-2013:
    - A.12.2.1
  - mitre_techniques:
    - T1027
    - T1045
    - T1091
    - T1193
    - T1194
    - T1200
    - T1215
    - T1221
  - nist_sp_800-53:
    - SI-3
  condition: all
  rules:
  - not c:systemctl is-enabled autofs -> r:enabled
- id: 36025
  title: Disable USB Storage.
  description: USB storage provides a means to transfer and store files insuring persistence
    and availability of the files independent of network connection status. Its popularity
    and utility has led to USB-based malware being a simple and common means for network
    infiltration and a first step to establishing a persistent threat within a networked
    environment.
  rationale: Restricting USB access on the system will decrease the physical attack
    surface for a device and diminish the possible vectors to introduce malware.
  remediation: 'Edit or create a file in the /etc/modprobe.d/ directory ending in
    .conf Example: vim /etc/modprobe.d/usb-storage.conf and add the following line:
    install usb-storage /bin/true Run the following command to unload the usb-storage
    module: rmmod usb-storage.'
  compliance:
  - cis:
    - 1.1.23
  - cis_csc_v7:
    - '8.4'
  - cmmc_v2.0:
    - SI.1.213
  - iso_27001-2013:
    - A.12.2.1
  - mitre_techniques:
    - T1027
    - T1045
    - T1091
    - T1193
    - T1194
    - T1200
    - T1215
    - T1221
  - nist_sp_800-53:
    - SI-3
  condition: all
  rules:
  - c:modprobe -n -v usb-storage -> r:install /bin/false|install /bin/true
  - not c:lsmod -> r:usb-storage
- id: 36008
  title: Ensure /tmp is configured.
  description: The /tmp directory is a world-writable directory used for temporary
    storage by all users and some applications.
  rationale: Making /tmp its own file system allows an administrator to set the noexec
    option on the mount, making /tmp useless for an attacker to install executable
    code. It would also prevent an attacker from establishing a hardlink to a system
    setuid program and wait for it to be updated. Once the program was updated, the
    hardlink would be broken and the attacker would have his own copy of the program.
    If the program happened to have a security vulnerability, the attacker could continue
    to exploit the known flaw. This can be accomplished by either mounting tmpfs to
    /tmp, or creating a separate partition for /tmp.
  impact: Since the /tmp directory is intended to be world-writable, there is a risk
    of resource exhaustion if it is not bound to a separate partition. Running out
    of /tmp space is a problem regardless of what kind of filesystem lies under it,
    but in a default installation a disk-based /tmp will essentially have the whole
    disk available, as it only creates a single / partition. On the other hand, a
    RAM-based /tmp as with tmpfs will almost certainly be much smaller, which can
    lead to applications filling up the filesystem much more easily. /tmp utalizing
    tmpfs can be resized using the size={size} parameter on the Options line on the
    tmp.mount file.
  remediation: 'Configure /etc/fstab as appropriate. example: tmpfs /tmp tmpfs defaults,rw,nosuid,nodev,noexec,relatime
    0 0 OR Run the following commands to enable systemd /tmp mounting: systemctl unmask
    tmp.mount systemctl enable tmp.mount Edit /etc/systemd/system/local-fs.target.wants/tmp.mount
    to configure the /tmp mount: [Mount] What=tmpfs Where=/tmp Type=tmpfs Options=mode=1777,strictatime,noexec,nodev,nosuid.'
  references:
  - http://tldp.org/HOWTO/LVM-HOWTO/
  - https://www.freedesktop.org/wiki/Software/systemd/APIFileSystems/
  compliance:
  - cis:
    - 1.1.2
  - cis_csc_v7:
    - '5.1'
  - cmmc_v2.0:
    - AC.1.002
    - CM.2.061
    - SC.3.180
  - iso_27001-2013:
    - A.14.2.5
    - A.8.1.3
  - mitre_techniques:
    - T1003
    - T1011
    - T1015
    - T1017
    - T1019
    - T1028
    - T1034
    - T1035
    - T1036
    - T1037
    - T1044
    - T1047
    - T1051
    - T1053
    - T1054
    - T1055
    - T1058
    - T1067
    - T1070
    - T1072
    - T1073
    - T1075
    - T1076
    - T1077
    - T1078
    - T1080
    - T1081
    - T1084
    - T1086
    - T1087
    - T1088
    - T1089
    - T1092
    - T1096
    - T1097
    - T1098
    - T1100
    - T1110
    - T1112
    - T1130
    - T1133
    - T1134
    - T1136
    - T1137
    - T1138
    - T1139
    - T1142
    - T1145
    - T1146
    - T1147
    - T1148
    - T1150
    - T1156
    - T1157
    - T1165
    - T1166
    - T1169
    - T1173
    - T1174
    - T1175
    - T1176
    - T1177
    - T1178
    - T1184
    - T1187
    - T1190
    - T1196
    - T1197
    - T1198
    - T1199
    - T1200
    - T1201
    - T1206
    - T1208
    - T1209
    - T1210
    - T1214
    - T1215
    - T1218
    - T1485
    - T1486
    - T1487
    - T1488
    - T1489
    - T1490
    - T1491
    - T1492
    - T1494
    - T1495
    - T1501
    - T1503
    - T1504
    - T1505
    - T1506
    - T1525
    - T1530
    - T1535
    - T1537
    - T1539
  - nist_sp_800-53:
    - AU-2
    - CM-1
    - CM-2
    - CM-6
    - CM-7
    - IA-5
    - IA-6
    - SC-20
    - SC-21
  - pci_dss_v3.2.1:
    - '2.2'
  condition: any
  rules:
  - c:findmnt -kn /tmp -> r:\s*/tmp\s
  - c:systemctl is-enabled tmp.mount -> r:generated|enabled
- id: 36009
  title: Ensure nodev option set on /tmp partition.
  description: The nodev mount option specifies that the filesystem cannot contain
    special devices.
  rationale: Since the /tmp filesystem is not intended to support devices, set this
    option to ensure that users cannot attempt to create block or character special
    devices in /tmp.
  remediation: 'Edit the /etc/fstab file and add nodev to the fourth field (mounting
    options) for the /tmp partition. See the fstab(5) manual page for more information.
    Run the following command to remount /tmp : # mount -o remount,nodev /tmp or Edit
    /etc/systemd/system/local-fs.target.wants/tmp.mount to add nodev to the /tmp mount
    options: [Mount] Options=mode=1777,strictatime,noexec,nodev,nosuid Run the following
    command to remount /tmp : # mount -o remount,nodev /tmp.'
  compliance:
  - cis:
    - 1.1.3
  - cis_csc_v7:
    - '5.1'
  - cmmc_v2.0:
    - AC.1.002
    - CM.2.061
    - SC.3.180
  - iso_27001-2013:
    - A.14.2.5
    - A.8.1.3
  - mitre_techniques:
    - T1003
    - T1011
    - T1015
    - T1017
    - T1019
    - T1028
    - T1034
    - T1035
    - T1036
    - T1037
    - T1044
    - T1047
    - T1051
    - T1053
    - T1054
    - T1055
    - T1058
    - T1067
    - T1070
    - T1072
    - T1073
    - T1075
    - T1076
    - T1077
    - T1078
    - T1080
    - T1081
    - T1084
    - T1086
    - T1087
    - T1088
    - T1089
    - T1092
    - T1096
    - T1097
    - T1098
    - T1100
    - T1110
    - T1112
    - T1130
    - T1133
    - T1134
    - T1136
    - T1137
    - T1138
    - T1139
    - T1142
    - T1145
    - T1146
    - T1147
    - T1148
    - T1150
    - T1156
    - T1157
    - T1165
    - T1166
    - T1169
    - T1173
    - T1174
    - T1175
    - T1176
    - T1177
    - T1178
    - T1184
    - T1187
    - T1190
    - T1196
    - T1197
    - T1198
    - T1199
    - T1200
    - T1201
    - T1206
    - T1208
    - T1209
    - T1210
    - T1214
    - T1215
    - T1218
    - T1485
    - T1486
    - T1487
    - T1488
    - T1489
    - T1490
    - T1491
    - T1492
    - T1494
    - T1495
    - T1501
    - T1503
    - T1504
    - T1505
    - T1506
    - T1525
    - T1530
    - T1535
    - T1537
    - T1539
  - nist_sp_800-53:
    - AU-2
    - CM-1
    - CM-2
    - CM-6
    - CM-7
    - IA-5
    - IA-6
    - SC-20
    - SC-21
  - pci_dss_v3.2.1:
    - '2.2'
  condition: all
  rules:
  - c:findmnt -kn /tmp -> r:nodev
- id: 36010
  title: Ensure nosuid option set on /tmp partition.
  description: The nosuid mount option specifies that the filesystem cannot contain
    setuid files.
  rationale: Since the /tmp filesystem is only intended for temporary file storage,
    set this option to ensure that users cannot create setuid files in /tmp.
  remediation: 'Edit the /etc/fstab file and add nosuid to the fourth field (mounting
    options) for the /tmp partition. See the fstab(5) manual page for more information.
    Run the following command to remount /tmp : # mount -o remount,nosuid /tmp or
    Edit /etc/systemd/system/local-fs.target.wants/tmp.mount to add nosuid to the
    /tmp mount options: [Mount] Options=mode=1777,strictatime,noexec,nodev,nosuid
    Run the following command to remount /tmp : # mount -o remount,nosuid /tmp.'
  compliance:
  - cis:
    - 1.1.4
  - cis_csc_v7:
    - '5.1'
  - cmmc_v2.0:
    - AC.1.002
    - CM.2.061
    - SC.3.180
  - iso_27001-2013:
    - A.14.2.5
    - A.8.1.3
  - mitre_techniques:
    - T1003
    - T1011
    - T1015
    - T1017
    - T1019
    - T1028
    - T1034
    - T1035
    - T1036
    - T1037
    - T1044
    - T1047
    - T1051
    - T1053
    - T1054
    - T1055
    - T1058
    - T1067
    - T1070
    - T1072
    - T1073
    - T1075
    - T1076
    - T1077
    - T1078
    - T1080
    - T1081
    - T1084
    - T1086
    - T1087
    - T1088
    - T1089
    - T1092
    - T1096
    - T1097
    - T1098
    - T1100
    - T1110
    - T1112
    - T1130
    - T1133
    - T1134
    - T1136
    - T1137
    - T1138
    - T1139
    - T1142
    - T1145
    - T1146
    - T1147
    - T1148
    - T1150
    - T1156
    - T1157
    - T1165
    - T1166
    - T1169
    - T1173
    - T1174
    - T1175
    - T1176
    - T1177
    - T1178
    - T1184
    - T1187
    - T1190
    - T1196
    - T1197
    - T1198
    - T1199
    - T1200
    - T1201
    - T1206
    - T1208
    - T1209
    - T1210
    - T1214
    - T1215
    - T1218
    - T1485
    - T1486
    - T1487
    - T1488
    - T1489
    - T1490
    - T1491
    - T1492
    - T1494
    - T1495
    - T1501
    - T1503
    - T1504
    - T1505
    - T1506
    - T1525
    - T1530
    - T1535
    - T1537
    - T1539
  - nist_sp_800-53:
    - AU-2
    - CM-1
    - CM-2
    - CM-6
    - CM-7
    - IA-5
    - IA-6
    - SC-20
    - SC-21
  - pci_dss_v3.2.1:
    - '2.2'
  condition: all
  rules:
  - c:findmnt -kn /tmp -> r:nosuid
- id: 36011
  title: Ensure noexec option set on /tmp partition.
  description: The noexec mount option specifies that the filesystem cannot contain
    executable binaries.
  rationale: Since the /tmp filesystem is only intended for temporary file storage,
    set this option to ensure that users cannot run executable binaries from /tmp.
  remediation: 'Edit the /etc/fstab file and add noexec to the fourth field (mounting
    options) for the /tmp partition. See the fstab(5) manual page for more information.
    Run the following command to remount /tmp : # mount -o remount,noexec /tmp or
    Edit /etc/systemd/system/local-fs.target.wants/tmp.mount to add noexec to the
    /tmp mount options: [Mount] Options=mode=1777,strictatime,noexec,nodev,nosuid
    Run the following command to remount /tmp : # mount -o remount,noexec /tmp.'
  compliance:
  - cis:
    - 1.1.5
  - cis_csc_v7:
    - '2.6'
  - cmmc_v2.0:
    - CM.2.063
    - CM.3.069
    - CM.4.073
  - iso_27001-2013:
    - A.12.5.1
    - A.12.6.2
  - mitre_techniques:
    - T1028
    - T1046
    - T1052
    - T1064
    - T1076
    - T1086
    - T1091
    - T1092
    - T1118
    - T1121
    - T1127
    - T1133
    - T1137
    - T1164
    - T1170
    - T1171
    - T1173
    - T1175
    - T1180
    - T1184
    - T1191
    - T1210
    - T1221
    - T1519
  - nist_sp_800-53:
    - CM-11
  condition: all
  rules:
  - c:findmnt -kn /tmp -> r:noexec
- id: 36013
  title: Ensure separate partition exists for /var/tmp.
  description: The /var/tmp directory is a world-writable directory used for temporary
    storage by all users and some applications.
  rationale: Since the /var/tmp directory is intended to be world-writable, there
    is a risk of resource exhaustion if it is not bound to a separate partition. In
    addition, making /var/tmp its own file system allows an administrator to set the
    noexec option on the mount, making /var/tmp useless for an attacker to install
    executable code. It would also prevent an attacker from establishing a hardlink
    to a system setuid program and wait for it to be updated. Once the program was
    updated, the hardlink would be broken and the attacker would have his own copy
    of the program. If the program happened to have a security vulnerability, the
    attacker could continue to exploit the known flaw.
  remediation: For new installations, during installation create a custom partition
    setup and specify a separate partition for /var/tmp . For systems that were previously
    installed, create a new partition and configure /etc/fstab as appropriate.
  compliance:
  - cis:
    - 1.1.7
  - cis_csc_v7:
    - '5.1'
  - cmmc_v2.0:
    - AC.1.002
    - CM.2.061
    - SC.3.180
  - iso_27001-2013:
    - A.14.2.5
    - A.8.1.3
  - mitre_techniques:
    - T1003
    - T1011
    - T1015
    - T1017
    - T1019
    - T1028
    - T1034
    - T1035
    - T1036
    - T1037
    - T1044
    - T1047
    - T1051
    - T1053
    - T1054
    - T1055
    - T1058
    - T1067
    - T1070
    - T1072
    - T1073
    - T1075
    - T1076
    - T1077
    - T1078
    - T1080
    - T1081
    - T1084
    - T1086
    - T1087
    - T1088
    - T1089
    - T1092
    - T1096
    - T1097
    - T1098
    - T1100
    - T1110
    - T1112
    - T1130
    - T1133
    - T1134
    - T1136
    - T1137
    - T1138
    - T1139
    - T1142
    - T1145
    - T1146
    - T1147
    - T1148
    - T1150
    - T1156
    - T1157
    - T1165
    - T1166
    - T1169
    - T1173
    - T1174
    - T1175
    - T1176
    - T1177
    - T1178
    - T1184
    - T1187
    - T1190
    - T1196
    - T1197
    - T1198
    - T1199
    - T1200
    - T1201
    - T1206
    - T1208
    - T1209
    - T1210
    - T1214
    - T1215
    - T1218
    - T1485
    - T1486
    - T1487
    - T1488
    - T1489
    - T1490
    - T1491
    - T1492
    - T1494
    - T1495
    - T1501
    - T1503
    - T1504
    - T1505
    - T1506
    - T1525
    - T1530
    - T1535
    - T1537
    - T1539
  - nist_sp_800-53:
    - AU-2
    - CM-1
    - CM-2
    - CM-6
    - CM-7
    - IA-5
    - IA-6
    - SC-20
    - SC-21
  - pci_dss_v3.2.1:
    - '2.2'
  condition: all
  rules:
  - c:findmnt -kn /var/tmp -> r:\s*/var/tmp\s
- id: 36014
  title: Ensure nodev option set on /var/tmp partition.
  description: The nodev mount option specifies that the filesystem cannot contain
    special devices.
  rationale: Since the /var/tmp filesystem is not intended to support devices, set
    this option to ensure that users cannot attempt to create block or character special
    devices in /var/tmp.
  remediation: 'Edit the /etc/fstab file and add nodev to the fourth field (mounting
    options) for the /var/tmp partition. See the fstab(5) manual page for more information.
    Run the following command to remount /var/tmp : # mount -o remount,nodev /var/tmp.'
  compliance:
  - cis:
    - 1.1.8
  - cis_csc_v7:
    - '5.1'
  - cmmc_v2.0:
    - AC.1.002
    - CM.2.061
    - SC.3.180
  - iso_27001-2013:
    - A.14.2.5
    - A.8.1.3
  - mitre_techniques:
    - T1003
    - T1011
    - T1015
    - T1017
    - T1019
    - T1028
    - T1034
    - T1035
    - T1036
    - T1037
    - T1044
    - T1047
    - T1051
    - T1053
    - T1054
    - T1055
    - T1058
    - T1067
    - T1070
    - T1072
    - T1073
    - T1075
    - T1076
    - T1077
    - T1078
    - T1080
    - T1081
    - T1084
    - T1086
    - T1087
    - T1088
    - T1089
    - T1092
    - T1096
    - T1097
    - T1098
    - T1100
    - T1110
    - T1112
    - T1130
    - T1133
    - T1134
    - T1136
    - T1137
    - T1138
    - T1139
    - T1142
    - T1145
    - T1146
    - T1147
    - T1148
    - T1150
    - T1156
    - T1157
    - T1165
    - T1166
    - T1169
    - T1173
    - T1174
    - T1175
    - T1176
    - T1177
    - T1178
    - T1184
    - T1187
    - T1190
    - T1196
    - T1197
    - T1198
    - T1199
    - T1200
    - T1201
    - T1206
    - T1208
    - T1209
    - T1210
    - T1214
    - T1215
    - T1218
    - T1485
    - T1486
    - T1487
    - T1488
    - T1489
    - T1490
    - T1491
    - T1492
    - T1494
    - T1495
    - T1501
    - T1503
    - T1504
    - T1505
    - T1506
    - T1525
    - T1530
    - T1535
    - T1537
    - T1539
  - nist_sp_800-53:
    - AU-2
    - CM-1
    - CM-2
    - CM-6
    - CM-7
    - IA-5
    - IA-6
    - SC-20
    - SC-21
  - pci_dss_v3.2.1:
    - '2.2'
  condition: all
  rules:
  - c:findmnt -kn /var/tmp -> r:nodev
- id: 36015
  title: Ensure nosuid option set on /var/tmp partition.
  description: The nosuid mount option specifies that the filesystem cannot contain
    setuid files.
  rationale: Since the /var/tmp filesystem is only intended for temporary file storage,
    set this option to ensure that users cannot create setuid files in /var/tmp.
  remediation: 'Edit the /etc/fstab file and add nosuid to the fourth field (mounting
    options) for the /var/tmp partition. See the fstab(5) manual page for more information.
    Run the following command to remount /var/tmp : # mount -o remount,nosuid /var/tmp.'
  compliance:
  - cis:
    - 1.1.9
  - cis_csc_v7:
    - '5.1'
  - cmmc_v2.0:
    - AC.1.002
    - CM.2.061
    - SC.3.180
  - iso_27001-2013:
    - A.14.2.5
    - A.8.1.3
  - mitre_techniques:
    - T1003
    - T1011
    - T1015
    - T1017
    - T1019
    - T1028
    - T1034
    - T1035
    - T1036
    - T1037
    - T1044
    - T1047
    - T1051
    - T1053
    - T1054
    - T1055
    - T1058
    - T1067
    - T1070
    - T1072
    - T1073
    - T1075
    - T1076
    - T1077
    - T1078
    - T1080
    - T1081
    - T1084
    - T1086
    - T1087
    - T1088
    - T1089
    - T1092
    - T1096
    - T1097
    - T1098
    - T1100
    - T1110
    - T1112
    - T1130
    - T1133
    - T1134
    - T1136
    - T1137
    - T1138
    - T1139
    - T1142
    - T1145
    - T1146
    - T1147
    - T1148
    - T1150
    - T1156
    - T1157
    - T1165
    - T1166
    - T1169
    - T1173
    - T1174
    - T1175
    - T1176
    - T1177
    - T1178
    - T1184
    - T1187
    - T1190
    - T1196
    - T1197
    - T1198
    - T1199
    - T1200
    - T1201
    - T1206
    - T1208
    - T1209
    - T1210
    - T1214
    - T1215
    - T1218
    - T1485
    - T1486
    - T1487
    - T1488
    - T1489
    - T1490
    - T1491
    - T1492
    - T1494
    - T1495
    - T1501
    - T1503
    - T1504
    - T1505
    - T1506
    - T1525
    - T1530
    - T1535
    - T1537
    - T1539
  - nist_sp_800-53:
    - AU-2
    - CM-1
    - CM-2
    - CM-6
    - CM-7
    - IA-5
    - IA-6
    - SC-20
    - SC-21
  - pci_dss_v3.2.1:
    - '2.2'
  condition: all
  rules:
  - c:findmnt -kn /var/tmp -> r:nosuid
- id: 36016
  title: Ensure noexec option set on /var/tmp partition.
  description: The noexec mount option specifies that the filesystem cannot contain
    executable binaries.
  rationale: Since the /var/tmp filesystem is only intended for temporary file storage,
    set this option to ensure that users cannot run executable binaries from /var/tmp.
  remediation: 'Edit the /etc/fstab file and add noexec to the fourth field (mounting
    options) for the /var/tmp partition. See the fstab(5) manual page for more information.
    Run the following command to remount /var/tmp : # mount -o remount,noexec /var/tmp.'
  compliance:
  - cis:
    - 1.1.10
  - cis_csc_v7:
    - '2.6'
  - cmmc_v2.0:
    - CM.2.063
    - CM.3.069
    - CM.4.073
  - iso_27001-2013:
    - A.12.5.1
    - A.12.6.2
  - mitre_techniques:
    - T1028
    - T1046
    - T1052
    - T1064
    - T1076
    - T1086
    - T1091
    - T1092
    - T1118
    - T1121
    - T1127
    - T1133
    - T1137
    - T1164
    - T1170
    - T1171
    - T1173
    - T1175
    - T1180
    - T1184
    - T1191
    - T1210
    - T1221
    - T1519
  - nist_sp_800-53:
    - CM-11
  condition: all
  rules:
  - c:findmnt -kn /var/tmp -> r:noexec
- id: 36021
  title: Ensure nodev option set on /dev/shm partition.
  description: The nodev mount option specifies that the filesystem cannot contain
    special devices.
  rationale: Since the /dev/shm filesystem is not intended to support devices, set
    this option to ensure that users cannot attempt to create special devices in /dev/shm
    partitions.
  remediation: 'Edit the /etc/fstab file and add nodev to the fourth field (mounting
    options) for the /dev/shm partition. See the fstab(5) manual page for more information.
    Run the following command to remount /dev/shm : # mount -o remount,nodev /dev/shm
    Notes: Some distributions mount /dev/shm through other means and require /dev/shm
    to be added to /etc/fstab even though it is already being mounted on boot. Others
    may configure /dev/shm in other locations and may override /etc/fstab configuration.
    Consult the documentation appropriate for your distribution.'
  compliance:
  - cis:
    - 1.1.15
  - cis_csc_v7:
    - '5.1'
  - cmmc_v2.0:
    - AC.1.002
    - CM.2.061
    - SC.3.180
  - iso_27001-2013:
    - A.14.2.5
    - A.8.1.3
  - mitre_techniques:
    - T1003
    - T1011
    - T1015
    - T1017
    - T1019
    - T1028
    - T1034
    - T1035
    - T1036
    - T1037
    - T1044
    - T1047
    - T1051
    - T1053
    - T1054
    - T1055
    - T1058
    - T1067
    - T1070
    - T1072
    - T1073
    - T1075
    - T1076
    - T1077
    - T1078
    - T1080
    - T1081
    - T1084
    - T1086
    - T1087
    - T1088
    - T1089
    - T1092
    - T1096
    - T1097
    - T1098
    - T1100
    - T1110
    - T1112
    - T1130
    - T1133
    - T1134
    - T1136
    - T1137
    - T1138
    - T1139
    - T1142
    - T1145
    - T1146
    - T1147
    - T1148
    - T1150
    - T1156
    - T1157
    - T1165
    - T1166
    - T1169
    - T1173
    - T1174
    - T1175
    - T1176
    - T1177
    - T1178
    - T1184
    - T1187
    - T1190
    - T1196
    - T1197
    - T1198
    - T1199
    - T1200
    - T1201
    - T1206
    - T1208
    - T1209
    - T1210
    - T1214
    - T1215
    - T1218
    - T1485
    - T1486
    - T1487
    - T1488
    - T1489
    - T1490
    - T1491
    - T1492
    - T1494
    - T1495
    - T1501
    - T1503
    - T1504
    - T1505
    - T1506
    - T1525
    - T1530
    - T1535
    - T1537
    - T1539
  - nist_sp_800-53:
    - AU-2
    - CM-1
    - CM-2
    - CM-6
    - CM-7
    - IA-5
    - IA-6
    - SC-20
    - SC-21
  - pci_dss_v3.2.1:
    - '2.2'
  condition: all
  rules:
  - c:findmnt -kn /dev/shm -> r:nodev
- id: 36022
  title: Ensure nosuid option set on /dev/shm partition.
  description: The nosuid mount option specifies that the filesystem cannot contain
    setuid files.
  rationale: Setting this option on a file system prevents users from introducing
    privileged programs onto the system and allowing non-root users to execute them.
  remediation: 'Edit the /etc/fstab file and add nosuid to the fourth field (mounting
    options) for the /dev/shm partition. See the fstab(5) manual page for more information.
    Run the following command to remount /dev/shm : # mount -o remount,nosuid /dev/shm
    Notes: Some distributions mount /dev/shm through other means and require /dev/shm
    to be added to /etc/fstab even though it is already being mounted on boot. Others
    may configure /dev/shm in other locations and may override /etc/fstab configuration.
    Consult the documentation appropriate for your distribution.'
  compliance:
  - cis:
    - 1.1.16
  - cis_csc_v7:
    - '5.1'
  - cmmc_v2.0:
    - AC.1.002
    - CM.2.061
    - SC.3.180
  - iso_27001-2013:
    - A.14.2.5
    - A.8.1.3
  - mitre_techniques:
    - T1003
    - T1011
    - T1015
    - T1017
    - T1019
    - T1028
    - T1034
    - T1035
    - T1036
    - T1037
    - T1044
    - T1047
    - T1051
    - T1053
    - T1054
    - T1055
    - T1058
    - T1067
    - T1070
    - T1072
    - T1073
    - T1075
    - T1076
    - T1077
    - T1078
    - T1080
    - T1081
    - T1084
    - T1086
    - T1087
    - T1088
    - T1089
    - T1092
    - T1096
    - T1097
    - T1098
    - T1100
    - T1110
    - T1112
    - T1130
    - T1133
    - T1134
    - T1136
    - T1137
    - T1138
    - T1139
    - T1142
    - T1145
    - T1146
    - T1147
    - T1148
    - T1150
    - T1156
    - T1157
    - T1165
    - T1166
    - T1169
    - T1173
    - T1174
    - T1175
    - T1176
    - T1177
    - T1178
    - T1184
    - T1187
    - T1190
    - T1196
    - T1197
    - T1198
    - T1199
    - T1200
    - T1201
    - T1206
    - T1208
    - T1209
    - T1210
    - T1214
    - T1215
    - T1218
    - T1485
    - T1486
    - T1487
    - T1488
    - T1489
    - T1490
    - T1491
    - T1492
    - T1494
    - T1495
    - T1501
    - T1503
    - T1504
    - T1505
    - T1506
    - T1525
    - T1530
    - T1535
    - T1537
    - T1539
  - nist_sp_800-53:
    - AU-2
    - CM-1
    - CM-2
    - CM-6
    - CM-7
    - IA-5
    - IA-6
    - SC-20
    - SC-21
  - pci_dss_v3.2.1:
    - '2.2'
  condition: all
  rules:
  - c:findmnt -kn /dev/shm -> r:nosuid
- id: 36023
  title: Ensure noexec option set on /dev/shm partition.
  description: The noexec mount option specifies that the filesystem cannot contain
    executable binaries.
  rationale: Setting this option on a file system prevents users from executing programs
    from shared memory. This deters users from introducing potentially malicious software
    on the system.
  remediation: 'Edit the /etc/fstab file and add noexec to the fourth field (mounting
    options) for the /dev/shm partition. See the fstab(5) manual page for more information.
    Run the following command to remount /dev/shm: # mount -o remount,noexec /dev/shm
    Notes: Some distributions mount /dev/shm through other means and require /dev/shm
    to be added to /etc/fstab even though it is already being mounted on boot. Others
    may configure /dev/shm in other locations and may override /etc/fstab configuration.
    Consult the documentation appropriate for your distribution.'
  compliance:
  - cis:
    - 1.1.17
  - cis_csc_v7:
    - '2.6'
  - cmmc_v2.0:
    - CM.2.063
    - CM.3.069
    - CM.4.073
  - iso_27001-2013:
    - A.12.5.1
    - A.12.6.2
  - mitre_techniques:
    - T1028
    - T1046
    - T1052
    - T1064
    - T1076
    - T1086
    - T1091
    - T1092
    - T1118
    - T1121
    - T1127
    - T1133
    - T1137
    - T1164
    - T1170
    - T1171
    - T1173
    - T1175
    - T1180
    - T1184
    - T1191
    - T1210
    - T1221
    - T1519
  - nist_sp_800-53:
    - CM-11
  condition: all
  rules:
  - c:findmnt -kn /dev/shm -> r:noexec
- id: 36110
  title: Ensure auditd is installed.
  description: auditd is the userspace component to the Linux Auditing System. It's
    responsible for writing audit records to the disk.
  rationale: The capturing of system events provides system administrators with information
    to allow them to determine if unauthorized access to their system is occurring.
  remediation: 'Run the following command to Install auditd # yum install audit audit-libs
    # apt-get install auditd audispd-plugins # zipper install audit audit-libs.'
  compliance:
  - cis:
    - 4.1.2
  - cis_csc_v7:
    - '6.2'
  - cmmc_v2.0:
    - AU.2.042
    - AU.5.055
  - iso_27001-2013:
    - A.12.4.1
  - nist_sp_800-53:
    - AU-12
    - AU-3
  - pci_dss_v3.2.1:
    - '10.2'
    - '10.3'
  condition: all
  rules:
  - c:which auditd -> r:/auditd
- id: 36111
  title: Ensure auditd service is enabled.
  description: Turn on the auditd daemon to record system events.
  rationale: The capturing of system events provides system administrators with information
    to allow them to determine if unauthorized access to their system is occurring.
  remediation: 'Run one of the following commands to enable auditd : # chkconfig auditd
    on # systemctl enable auditd # update-rc.d auditd enable Notes: Additional methods
    of enabling a service exist. Consult your distribution documentation for appropriate
    methods.'
  compliance:
  - cis:
    - 4.1.3
  - cis_csc_v7:
    - '6.2'
  - cmmc_v2.0:
    - AU.2.042
    - AU.5.055
  - iso_27001-2013:
    - A.12.4.1
  - nist_sp_800-53:
    - AU-12
    - AU-3
  - pci_dss_v3.2.1:
    - '10.2'
    - '10.3'
  condition: any
  rules:
  - p:auditd
  - c:systemctl is-enabled auditd -> r:^enabled
- id: 36112
  title: Ensure auditing for processes that start prior to auditd is enabled.
  description: Configure grub so that processes that are capable of being audited
    can be audited even if they start up prior to auditd startup.
  rationale: Audit events need to be captured on processes that start up prior to
    auditd , so that potential malicious activity cannot go undetected.
  remediation: 'For grub2 based systems edit /etc/default/grub and add audit=1 to
    GRUB_CMDLINE_LINUX: GRUB_CMDLINE_LINUX="audit=1" Run the following command to
    update the grub2 configuration: # grub2-mkconfig -o /boot/grub2/grub.cfg or #
    update-grub For grub based systems edit /boot/grub/menu.lst to include audit=1
    on all kernel lines. Notes: This recommendation is designed around the grub bootloader,
    if LILO or another bootloader is in use in your environment enact equivalent settings.
    Replace /boot/grub2/grub.cfg, /boot/grub/grun.cfg, /boot/grub/menu.lst with the
    appropriate grub configuration file for your environment.'
  compliance:
  - cis:
    - 4.1.4
  - cis_csc_v7:
    - '6.2'
  - cmmc_v2.0:
    - AU.2.042
    - AU.5.055
  - iso_27001-2013:
    - A.12.4.1
  - nist_sp_800-53:
    - AU-12
    - AU-3
  - pci_dss_v3.2.1:
    - '10.2'
    - '10.3'
  condition: any
  rules:
  - not f:/boot/grub/grub.cfg -> !r:^\s*\t*linux && r:audit=1
  - not f:/boot/grub2/grub.cfg -> !r:^\s*\t*linux && r:audit=1
  - not f:/boot/grub/menu.lst -> !r:^\s*\t*kernel && r:audit=1
- id: 36107
  title: Ensure audit log storage size is configured.
  description: Configure the maximum size of the audit log file. Once the log reaches
    the maximum size, it will be rotated and a new log file will be started.
  rationale: It is important that an appropriate size is determined for log files
    so that they do not impact the system and audit data is not lost.
  remediation: 'Set the following parameter in /etc/audit/auditd.conf in accordance
    with site policy: max_log_file = <MB> Notes: The max_log_file parameter is measured
    in megabytes. Other methods of log rotation may be appropriate based on site policy.
    One example is time-based rotation strategies which don''t have native support
    in auditd configurations. Manual audit of custom configurations should be evaluated
    for effectiveness and completeness.'
  compliance:
  - cis:
    - 4.1.1.1
  - cis_csc_v7:
    - '6.4'
  - iso_27001-2013:
    - A.12.4.1
  - nist_sp_800-53:
    - AU-4
  - pci_dss_v3.2.1:
    - '10.7'
  condition: all
  rules:
  - f:/etc/audit/auditd.conf
  - f:/etc/audit/auditd.conf -> r:max_log_file\s*\t*=\s*\t*\d+
- id: 36109
  title: Ensure audit logs are not automatically deleted.
  description: The max_log_file_action setting determines how to handle the audit
    log file reaching the max file size. A value of keep_logs will rotate the logs
    but never delete old logs.
  rationale: In high security contexts, the benefits of maintaining a long audit history
    exceed the cost of storing the audit history.
  remediation: 'Set the following parameter in /etc/audit/auditd.conf: max_log_file_action
    = keep_logs.'
  compliance:
  - cis:
    - 4.1.1.3
  - cis_csc_v7:
    - '6.4'
  - iso_27001-2013:
    - A.12.4.1
  - nist_sp_800-53:
    - AU-4
  - pci_dss_v3.2.1:
    - '10.7'
  condition: all
  rules:
  - f:/etc/audit/auditd.conf
  - f:/etc/audit/auditd.conf -> r:max_log_file_action\s*\t*=\s*\t*keep_logs
- id: 36113
  title: Ensure events that modify date and time information are collected.
  description: Capture events where the system date and/or time has been modified.
    The parameters in this section are set to determine if the adjtimex (tune kernel
    clock), settimeofday (Set time, using timeval and timezone structures) stime (using
    seconds since 1/1/1970) or clock_settime (allows for the setting of several internal
    clocks and timers) system calls have been executed and always write an audit record
    to the /var/log/audit.log file upon exit, tagging the records with the identifier
    "time-change".
  rationale: Unexpected changes in system date and/or time could be a sign of malicious
    activity on the system.
  remediation: 'For 32 bit systems Edit or create a file in the /etc/audit/rules.d/
    directory ending in x.rules Example: vi /etc/audit/rules.d/audit.rules and add
    the following lines -a always exit -F arch=b32 -S adjtimex -S settimeofday -S
    stime -k time change -a always exit -F arch=b32 -S clock_settime -k time-change
    -w /etc/localtime -p wa -k time-change For 64 bit systems Edit or create a file
    in the /etc/audit/rules.d/ directory ending in x.rules Example: vi /etc/audit/rules.d/audit.rules
    and add the following lines -a always exit -F arch=b64 -S adjtimex -S settimeofday
    -k time-change -a always exit -F arch=b32 -S adjtimex -S settimeofday -S stime
    -k time change -a always,exit -F arch=b64 -S clock_settime -k time-change -a always,exit
    -F arch=b32 -S clock_settime -k time-change -w /etc/localtime -p wa -k time-change
    Notes: Reloading the auditd config to set active settings may require a system
    reboot.'
  compliance:
  - cis:
    - 4.1.5
  - cis_csc_v7:
    - '5.5'
  - iso_27001-2013:
    - A.12.1.2
  - mitre_techniques:
    - T1527
    - T1176
    - T1088
    - T1081
    - T1214
    - T1530
    - T1213
    - T1038
    - T1073
    - T1482
    - T1114
    - T1044
    - T1484
    - T1525
    - T1161
    - T1031
    - T1034
    - T1145
    - T1076
    - T1053
    - T1505
    - T1528
    - T1078
  - nist_sp_800-53:
    - CM-6
  - pci_dss_v3.2.1:
    - '11.5'
  condition: all
  rules:
  - d:/etc/audit/rules.d
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k time-change|-F key=time-change &&
    r:^-a && r:always,exit|exit,always && r:-F arch=b64 && r:-S && r:adjtimex,settimeofday|settimeofday,adjtimex
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k time-change|-F key=time-change &&
    r:^-a && r:always,exit|exit,always && r:-F arch=b32 && r:-S && r:adjtimex,settimeofday|settimeofday,adjtimex
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k time-change|-F key=time-change &&
    r:^-a && r:always,exit|exit,always && r:-F arch=b64 && r:-S clock_settime && r:-F
    a0=0x0
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k time-change|-F key=time-change &&
    r:^-a && r:always,exit|exit,always && r:-F arch=b32 && r:-S clock_settime && r:-F
    a0=0x0
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k time-change|-F key=time-change &&
    r:^-w && r:/etc/localtime && r:-p wa
  - c:auditctl -l -> r:-k time-change|-F key=time-change && r:^-a && r:always,exit|exit,always
    && r:-F arch=b64 && r:-S && r:adjtimex,settimeofday|settimeofday,adjtimex
  - c:auditctl -l -> r:-k time-change|-F key=time-change && r:^-a && r:always,exit|exit,always
    && r:-F arch=b32 && r:-S && r:adjtimex,settimeofday|settimeofday,adjtimex
  - c:auditctl -l -> r:-k time-change|-F key=time-change && r:^-a && r:always,exit|exit,always
    && r:-F arch=b64 && r:-S clock_settime && r:-F a0=0x0
  - c:auditctl -l -> r:-k time-change|-F key=time-change && r:^-a && r:always,exit|exit,always
    && r:-F arch=b32 && r:-S clock_settime && r:-F a0=0x0
  - c:auditctl -l -> r:-k time-change|-F key=time-change && r:^-w && r:/etc/localtime
    && r:-p wa
- id: 36114
  title: Ensure events that modify user/group information are collected.
  description: Record events affecting the group , passwd (user IDs), shadow and gshadow
    (passwords) or /etc/security/opasswd (old passwords, based on remember parameter
    in the PAM configuration) files. The parameters in this section will watch the
    files to see if they have been opened for write or have had attribute changes
    (e.g. permissions) and tag them with the identifier "identity" in the audit log
    file.
  rationale: Unexpected changes to these files could be an indication that the system
    has been compromised and that an unauthorized user is attempting to hide their
    activities or compromise additional accounts.
  remediation: 'Edit or create a file in the /etc/audit/rules.d/ directory ending
    in .rules Example: vi /etc/audit/rules.d/audit.rules and add the following lines:
    -w /etc/group -p wa -k identity -w /etc/passwd -p wa -k identity -w /etc/gshadow
    -p wa -k identity -w /etc/shadow -p wa -k identity -w /etc/security/opasswd -p
    wa -k identity Notes: Reloading the auditd config to set active settings may require
    a system reboot.'
  compliance:
  - cis:
    - 4.1.6
  - cis_csc_v7:
    - '4.8'
  - iso_27001-2013:
    - A.12.4.3
  - mitre_techniques:
    - T1134
    - T1098
    - T1017
    - T1067
    - T1088
    - T1175
    - T1136
    - T1003
    - T1214
    - T1190
    - T1210
    - T1495
    - T1525
    - T1208
    - T1215
    - T1075
    - T1097
    - T1086
    - T1055
    - T1076
    - T1053
    - T1505
    - T1035
    - T1051
    - T1218
    - T1184
    - T1169
    - T1206
    - T1019
    - T1501
    - T1072
    - T1078
    - T1100
    - T1077
    - T1047
    - T1084
    - T1028
    - T1156
    - T1146
    - T1196
    - T1081
    - T1530
    - T1089
    - T1073
    - T1157
    - T1054
    - T1070
    - T1037
    - T1036
    - T1096
    - T1034
    - T1150
    - T1504
    - T1145
    - T1494
    - T1489
    - T1198
    - T1165
    - T1492
    - T1080
    - T1209
  - nist_sp_800-53:
    - AU-3
  - pci_dss_v3.2.1:
    - 10.2.5
  condition: all
  rules:
  - d:/etc/audit/rules.d
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k identity|-F key=identity && r:^-w
    && r:/etc/group && r:-p wa
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k identity|-F key=identity && r:^-w
    && r:/etc/passwd && r:-p wa
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k identity|-F key=identity && r:^-w
    && r:/etc/gshadow && r:-p wa
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k identity|-F key=identity && r:^-w
    && r:/etc/shadow && r:-p wa
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k identity|-F key=identity && r:^-w
    && r:/etc/security/opasswd && r:-p wa
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k identity|-F key=identity && r:^-w
    && r:/etc/nsswitch.conf && r:-p wa
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k identity|-F key=identity && r:^-w
    && r:/etc/pam.conf && r:-p wa
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k identity|-F key=identity && r:^-w
    && r:/etc/pam.d && r:-p wa
  - c:auditctl -l -> r:-k identity|-F key=identity && r:^-w && r:/etc/group && r:-p
    wa
  - c:auditctl -l -> r:-k identity|-F key=identity && r:^-w && r:/etc/passwd && r:-p
    wa
  - c:auditctl -l -> r:-k identity|-F key=identity && r:^-w && r:/etc/gshadow && r:-p
    wa
  - c:auditctl -l -> r:-k identity|-F key=identity && r:^-w && r:/etc/shadow && r:-p
    wa
  - c:auditctl -l -> r:-k identity|-F key=identity && r:^-w && r:/etc/security/opasswd
    && r:-p wa
  - c:auditctl -l -> r:-k identity|-F key=identity && r:^-w && r:/etc/nsswitch.conf
    && r:-p wa
  - c:auditctl -l -> r:-k identity|-F key=identity && r:^-w && r:/etc/pam.conf &&
    r:-p wa
  - c:auditctl -l -> r:-k identity|-F key=identity && r:^-w && r:/etc/pam.d && r:-p
    wa
- id: 36115
  title: Ensure events that modify the system's Mandatory Access Controls are collected.
  description: Monitor SELinux/AppArmor mandatory access controls. The parameters
    below monitor any write access (potential additional, deletion or modification
    of files in the directory) or attribute changes to the /etc/selinux or /etc/apparmor
    and /etc/apparmor.d directories.
  rationale: Changes to files in these directories could indicate that an unauthorized
    user is attempting to modify access controls and change security contexts, leading
    to a compromise of the system.
  remediation: 'On systems using SELinux Edit or create a file in the /etc/audit/rules.d/
    directory ending in .rules Example: vi /etc/audit/rules.d/audit.rules and add
    the following lines: -w /etc/selinux/ -p wa -k MAC-policy -w /usr/share/selinux/
    -p wa -k MAC-policy On systems using AppArmor Edit or create a file in the /etc/audit/rules.d/
    directory ending in .rules Example: vi /etc/audit/rules.d/audit.rules and add
    the following lines: -w /etc/apparmor/ -p wa -k MAC-policy -w /etc/apparmor.d/
    -p wa -k MAC-policy Notes: Reloading the auditd config to set active settings
    may require a system reboot.'
  compliance:
  - cis:
    - 4.1.8
  - cis_csc_v7:
    - '5.5'
  - iso_27001-2013:
    - A.12.1.2
  - mitre_techniques:
    - T1527
    - T1176
    - T1088
    - T1081
    - T1214
    - T1530
    - T1213
    - T1038
    - T1073
    - T1482
    - T1114
    - T1044
    - T1484
    - T1525
    - T1161
    - T1031
    - T1034
    - T1145
    - T1076
    - T1053
    - T1505
    - T1528
    - T1078
  - nist_sp_800-53:
    - CM-6
  - pci_dss_v3.2.1:
    - '11.5'
  condition: all
  rules:
  - d:/etc/audit/rules.d
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k MAC-policy|-F key=MAC-policy && r:^-w
    && r:/etc/apparmor && r:-p wa
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k MAC-policy|-F key=MAC-policy && r:^-w
    && r:/etc/apparmor.d && r:-p wa
  - c:auditctl -l -> r:-k MAC-policy|-F key=MAC-policy && r:^-w && r:/etc/apparmor
    && r:-p wa
  - c:auditctl -l -> r:-k MAC-policy|-F key=MAC-policy && r:^-w && r:/etc/apparmor.d
    && r:-p wa
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-w /etc/selinux/ -p wa -k MAC-policy
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-w /usr/share/selinux/ -p wa -k MAC-policy
  - c:auditctl -l -> r:^-w && r:/etc/selinux && r:-p wa && r:-k MAC-policy|key=MAC-policy
  - c:auditctl -l -> r:^-w && r:/usr/share/selinux && r:-p wa && r:-k MAC-policy|key=MAC-policy
- id: 36116
  title: Ensure login and logout events are collected.
  description: Monitor login and logout events. The parameters below track changes
    to files associated with login/logout events. The file /var/log/faillog tracks
    failed events from login. The file /var/log/lastlog maintain records of the last
    time a user successfully logged in. The file /var/log/tallylog maintains records
    of failures via the pam_tally2 module.
  rationale: Monitoring login/logout events could provide a system administrator with
    information associated with brute force attacks against user logins.
  remediation: 'Edit or create a file in the /etc/audit/rules.d/ directory ending
    in .rules Example: vi /etc/audit/rules.d/audit.rules and add the following lines:
    -w /var/log/faillog -p wa -k logins -w /var/log/lastlog -p wa -k logins -w /var/log/tallylog
    -p wa -k logins Notes: Reloading the auditd config to set active settings may
    require a system reboot.'
  compliance:
  - cis:
    - 4.1.9
  - cis_csc_v7:
    - '16.10'
  - cmmc_v2.0:
    - IA.3.085
    - IA.3.086
  - mitre_techniques:
    - T1110
    - T1527
    - T1176
    - T1088
    - T1081
    - T1214
    - T1530
    - T1213
    - T1038
    - T1073
    - T1482
    - T1114
    - T1044
    - T1484
    - T1525
    - T1161
    - T1031
    - T1034
    - T1145
    - T1076
    - T1053
    - T1505
    - T1528
    - T1078
    - T1134
    - T1197
    - T1538
    - T1089
    - T1157
    - T1054
    - T1159
    - T1160
    - T1152
    - T1168
    - T1162
    - T1185
    - T1050
    - T1075
    - T1097
    - T1163
    - T1021
    - T1489
    - T1051
    - T1023
    - T1165
    - T1501
    - T1072
    - T1537
    - T1047
    - T1084
    - T1004
  - pci_dss_v3.2.1:
    - 8.1.4
  condition: all
  rules:
  - d:/etc/audit/rules.d
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k logins|-F key=logins && r:^-w &&
    r:/var/log/lastlog && r:-p wa
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k logins|-F key=logins && r:^-w &&
    r:/var/run/faillock && r:-p wa
  - c:auditctl -l -> r:-k logins|-F key=logins && r:^-w && r:/var/log/lastlog && r:-p
    wa
  - c:auditctl -l -> r:-k logins|-F key=logins && r:^-w && r:/var/run/faillock &&
    r:-p wa
- id: 36117
  title: Ensure session initiation information is collected.
  description: Monitor session initiation events. The parameters in this section track
    changes to the files associated with session events. The file /var/run/utmp tracks
    all currently logged in users. All audit records will be tagged with the identifier
    "session." The /var/log/wtmp file tracks logins, logouts, shutdown, and reboot
    events. The file /var/log/btmp keeps track of failed login attempts and can be
    read by entering the command /usr/bin/last -f /var/log/btmp All audit records
    will be tagged with the identifier "logins.".
  rationale: Monitoring these files for changes could alert a system administrator
    to logins occurring at unusual hours, which could indicate intruder activity (i.e.
    a user logging in at a time when they do not normally log in).
  remediation: 'Edit or create a file in the /etc/audit/rules.d/ directory ending
    in .rules Example: vi /etc/audit/rules.d/audit.rules and add the following lines:
    -w /var/run/utmp -p wa -k session -w /var/log/wtmp -p wa -k logins -w /var/log/btmp
    -p wa -k logins Notes: The last command can be used to read /var/log/wtmp (last
    with no parameters) and /var/run/utmp (last -f /var/run/utmp) Reloading the auditd
    config to set active settings may require a system reboot.'
  compliance:
  - cis:
    - 4.1.10
  - cis_csc_v7:
    - '16.10'
  - cmmc_v2.0:
    - IA.3.085
    - IA.3.086
  - mitre_techniques:
    - T1110
    - T1527
    - T1176
    - T1088
    - T1081
    - T1214
    - T1530
    - T1213
    - T1038
    - T1073
    - T1482
    - T1114
    - T1044
    - T1484
    - T1525
    - T1161
    - T1031
    - T1034
    - T1145
    - T1076
    - T1053
    - T1505
    - T1528
    - T1078
    - T1134
    - T1197
    - T1538
    - T1089
    - T1157
    - T1054
    - T1159
    - T1160
    - T1152
    - T1168
    - T1162
    - T1185
    - T1050
    - T1075
    - T1097
    - T1163
    - T1021
    - T1489
    - T1051
    - T1023
    - T1165
    - T1501
    - T1072
    - T1537
    - T1047
    - T1084
    - T1004
  - pci_dss_v3.2.1:
    - 8.1.4
  condition: all
  rules:
  - d:/etc/audit/rules.d
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k session|-F key=session && r:^-w &&
    r:/var/run/utmp && r:-p wa
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k session|-F key=session && r:^-w &&
    r:/var/log/wtmp && r:-p wa
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k session|-F key=session && r:^-w &&
    r:/var/log/btmp && r:-p wa
  - c:auditctl -l -> r:-k session|-F key=session && r:^-w && r:/var/run/utmp && r:-p
    wa
  - c:auditctl -l -> r:-k session|-F key=session && r:^-w && r:/var/log/wtmp && r:-p
    wa
  - c:auditctl -l -> r:-k session|-F key=session && r:^-w && r:/var/log/btmp && r:-p
    wa
- id: 36118
  title: Ensure discretionary access control permission modification events are collected.
  description: Monitor changes to file permissions, attributes, ownership and group.
    The parameters in this section track changes for system calls that affect file
    permissions and attributes. The chmod , fchmod and fchmodat system calls affect
    the permissions associated with a file. The chown , fchown , fchownat and lchown
    system calls affect owner and group attributes on a file. The setxattr , lsetxattr
    , fsetxattr (set extended file attributes) and removexattr , lremovexattr , fremovexattr
    (remove extended file attributes) control extended file attributes. In all cases,
    an audit record will only be written for non-system user ids (auid >= 500) and
    will ignore Daemon events (auid = 4294967295). All audit records will be tagged
    with the identifier "perm_mod.".
  rationale: Monitoring for changes in file attributes could alert a system administrator
    to activity that could indicate intruder activity or policy violation.
  remediation: 'For 32 bit systems Edit or create a file in the /etc/audit/rules.d/
    directory ending in .rules Example: vi /etc/audit/rules.d/audit.rules and add
    the following lines: -a always,exit -F arch=b32 -S chmod -S fchmod -S fchmodat
    -F auid>=500 -F auid!=4294967295 -k perm_mod -a always,exit -F arch=b32 -S chown
    -S fchown -S fchownat -S lchown -F auid>=500 -F auid!=4294967295 -k perm_mod -a
    always,exit -F arch=b32 -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S
    lremovexattr -S fremovexattr -F auid>=500 -F auid!=4294967295 -k perm_mod For
    64 bit systems Edit or create a file in the /etc/audit/rules.d/ directory ending
    in .rules Example: vi /etc/audit/rules.d/audit.rules and add the following lines:
    -a always,exit -F arch=b64 -S chmod -S fchmod -S fchmodat -F auid>=500 -F auid!=4294967295
    -k perm_mod -a always,exit -F arch=b32 -S chmod -S fchmod -S fchmodat -F auid>=500
    -F auid!=4294967295 -k perm_mod -a always,exit -F arch=b64 -S chown -S fchown
    -S fchownat -S lchown -F auid>=500 -F auid!=4294967295 -k perm_mod -a always,exit
    -F arch=b32 -S chown -S fchown -S fchownat -S lchown -F auid>=500 -F auid!=4294967295
    -k perm_mod -a always,exit -F arch=b64 -S setxattr -S lsetxattr -S fsetxattr -S
    removexattr -S lremovexattr -S fremovexattr -F auid>=500 -F auid!=4294967295 -k
    perm_mod -a always,exit -F arch=b32 -S setxattr -S lsetxattr -S fsetxattr -S removexattr
    -S lremovexattr -S fremovexattr -F auid>=500 -F auid!=4294967295 -k perm_mod Notes:
    Reloading the auditd config to set active settings may require a system reboot.'
  compliance:
  - cis:
    - 4.1.11
  - cis_csc_v7:
    - '5.5'
  - iso_27001-2013:
    - A.12.1.2
  - mitre_techniques:
    - T1527
    - T1176
    - T1088
    - T1081
    - T1214
    - T1530
    - T1213
    - T1038
    - T1073
    - T1482
    - T1114
    - T1044
    - T1484
    - T1525
    - T1161
    - T1031
    - T1034
    - T1145
    - T1076
    - T1053
    - T1505
    - T1528
    - T1078
  - nist_sp_800-53:
    - CM-6
  - pci_dss_v3.2.1:
    - '11.5'
  condition: all
  rules:
  - d:/etc/audit/rules.d
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k perm_mod|-F key=perm_mod && r:^-a
    && r:always,exit|exit,always && r:-F arch=b64 && r:-S && r:chmod && r:fchmod &&
    r:fchmodat && r:-F auid>=\d+ && r:-F auid!=unset|-F auid!=-1
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k perm_mod|-F key=perm_mod && r:^-a
    && r:always,exit|exit,always && r:-F arch=b64 && r:-S && r:chown && r:fchown &&
    r:lchown && r:fchownat && r:-F auid>=\d+ && r:-F auid!=unset|-F auid!=-1
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k perm_mod|-F key=perm_mod && r:^-a
    && r:always,exit|exit,always && r:-F arch=b32 && r:-S && r:chmod && r:fchmod &&
    r:fchmodat && r:-F auid>=\d+ && r:-F auid!=unset|-F auid!=-1
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k perm_mod|-F key=perm_mod && r:^-a
    && r:always,exit|exit,always && r:-F arch=b32 && r:-S && r:lchown && r:fchown
    && r:chown && r:fchownat && r:-F auid>=\d+ && r:-F auid!=unset|-F auid!=-1
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k perm_mod|-F key=perm_mod && r:^-a
    && r:always,exit|exit,always && r:-F arch=b64 && r:-S && r:setxattr && r:lsetxattr
    && r:fsetxattr && r:removexattr && r:lremovexattr && r:fremovexattr && r:-F auid>=\d+
    && r:-F auid!=unset|-F auid!=-1
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k perm_mod|-F key=perm_mod && r:^-a
    && r:always,exit|exit,always && r:-F arch=b32 && r:-S && r:setxattr && r:lsetxattr
    && r:fsetxattr && r:removexattr && r:lremovexattr && r:fremovexattr && r:-F auid>=\d+
    && r:-F auid!=unset|-F auid!=-1
  - c:auditctl -l -> r:-k perm_mod|-F key=perm_mod && r:^-a && r:always,exit|exit,always
    && r:-F arch=b64 && r:-S && r:chmod && r:fchmod && r:fchmodat && r:-F auid>=\d+
    && r:-F auid!=unset|-F auid!=-1
  - c:auditctl -l -> r:-k perm_mod|-F key=perm_mod && r:^-a && r:always,exit|exit,always
    && r:-F arch=b64 && r:-S && r:chown && r:fchown && r:lchown && r:fchownat && r:-F
    auid>=\d+ && r:-F auid!=unset|-F auid!=-1
  - c:auditctl -l -> r:-k perm_mod|-F key=perm_mod && r:^-a && r:always,exit|exit,always
    && r:-F arch=b32 && r:-S && r:chmod && r:fchmod && r:fchmodat && r:-F auid>=\d+
    && r:-F auid!=unset|-F auid!=-1
  - c:auditctl -l -> r:-k perm_mod|-F key=perm_mod && r:^-a && r:always,exit|exit,always
    && r:-F arch=b32 && r:-S && r:lchown && r:fchown && r:chown && r:fchownat && r:-F
    auid>=\d+ && r:-F auid!=unset|-F auid!=-1
  - c:auditctl -l -> r:-k perm_mod|-F key=perm_mod && r:^-a && r:always,exit|exit,always
    && r:-F arch=b64 && r:-S && r:setxattr && r:lsetxattr && r:fsetxattr && r:removexattr
    && r:lremovexattr && r:fremovexattr && r:-F auid>=\d+ && r:-F auid!=unset|-F auid!=-1
  - c:auditctl -l -> r:-k perm_mod|-F key=perm_mod && r:^-a && r:always,exit|exit,always
    && r:-F arch=b32 && r:-S && r:setxattr && r:lsetxattr && r:fsetxattr && r:removexattr
    && r:lremovexattr && r:fremovexattr && r:-F auid>=\d+ && r:-F auid!=unset|-F auid!=-1
- id: 36119
  title: Ensure unsuccessful unauthorized file access attempts are collected.
  description: Monitor for unsuccessful attempts to access files. The parameters below
    are associated with system calls that control creation (creat), opening (open
    , openat) and truncation ( truncate , ftruncate) of files. An audit log record
    will only be written if the user is a non-privileged user (auid > = 500), is not
    a Daemon event (auid=4294967295) and if the system call returned EACCES (permission
    denied to the file) or EPERM (some other permanent error associated with the specific
    system call). All audit records will be tagged with the identifier "access.".
  rationale: Failed attempts to open, create or truncate files could be an indication
    that an individual or process is trying to gain unauthorized access to the system.
  remediation: 'For 32 bit systems Edit or create a file in the /etc/audit/rules.d/
    directory ending in .rules Example: vi /etc/audit/rules.d/audit.rules and add
    the following lines: -a always,exit -F arch=b32 -S creat -S open -S openat -S
    truncate -S ftruncate -F exit=-EACCES -F auid>=500 -F auid!=4294967295 -k access
    -a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S ftruncate
    -F exit=-EPERM -F auid>=500 -F auid!=4294967295 -k access For 64 bit systems Edit
    or create a file in the /etc/audit/rules.d/ directory ending in .rules Example:
    vi /etc/audit/rules.d/audit.rules and add the following lines: -a always,exit
    -F arch=b64 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EACCES
    -F auid>=500 -F auid!=4294967295 -k access -a always,exit -F arch=b32 -S creat
    -S open -S openat -S truncate -S ftruncate -F exit=-EACCES -F auid>=500 -F auid!=4294967295
    -k access -a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S
    ftruncate -F exit=-EPERM -F auid>=500 -F auid!=4294967295 -k access -a always,exit
    -F arch=b32 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EPERM
    -F auid>=500 -F auid!=4294967295 -k access Notes: Reloading the auditd config
    to set active settings may require a system reboot.'
  compliance:
  - cis:
    - 4.1.12
  - cis_csc_v7:
    - '14.9'
  - cmmc_v2.0:
    - AU.3.050
  - iso_27001-2013:
    - A.12.4.3
  - nist_sp_800-53:
    - AU-3
  - pci_dss_v3.2.1:
    - 10.2.1
    - '11.5'
  condition: all
  rules:
  - d:/etc/audit/rules.d
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k access|-F key=access && r:^-a &&
    r:always,exit|exit,always && r:-F arch=b64 && r:-S && r:creat && r:open && r:openat
    && r:truncate && r:ftruncate && r:-F exit=-EACCES && r:-F auid>=\d+ && r:-F auid!=unset|-F
    auid!=-1
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k access|-F key=access && r:^-a &&
    r:always,exit|exit,always && r:-F arch=b32 && r:-S && r:creat && r:open && r:openat
    && r:truncate && r:ftruncate && r:-F exit=-EACCES && r:-F auid>=\d+ && r:-F auid!=unset|-F
    auid!=-1
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k access|-F key=access && r:^-a &&
    r:always,exit|exit,always && r:-F arch=b64 && r:-S && r:creat && r:open && r:openat
    && r:truncate && r:ftruncate && r:-F exit=-EPERM && r:-F auid>=\d+ && r:-F auid!=unset|-F
    auid!=-1
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k access|-F key=access && r:^-a &&
    r:always,exit|exit,always && r:-F arch=b32 && r:-S && r:creat && r:open && r:openat
    && r:truncate && r:ftruncate && r:-F exit=-EPERM && r:-F auid>=\d+ && r:-F auid!=unset|-F
    auid!=-1
  - c:auditctl -l -> r:-k access|-F key=access && r:^-a && r:always,exit|exit,always
    && r:-F arch=b64 && r:-S && r:creat && r:open && r:openat && r:truncate && r:ftruncate
    && r:-F exit=-EACCES && r:-F auid>=\d+ && r:-F auid!=unset|-F auid!=-1
  - c:auditctl -l -> r:-k access|-F key=access && r:^-a && r:always,exit|exit,always
    && r:-F arch=b32 && r:-S && r:creat && r:open && r:openat && r:truncate && r:ftruncate
    && r:-F exit=-EACCES && r:-F auid>=\d+ && r:-F auid!=unset|-F auid!=-1
  - c:auditctl -l -> r:-k access|-F key=access && r:^-a && r:always,exit|exit,always
    && r:-F arch=b64 && r:-S && r:creat && r:open && r:openat && r:truncate && r:ftruncate
    && r:-F exit=-EPERM && r:-F auid>=\d+ && r:-F auid!=unset|-F auid!=-1
  - c:auditctl -l -> r:-k access|-F key=access && r:^-a && r:always,exit|exit,always
    && r:-F arch=b32 && r:-S && r:creat && r:open && r:openat && r:truncate && r:ftruncate
    && r:-F exit=-EPERM && r:-F auid>=\d+ && r:-F auid!=unset|-F auid!=-1
- id: 36120
  title: Ensure successful file system mounts are collected.
  description: Monitor the use of the mount system call. The mount (and umount) system
    call controls the mounting and unmounting of file systems. The parameters below
    configure the system to create an audit record when the mount system call is used
    by a non-privileged user.
  rationale: It is highly unusual for a non privileged user to mount file systems
    to the system. While tracking mount commands gives the system administrator evidence
    that external media may have been mounted (based on a review of the source of
    the mount and confirming it's an external media type), it does not conclusively
    indicate that data was exported to the media. System administrators who wish to
    determine if data were exported, would also have to track successful open , creat
    and truncate system calls requiring write access to a file under the mount point
    of the external media file system. This could give a fair indication that a write
    occurred. The only way to truly prove it, would be to track successful writes
    to the external media. Tracking write system calls could quickly fill up the audit
    log and is not recommended. Recommendations on configuration options to track
    data export to media is beyond the scope of this document.
  remediation: 'For 32 bit systems Edit or create a file in the /etc/audit/rules.d/
    directory ending in .rules Example: vi /etc/audit/rules.d/audit.rules and add
    the following lines: -a always,exit -F arch=b32 -S mount -F auid>=500 -F auid!=4294967295
    -k mounts For 64 bit systems Edit or create a file in the /etc/audit/rules.d/
    directory ending in .rules Example: vi /etc/audit/rules.d/audit.rules and add
    the following lines: -a always,exit -F arch=b64 -S mount -F auid>=500 -F auid!=4294967295
    -k mounts -a always,exit -F arch=b32 -S mount -F auid>=500 -F auid!=4294967295
    -k mounts Notes: This tracks successful and unsuccessful mount commands. File
    system mounts do not have to come from external media and this action still does
    not verify write (e.g. CD ROMS). Reloading the auditd config to set active settings
    may require a system reboot.'
  compliance:
  - cis:
    - 4.1.14
  - cis_csc_v7:
    - '5.1'
  - cmmc_v2.0:
    - AC.1.002
    - CM.2.061
    - SC.3.180
  - iso_27001-2013:
    - A.14.2.5
    - A.8.1.3
  - mitre_techniques:
    - T1003
    - T1011
    - T1015
    - T1017
    - T1019
    - T1028
    - T1034
    - T1035
    - T1036
    - T1037
    - T1044
    - T1047
    - T1051
    - T1053
    - T1054
    - T1055
    - T1058
    - T1067
    - T1070
    - T1072
    - T1073
    - T1075
    - T1076
    - T1077
    - T1078
    - T1080
    - T1081
    - T1084
    - T1086
    - T1087
    - T1088
    - T1089
    - T1092
    - T1096
    - T1097
    - T1098
    - T1100
    - T1110
    - T1112
    - T1130
    - T1133
    - T1134
    - T1136
    - T1137
    - T1138
    - T1139
    - T1142
    - T1145
    - T1146
    - T1147
    - T1148
    - T1150
    - T1156
    - T1157
    - T1165
    - T1166
    - T1169
    - T1173
    - T1174
    - T1175
    - T1176
    - T1177
    - T1178
    - T1184
    - T1187
    - T1190
    - T1196
    - T1197
    - T1198
    - T1199
    - T1200
    - T1201
    - T1206
    - T1208
    - T1209
    - T1210
    - T1214
    - T1215
    - T1218
    - T1485
    - T1486
    - T1487
    - T1488
    - T1489
    - T1490
    - T1491
    - T1492
    - T1494
    - T1495
    - T1501
    - T1503
    - T1504
    - T1505
    - T1506
    - T1525
    - T1530
    - T1535
    - T1537
    - T1539
  - nist_sp_800-53:
    - AU-2
    - CM-1
    - CM-2
    - CM-6
    - CM-7
    - IA-5
    - IA-6
    - SC-20
    - SC-21
  - pci_dss_v3.2.1:
    - '2.2'
  condition: all
  rules:
  - d:/etc/audit/rules.d
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k mounts|-F key=mounts && r:^-a &&
    r:always,exit|exit,always && r:-F arch=b64 && r:-S mount && r:-F auid>=\d+ &&
    r:-F auid!=unset|-F auid!=-1
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k mounts|-F key=mounts && r:^-a &&
    r:always,exit|exit,always && r:-F arch=b32 && r:-S mount && r:-F auid>=\d+ &&
    r:-F auid!=unset|-F auid!=-1
  - c:auditctl -l -> r:-k mounts|-F key=mounts && r:^-a && r:always,exit|exit,always
    && r:-F arch=b64 && r:-S mount && r:-F auid>=\d+ && r:-F auid!=unset|-F auid!=-1
  - c:auditctl -l -> r:-k mounts|-F key=mounts && r:^-a && r:always,exit|exit,always
    && r:-F arch=b32 && r:-S mount && r:-F auid>=\d+ && r:-F auid!=unset|-F auid!=-1
- id: 36121
  title: Ensure file deletion events by users are collected.
  description: Monitor the use of system calls associated with the deletion or renaming
    of files and file attributes. This configuration statement sets up monitoring
    for the unlink (remove a file), unlinkat (remove a file attribute), rename (rename
    a file) and renameat (rename a file attribute) system calls and tags them with
    the identifier "delete".
  rationale: Monitoring these calls from non-privileged users could provide a system
    administrator with evidence that inappropriate removal of files and file attributes
    associated with protected files is occurring. While this audit option will look
    at all events, system administrators will want to look for specific privileged
    files that are being deleted or altered.
  remediation: 'For 32 bit systems Edit or create a file in the /etc/audit/rules.d/
    directory ending in .rules Example: vi /etc/audit/rules.d/audit.rules and add
    the following lines: -a always,exit -F arch=b32 -S unlink -S unlinkat -S rename
    -S renameat -F auid>=500 -F auid!=4294967295 -k delete For 64 bit systems Edit
    or create a file in the /etc/audit/rules.d/ directory ending in .rules Example:
    vi /etc/audit/rules.d/audit.rules and add the following lines: -a always,exit
    -F arch=b64 -S unlink -S unlinkat -S rename -S renameat -F auid>=500 -F auid!=4294967295
    -k delete -a always,exit -F arch=b32 -S unlink -S unlinkat -S rename -S renameat
    -F auid>=500 -F auid!=4294967295 -k delete Notes: At a minimum, configure the
    audit system to collect file deletion events for all users and root. Reloading
    the auditd config to set active settings may require a system reboot.'
  compliance:
  - cis:
    - 4.1.15
  - cis_csc_v7:
    - '13'
  condition: all
  rules:
  - d:/etc/audit/rules.d
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k delete|-F key=delete && r:^-a &&
    r:always,exit|exit,always && r:-F arch=b64 && r:-S && r:unlink && r:unlinkat &&
    r:rename && r:renameat && r:-F auid>=\d+ && r:-F auid!=unset|-F auid!=-1
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:-k delete|-F key=delete && r:^-a &&
    r:always,exit|exit,always && r:-F arch=b32 && r:-S && r:unlink && r:unlinkat &&
    r:rename && r:renameat && r:-F auid>=\d+ && r:-F auid!=unset|-F auid!=-1
  - c:auditctl -l -> r:-k delete|-F key=delete && r:^-a && r:always,exit|exit,always
    && r:-F arch=b64 && r:-S && r:unlink && r:unlinkat && r:rename && r:renameat &&
    r:-F auid>=\d+ && r:-F auid!=unset|-F auid!=-1
  - c:auditctl -l -> r:-k delete|-F key=delete && r:^-a && r:always,exit|exit,always
    && r:-F arch=b32 && r:-S && r:unlink && r:unlinkat && r:rename && r:renameat &&
    r:-F auid>=\d+ && r:-F auid!=unset|-F auid!=-1
- id: 36122
  title: Ensure changes to system administration scope (sudoers) is collected.
  description: Monitor scope changes for system administrations. If the system has
    been properly configured to force system administrators to log in as themselves
    first and then use the sudo command to execute privileged commands, it is possible
    to monitor changes in scope. The file /etc/sudoers will be written to when the
    file or its attributes have changed. The audit records will be tagged with the
    identifier "scope.".
  rationale: Changes in the /etc/sudoers file can indicate that an unauthorized change
    has been made to scope of system administrator activity.
  remediation: 'Edit or create a file in the /etc/audit/rules.d/ directory ending
    in .rules Example: vi /etc/audit/rules.d/audit.rules and add the following lines:
    -w /etc/sudoers -p wa -k scope -w /etc/sudoers.d/ -p wa -k scope Notes: Reloading
    the auditd config to set active settings may require a system reboot.'
  compliance:
  - cis:
    - 4.1.16
  - cis_csc_v7:
    - '4.8'
  - iso_27001-2013:
    - A.12.4.3
  - mitre_techniques:
    - T1134
    - T1098
    - T1017
    - T1067
    - T1088
    - T1175
    - T1136
    - T1003
    - T1214
    - T1190
    - T1210
    - T1495
    - T1525
    - T1208
    - T1215
    - T1075
    - T1097
    - T1086
    - T1055
    - T1076
    - T1053
    - T1505
    - T1035
    - T1051
    - T1218
    - T1184
    - T1169
    - T1206
    - T1019
    - T1501
    - T1072
    - T1078
    - T1100
    - T1077
    - T1047
    - T1084
    - T1028
    - T1156
    - T1146
    - T1196
    - T1081
    - T1530
    - T1089
    - T1073
    - T1157
    - T1054
    - T1070
    - T1037
    - T1036
    - T1096
    - T1034
    - T1150
    - T1504
    - T1145
    - T1494
    - T1489
    - T1198
    - T1165
    - T1492
    - T1080
    - T1209
  - nist_sp_800-53:
    - AU-3
  - pci_dss_v3.2.1:
    - 10.2.5
  condition: all
  rules:
  - d:/etc/audit/rules.d
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:^-w && r:/etc/sudoers && r:-p wa &&
    r:-k scope
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:^-w && r:/etc/sudoers.d && r:-p wa &&
    r:-k scope
  - c:auditctl -l -> r:^-w && r:/etc/sudoers && r:-p wa && r:-k scope
  - c:auditctl -l -> r:^-w && r:/etc/sudoers.d && r:-p wa && r:-k scope
- id: 36123
  title: Ensure kernel module loading and unloading is collected.
  description: Monitor the loading and unloading of kernel modules. The programs insmod
    (install a kernel module), rmmod (remove a kernel module), and modprobe (a more
    sophisticated program to load and unload modules, as well as some other features)
    control loading and unloading of modules. The init_module (load a module) and
    delete_module (delete a module) system calls control loading and unloading of
    modules. Any execution of the loading and unloading module programs and system
    calls will trigger an audit record with an identifier of "modules".
  rationale: Monitoring the use of insmod , rmmod and modprobe could provide system
    administrators with evidence that an unauthorized user loaded or unloaded a kernel
    module, possibly compromising the security of the system. Monitoring of the init_module
    and delete_module system calls would reflect an unauthorized user attempting to
    use a different program to load and unload modules.
  remediation: 'For 32 bit systems Edit or create a file in the /etc/audit/rules.d/
    directory ending in .rules Example: vi /etc/audit/rules.d/audit.rules and add
    the following lines: -w /sbin/insmod -p x -k modules -w /sbin/rmmod -p x -k modules
    -w /sbin/modprobe -p x -k modules -a always,exit -F arch=b32 -S init_module -S
    delete_module -k modules For 64 bit systems Edit or create a file in the /etc/audit/rules.d/
    directory ending in .rules Example: vi /etc/audit/rules.d/audit.rules and add
    the following lines: -w /sbin/insmod -p x -k modules -w /sbin/rmmod -p x -k modules
    -w /sbin/modprobe -p x -k modules -a always,exit -F arch=b64 -S init_module -S
    delete_module -k modules Notes: Reloading the auditd config to set active settings
    may require a system reboot.'
  compliance:
  - cis:
    - 4.1.18
  - cis_csc_v7:
    - '5.1'
  - cmmc_v2.0:
    - AC.1.002
    - CM.2.061
    - SC.3.180
  - iso_27001-2013:
    - A.14.2.5
    - A.8.1.3
  - mitre_techniques:
    - T1003
    - T1011
    - T1015
    - T1017
    - T1019
    - T1028
    - T1034
    - T1035
    - T1036
    - T1037
    - T1044
    - T1047
    - T1051
    - T1053
    - T1054
    - T1055
    - T1058
    - T1067
    - T1070
    - T1072
    - T1073
    - T1075
    - T1076
    - T1077
    - T1078
    - T1080
    - T1081
    - T1084
    - T1086
    - T1087
    - T1088
    - T1089
    - T1092
    - T1096
    - T1097
    - T1098
    - T1100
    - T1110
    - T1112
    - T1130
    - T1133
    - T1134
    - T1136
    - T1137
    - T1138
    - T1139
    - T1142
    - T1145
    - T1146
    - T1147
    - T1148
    - T1150
    - T1156
    - T1157
    - T1165
    - T1166
    - T1169
    - T1173
    - T1174
    - T1175
    - T1176
    - T1177
    - T1178
    - T1184
    - T1187
    - T1190
    - T1196
    - T1197
    - T1198
    - T1199
    - T1200
    - T1201
    - T1206
    - T1208
    - T1209
    - T1210
    - T1214
    - T1215
    - T1218
    - T1485
    - T1486
    - T1487
    - T1488
    - T1489
    - T1490
    - T1491
    - T1492
    - T1494
    - T1495
    - T1501
    - T1503
    - T1504
    - T1505
    - T1506
    - T1525
    - T1530
    - T1535
    - T1537
    - T1539
  - nist_sp_800-53:
    - AU-2
    - CM-1
    - CM-2
    - CM-6
    - CM-7
    - IA-5
    - IA-6
    - SC-20
    - SC-21
  - pci_dss_v3.2.1:
    - '2.2'
  condition: all
  rules:
  - d:/etc/audit/rules.d
  - d:/etc/audit/rules.d -> r:\.+.rules$
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:^-a && r:always,exit|exit,always &&
    r:-F arch=b64|-F arch=b32 && r:-S && r:init_module && r:delete_module && r:-k
    modules|-F key=modules
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:^-w && r:/sbin/insmod && r:-p x && r:-k
    modules|-F key=modules
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:^-w && r:/sbin/rmmod && r:-p x && r:-k
    modules|-F key=modules
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:^-w && r:/sbin/modprobe && r:-p x &&
    r:-k modules|-F key=modules
  - c:auditctl -l -> r:^-a && r:always,exit|exit,always && r:-F arch=b64|-F arch=b32
    && r:-S && r:init_module && r:delete_module && r:-k modules|-F key=modules
  - c:auditctl -l -> r:^-w && r:/sbin/insmod && r:-p x && r:-k modules|-F key=modules
  - c:auditctl -l -> r:^-w && r:/sbin/rmmod && r:-p x && r:-k modules|-F key=modules
  - c:auditctl -l -> r:^-w && r:/sbin/modprobe && r:-p x && r:-k modules|-F key=modules
- id: 36124
  title: Ensure the audit configuration is immutable.
  description: Set system audit so that audit rules cannot be modified with auditctl.
    Setting the flag "-e 2" forces audit to be put in immutable mode. Audit changes
    can only be made on system reboot.
  rationale: In immutable mode, unauthorized users cannot execute changes to the audit
    system to potentially hide malicious activity and then put the audit rules back.
    Users would most likely notice a system reboot and that could alert administrators
    of an attempt to make unauthorized audit changes.
  remediation: 'Edit or create the file /etc/audit/rules.d/99-finalize.rules and add
    the line -e 2 at the end of the file Notes: This setting will ensure reloading
    the auditd config to set active settings requires a system reboot.'
  compliance:
  - cis:
    - 4.1.19
  - cis_csc_v7:
    - '6'
  condition: any
  rules:
  - d:/etc/audit/rules.d
  - d:/etc/audit/rules.d -> r:\.+.rules$ -> r:^-e\s*\t*2
  - not d:/etc/audit/rules.d -> r:\.+.rules$ -> !r:\s*\t*-e 2$
- id: 36130
  title: Ensure journald is configured to write logfiles to persistent disk.
  description: Data from journald may be stored in volatile memory or persisted locally
    on the server. Logs in memory will be lost upon a system reboot. By persisting
    logs to local disk on the server they are protected from loss.
  rationale: Writing log data to disk will provide the ability to forensically reconstruct
    events which may have impacted the operations or security of a system even after
    a system crash or reboot.
  remediation: 'Edit the /etc/systemd/journald.conf file and add the following line:
    Storage=persistent.'
  references:
  - https://github.com/konstruktoid/hardening/blob/master/systemd.adoc#etcsystemdjournaldconf
  compliance:
  - cis:
    - 4.2.2.3
  - cis_csc_v7:
    - '6.2'
  - cmmc_v2.0:
    - AU.2.042
    - AU.5.055
  - iso_27001-2013:
    - A.12.4.1
  - nist_sp_800-53:
    - AU-12
    - AU-3
  - pci_dss_v3.2.1:
    - '10.2'
    - '10.3'
  condition: all
  rules:
  - f:/etc/systemd/journald.conf
  - f:/etc/systemd/journald.conf -> r:^\s*\t*Storage\s*=\s*persistent
- id: 36101
  title: Ensure IPv6 default deny firewall policy.
  description: A default deny all policy on connections ensures that any unconfigured
    network usage will be rejected.
  rationale: With a default accept policy the firewall will accept any packet that
    is not configured to be denied. It is easier to white list acceptable usage than
    to black list unacceptable usage.
  remediation: 'Run the following commands to implement a default DROP policy: # ip6tables
    -P INPUT DROP # ip6tables -P OUTPUT DROP # ip6tables -P FORWARD DROP Notes: Changing
    firewall settings while connected over network can result in being locked out
    of the system. Remediation will only affect the active system firewall, be sure
    to configure the default policy in your firewall management to apply on boot as
    well.'
  compliance:
  - cis:
    - 3.5.1.1
  - cis_csc_v7:
    - '9.4'
  - cmmc_v2.0:
    - CM.3.068
  - iso_27001-2013:
    - A.13.1.1
  - pci_dss_v3.2.1:
    - '1.4'
  condition: all
  rules:
  - c:ip6tables -L -> r:^Chain INPUT && r:policy DROP
  - c:ip6tables -L -> r:^Chain FORWARD && r:policy DROP
  - c:ip6tables -L -> r:^Chain OUTPUT && r:policy DROP
- id: 36086
  title: Ensure secure ICMP redirects are not accepted.
  description: Secure ICMP redirects are the same as ICMP redirects, except they come
    from gateways listed on the default gateway list. It is assumed that these gateways
    are known to your system, and that they are likely to be secure.
  rationale: It is still possible for even known gateways to be compromised. Setting
    net.ipv4.conf.all.secure_redirects to 0 protects the system from routing table
    updates by possibly compromised known gateways.
  remediation: 'Set the following parameters in /etc/sysctl.conf or a /etc/sysctl.d/*
    file: net.ipv4.conf.all.secure_redirects = 0 net.ipv4.conf.default.secure_redirects
    = 0 Run the following commands to set the active kernel parameters: # sysctl -w
    net.ipv4.conf.all.secure_redirects=0 # sysctl -w net.ipv4.conf.default.secure_redirects=0
    # sysctl -w net.ipv4.route.flush=1.'
  compliance:
  - cis:
    - 3.2.3
  - cis_csc_v7:
    - '11'
  condition: all
  rules:
  - c:sysctl net.ipv4.conf.all.secure_redirects -> r:=\s*\t*0$
  - c:sysctl net.ipv4.conf.default.secure_redirects -> r:=\s*\t*0$
- id: 36088
  title: Ensure broadcast ICMP requests are ignored.
  description: Setting net.ipv4.icmp_echo_ignore_broadcasts to 1 will cause the system
    to ignore all ICMP echo and timestamp requests to broadcast and multicast addresses.
  rationale: Accepting ICMP echo and timestamp requests with broadcast or multicast
    destinations for your network could be used to trick your host into starting (or
    participating) in a Smurf attack. A Smurf attack relies on an attacker sending
    large amounts of ICMP broadcast messages with a spoofed source address. All hosts
    receiving this message and responding would send echo-reply messages back to the
    spoofed address, which is probably not routable. If many hosts respond to the
    packets, the amount of traffic on the network could be significantly multiplied.
  remediation: 'Set the following parameters in /etc/sysctl.conf or a /etc/sysctl.d/*
    file: net.ipv4.icmp_echo_ignore_broadcasts = 1 Run the following commands to set
    the active kernel parameters: # sysctl -w net.ipv4.icmp_echo_ignore_broadcasts=1
    # sysctl -w net.ipv4.route.flush=1.'
  compliance:
  - cis:
    - 3.2.5
  - cis_csc_v7:
    - '11'
  condition: all
  rules:
  - c:sysctl net.ipv4.icmp_echo_ignore_broadcasts -> r:=\s*\t*1$
- id: 36089
  title: Ensure bogus ICMP responses are ignored.
  description: Setting icmp_ignore_bogus_error_responses to 1 prevents the kernel
    from logging bogus responses (RFC-1122 non-compliant) from broadcast reframes,
    keeping file systems from filling up with useless log messages.
  rationale: Some routers (and some attackers) will send responses that violate RFC-1122
    and attempt to fill up a log file system with many useless error messages.
  remediation: 'Set the following parameter in /etc/sysctl.conf or a /etc/sysctl.d/*
    file: net.ipv4.icmp_ignore_bogus_error_responses = 1 Run the following commands
    to set the active kernel parameters: # sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1
    # sysctl -w net.ipv4.route.flush=1.'
  compliance:
  - cis:
    - 3.2.6
  - cis_csc_v7:
    - '11'
  condition: all
  rules:
  - c:sysctl net.ipv4.icmp_ignore_bogus_error_responses -> r:=\s*\t*1$
- id: 36097
  title: Ensure DCCP is disabled.
  description: The Datagram Congestion Control Protocol (DCCP) is a transport layer
    protocol that supports streaming media and telephony. DCCP provides a way to gain
    access to congestion control, without having to do it at the application layer,
    but does not provide in-sequence delivery.
  rationale: If the protocol is not required, it is recommended that the drivers not
    be installed to reduce the potential attack surface.
  remediation: 'Edit or create a file in the /etc/modprobe.d/ directory ending in
    .conf Example: vim /etc/modprobe.d/dccp.conf and add the following line: install
    dccp /bin/true.'
  compliance:
  - cis:
    - 3.4.1
  - cis_csc_v7:
    - '9.2'
  - cmmc_v2.0:
    - CM.3.068
    - SC.5.230
  - iso_27001-2013:
    - A.13.1.3
  - mitre_techniques:
    - T1015
    - T1051
    - T1076
    - T1133
    - T1200
  - nist_sp_800-53:
    - SI-4
  - pci_dss_v3.2.1:
    - 1.2.1
    - 2.2.2
    - 2.2.5
  condition: all
  rules:
  - c:modprobe -n -v dccp -> r:install /bin/false|install /bin/true
  - not c:lsmod -> r:dccp
- id: 36098
  title: Ensure SCTP is disabled.
  description: The Stream Control Transmission Protocol (SCTP) is a transport layer
    protocol used to support message oriented communication, with several streams
    of messages in one connection. It serves a similar function as TCP and UDP, incorporating
    features of both. It is message-oriented like UDP, and ensures reliable in-sequence
    transport of messages with congestion control like TCP.
  rationale: If the protocol is not being used, it is recommended that kernel module
    not be loaded, disabling the service to reduce the potential attack surface.
  remediation: 'Edit or create a file in the /etc/modprobe.d/ directory ending in
    .conf Example: vim /etc/modprobe.d/sctp.conf and add the following line: install
    sctp /bin/true.'
  compliance:
  - cis:
    - 3.4.2
  - cis_csc_v7:
    - '9.2'
  - cmmc_v2.0:
    - CM.3.068
    - SC.5.230
  - iso_27001-2013:
    - A.13.1.3
  - mitre_techniques:
    - T1015
    - T1051
    - T1076
    - T1133
    - T1200
  - nist_sp_800-53:
    - SI-4
  - pci_dss_v3.2.1:
    - 1.2.1
    - 2.2.2
    - 2.2.5
  condition: all
  rules:
  - c:modprobe -n -v sctp -> r:install /bin/false|install /bin/true
  - not c:lsmod -> r:sctp
- id: 36099
  title: Ensure RDS is disabled.
  description: The Reliable Datagram Sockets (RDS) protocol is a transport layer protocol
    designed to provide low-latency, high-bandwidth communications between cluster
    nodes. It was developed by the Oracle Corporation.
  rationale: If the protocol is not being used, it is recommended that kernel module
    not be loaded, disabling the service to reduce the potential attack surface.
  remediation: 'Edit or create a file in the /etc/modprobe.d/ directory ending in
    .conf Example: vim /etc/modprobe.d/rds.conf and add the following line: install
    rds /bin/true.'
  compliance:
  - cis:
    - 3.4.3
  - cis_csc_v7:
    - '9.2'
  - cmmc_v2.0:
    - CM.3.068
    - SC.5.230
  - iso_27001-2013:
    - A.13.1.3
  - mitre_techniques:
    - T1015
    - T1051
    - T1076
    - T1133
    - T1200
  - nist_sp_800-53:
    - SI-4
  - pci_dss_v3.2.1:
    - 1.2.1
    - 2.2.2
    - 2.2.5
  condition: all
  rules:
  - c:modprobe -n -v rds -> r:install /bin/false|install /bin/true
  - not c:lsmod -> r:rds
- id: 36100
  title: Ensure TIPC is disabled.
  description: The Transparent Inter-Process Communication (TIPC) protocol is designed
    to provide communication between cluster nodes.
  rationale: If the protocol is not being used, it is recommended that kernel module
    not be loaded, disabling the service to reduce the potential attack surface.
  remediation: 'Edit or create a file in the /etc/modprobe.d/ directory ending in
    .conf Example: vim /etc/modprobe.d/tipc.conf and add the following line: install
    tipc /bin/true.'
  compliance:
  - cis:
    - 3.4.4
  - cis_csc_v7:
    - '9.2'
  - cmmc_v2.0:
    - CM.3.068
    - SC.5.230
  - iso_27001-2013:
    - A.13.1.3
  - mitre_techniques:
    - T1015
    - T1051
    - T1076
    - T1133
    - T1200
  - nist_sp_800-53:
    - SI-4
  - pci_dss_v3.2.1:
    - 1.2.1
    - 2.2.2
    - 2.2.5
  condition: all
  rules:
  - c:modprobe -n -v tipc -> r:install /bin/false|install /bin/true
  - not c:lsmod -> r:tipc
- id: 36000
  title: Ensure mounting of cramfs filesystems is disabled.
  description: The cramfs filesystem type is a compressed read-only Linux filesystem
    embedded in small footprint systems. A cramfs image can be used without having
    to first decompress the image.
  rationale: Removing support for unneeded filesystem types reduces the local attack
    surface of the server. If this filesystem type is not needed, disable it.
  remediation: 'Edit or create a file in the /etc/modprobe.d/ directory ending in
    .conf Example: vim /etc/modprobe.d/cramfs.conf and add the following line: install
    cramfs /bin/true Run the following command to unload the cramfs module: # rmmod
    cramfs.'
  compliance:
  - cis:
    - 1.1.1.1
  - cis_csc_v7:
    - '5.1'
  - cmmc_v2.0:
    - AC.1.002
    - CM.2.061
    - SC.3.180
  - iso_27001-2013:
    - A.14.2.5
    - A.8.1.3
  - mitre_techniques:
    - T1003
    - T1011
    - T1015
    - T1017
    - T1019
    - T1028
    - T1034
    - T1035
    - T1036
    - T1037
    - T1044
    - T1047
    - T1051
    - T1053
    - T1054
    - T1055
    - T1058
    - T1067
    - T1070
    - T1072
    - T1073
    - T1075
    - T1076
    - T1077
    - T1078
    - T1080
    - T1081
    - T1084
    - T1086
    - T1087
    - T1088
    - T1089
    - T1092
    - T1096
    - T1097
    - T1098
    - T1100
    - T1110
    - T1112
    - T1130
    - T1133
    - T1134
    - T1136
    - T1137
    - T1138
    - T1139
    - T1142
    - T1145
    - T1146
    - T1147
    - T1148
    - T1150
    - T1156
    - T1157
    - T1165
    - T1166
    - T1169
    - T1173
    - T1174
    - T1175
    - T1176
    - T1177
    - T1178
    - T1184
    - T1187
    - T1190
    - T1196
    - T1197
    - T1198
    - T1199
    - T1200
    - T1201
    - T1206
    - T1208
    - T1209
    - T1210
    - T1214
    - T1215
    - T1218
    - T1485
    - T1486
    - T1487
    - T1488
    - T1489
    - T1490
    - T1491
    - T1492
    - T1494
    - T1495
    - T1501
    - T1503
    - T1504
    - T1505
    - T1506
    - T1525
    - T1530
    - T1535
    - T1537
    - T1539
  - nist_sp_800-53:
    - AU-2
    - CM-1
    - CM-2
    - CM-6
    - CM-7
    - IA-5
    - IA-6
    - SC-20
    - SC-21
  - pci_dss_v3.2.1:
    - '2.2'
  condition: all
  rules:
  - c:modprobe -n -v cramfs -> r:install /bin/false|install /bin/true|Module cramfs
    not found
  - not c:lsmod -> r:cramfs
- id: 36001
  title: Ensure mounting of freevxfs filesystems is disabled.
  description: The freevxfs filesystem type is a free version of the Veritas type
    filesystem. This is the primary filesystem type for HP-UX operating systems.
  rationale: Removing support for unneeded filesystem types reduces the local attack
    surface of the system. If this filesystem type is not needed, disable it.
  remediation: 'Edit or create a file in the /etc/modprobe.d/ directory ending in
    .conf Example: vim /etc/modprobe.d/freevxfs.conf and add the following line: install
    freevxfs /bin/true Run the following command to unload the freevxfs module: rmmod
    freevxfs.'
  compliance:
  - cis:
    - 1.1.1.2
  - cis_csc_v7:
    - '5.1'
  - cmmc_v2.0:
    - AC.1.002
    - CM.2.061
    - SC.3.180
  - iso_27001-2013:
    - A.14.2.5
    - A.8.1.3
  - mitre_techniques:
    - T1003
    - T1011
    - T1015
    - T1017
    - T1019
    - T1028
    - T1034
    - T1035
    - T1036
    - T1037
    - T1044
    - T1047
    - T1051
    - T1053
    - T1054
    - T1055
    - T1058
    - T1067
    - T1070
    - T1072
    - T1073
    - T1075
    - T1076
    - T1077
    - T1078
    - T1080
    - T1081
    - T1084
    - T1086
    - T1087
    - T1088
    - T1089
    - T1092
    - T1096
    - T1097
    - T1098
    - T1100
    - T1110
    - T1112
    - T1130
    - T1133
    - T1134
    - T1136
    - T1137
    - T1138
    - T1139
    - T1142
    - T1145
    - T1146
    - T1147
    - T1148
    - T1150
    - T1156
    - T1157
    - T1165
    - T1166
    - T1169
    - T1173
    - T1174
    - T1175
    - T1176
    - T1177
    - T1178
    - T1184
    - T1187
    - T1190
    - T1196
    - T1197
    - T1198
    - T1199
    - T1200
    - T1201
    - T1206
    - T1208
    - T1209
    - T1210
    - T1214
    - T1215
    - T1218
    - T1485
    - T1486
    - T1487
    - T1488
    - T1489
    - T1490
    - T1491
    - T1492
    - T1494
    - T1495
    - T1501
    - T1503
    - T1504
    - T1505
    - T1506
    - T1525
    - T1530
    - T1535
    - T1537
    - T1539
  - nist_sp_800-53:
    - AU-2
    - CM-1
    - CM-2
    - CM-6
    - CM-7
    - IA-5
    - IA-6
    - SC-20
    - SC-21
  - pci_dss_v3.2.1:
    - '2.2'
  condition: all
  rules:
  - c:modprobe -n -v freevxfs -> r:install /bin/false|install /bin/true|Module freevxfs
    not found
  - not c:lsmod -> r:freevxfs
- id: 36002
  title: Ensure mounting of jffs2 filesystems is disabled.
  description: The jffs2 (journaling flash filesystem 2) filesystem type is a log-structured
    filesystem used in flash memory devices.
  rationale: Removing support for unneeded filesystem types reduces the local attack
    surface of the system. If this filesystem type is not needed, disable it.
  remediation: 'Edit or create a file in the /etc/modprobe.d/ directory ending in
    .conf Example: vim /etc/modprobe.d/jffs2.conf and add the following line: install
    jffs2 /bin/true Run the following command to unload the jffs2 module: # rmmod
    jffs2.'
  compliance:
  - cis:
    - 1.1.1.3
  - cis_csc_v7:
    - '5.1'
  - cmmc_v2.0:
    - AC.1.002
    - CM.2.061
    - SC.3.180
  - iso_27001-2013:
    - A.14.2.5
    - A.8.1.3
  - mitre_techniques:
    - T1003
    - T1011
    - T1015
    - T1017
    - T1019
    - T1028
    - T1034
    - T1035
    - T1036
    - T1037
    - T1044
    - T1047
    - T1051
    - T1053
    - T1054
    - T1055
    - T1058
    - T1067
    - T1070
    - T1072
    - T1073
    - T1075
    - T1076
    - T1077
    - T1078
    - T1080
    - T1081
    - T1084
    - T1086
    - T1087
    - T1088
    - T1089
    - T1092
    - T1096
    - T1097
    - T1098
    - T1100
    - T1110
    - T1112
    - T1130
    - T1133
    - T1134
    - T1136
    - T1137
    - T1138
    - T1139
    - T1142
    - T1145
    - T1146
    - T1147
    - T1148
    - T1150
    - T1156
    - T1157
    - T1165
    - T1166
    - T1169
    - T1173
    - T1174
    - T1175
    - T1176
    - T1177
    - T1178
    - T1184
    - T1187
    - T1190
    - T1196
    - T1197
    - T1198
    - T1199
    - T1200
    - T1201
    - T1206
    - T1208
    - T1209
    - T1210
    - T1214
    - T1215
    - T1218
    - T1485
    - T1486
    - T1487
    - T1488
    - T1489
    - T1490
    - T1491
    - T1492
    - T1494
    - T1495
    - T1501
    - T1503
    - T1504
    - T1505
    - T1506
    - T1525
    - T1530
    - T1535
    - T1537
    - T1539
  - nist_sp_800-53:
    - AU-2
    - CM-1
    - CM-2
    - CM-6
    - CM-7
    - IA-5
    - IA-6
    - SC-20
    - SC-21
  - pci_dss_v3.2.1:
    - '2.2'
  condition: all
  rules:
  - c:modprobe -n -v jffs2 -> r:install /bin/false|install /bin/true|Module jffs2
    not found
  - not c:lsmod -> r:jffs2
- id: 36003
  title: Ensure mounting of hfs filesystems is disabled.
  description: The hfs filesystem type is a hierarchical filesystem that allows you
    to mount Mac OS filesystems.
  rationale: Removing support for unneeded filesystem types reduces the local attack
    surface of the system. If this filesystem type is not needed, disable it.
  remediation: 'Edit or create a file in the /etc/modprobe.d/ directory ending in
    .conf Example: vim /etc/modprobe.d/hfs.conf and add the following line: install
    hfs /bin/true Run the following command to unload the hfs module: # rmmod hfs.'
  compliance:
  - cis:
    - 1.1.1.4
  - cis_csc_v7:
    - '5.1'
  - cmmc_v2.0:
    - AC.1.002
    - CM.2.061
    - SC.3.180
  - iso_27001-2013:
    - A.14.2.5
    - A.8.1.3
  - mitre_techniques:
    - T1003
    - T1011
    - T1015
    - T1017
    - T1019
    - T1028
    - T1034
    - T1035
    - T1036
    - T1037
    - T1044
    - T1047
    - T1051
    - T1053
    - T1054
    - T1055
    - T1058
    - T1067
    - T1070
    - T1072
    - T1073
    - T1075
    - T1076
    - T1077
    - T1078
    - T1080
    - T1081
    - T1084
    - T1086
    - T1087
    - T1088
    - T1089
    - T1092
    - T1096
    - T1097
    - T1098
    - T1100
    - T1110
    - T1112
    - T1130
    - T1133
    - T1134
    - T1136
    - T1137
    - T1138
    - T1139
    - T1142
    - T1145
    - T1146
    - T1147
    - T1148
    - T1150
    - T1156
    - T1157
    - T1165
    - T1166
    - T1169
    - T1173
    - T1174
    - T1175
    - T1176
    - T1177
    - T1178
    - T1184
    - T1187
    - T1190
    - T1196
    - T1197
    - T1198
    - T1199
    - T1200
    - T1201
    - T1206
    - T1208
    - T1209
    - T1210
    - T1214
    - T1215
    - T1218
    - T1485
    - T1486
    - T1487
    - T1488
    - T1489
    - T1490
    - T1491
    - T1492
    - T1494
    - T1495
    - T1501
    - T1503
    - T1504
    - T1505
    - T1506
    - T1525
    - T1530
    - T1535
    - T1537
    - T1539
  - nist_sp_800-53:
    - AU-2
    - CM-1
    - CM-2
    - CM-6
    - CM-7
    - IA-5
    - IA-6
    - SC-20
    - SC-21
  - pci_dss_v3.2.1:
    - '2.2'
  condition: all
  rules:
  - c:modprobe -n -v hfs -> r:install /bin/false|install /bin/true|Module hfs not
    found
  - not c:lsmod -> r:hfs
- id: 36004
  title: Ensure mounting of hfsplus filesystems is disabled.
  description: The hfsplus filesystem type is a hierarchical filesystem designed to
    replace hfs that allows you to mount Mac OS filesystems.
  rationale: Removing support for unneeded filesystem types reduces the local attack
    surface of the system. If this filesystem type is not needed, disable it.
  remediation: 'Edit or create a file in the /etc/modprobe.d/ directory ending in
    .conf Example: vim /etc/modprobe.d/hfsplus.conf and add the following line: install
    hfsplus /bin/true Run the following command to unload the hfsplus module: # rmmod
    hfsplus.'
  compliance:
  - cis:
    - 1.1.1.5
  - cis_csc_v7:
    - '5.1'
  - cmmc_v2.0:
    - AC.1.002
    - CM.2.061
    - SC.3.180
  - iso_27001-2013:
    - A.14.2.5
    - A.8.1.3
  - mitre_techniques:
    - T1003
    - T1011
    - T1015
    - T1017
    - T1019
    - T1028
    - T1034
    - T1035
    - T1036
    - T1037
    - T1044
    - T1047
    - T1051
    - T1053
    - T1054
    - T1055
    - T1058
    - T1067
    - T1070
    - T1072
    - T1073
    - T1075
    - T1076
    - T1077
    - T1078
    - T1080
    - T1081
    - T1084
    - T1086
    - T1087
    - T1088
    - T1089
    - T1092
    - T1096
    - T1097
    - T1098
    - T1100
    - T1110
    - T1112
    - T1130
    - T1133
    - T1134
    - T1136
    - T1137
    - T1138
    - T1139
    - T1142
    - T1145
    - T1146
    - T1147
    - T1148
    - T1150
    - T1156
    - T1157
    - T1165
    - T1166
    - T1169
    - T1173
    - T1174
    - T1175
    - T1176
    - T1177
    - T1178
    - T1184
    - T1187
    - T1190
    - T1196
    - T1197
    - T1198
    - T1199
    - T1200
    - T1201
    - T1206
    - T1208
    - T1209
    - T1210
    - T1214
    - T1215
    - T1218
    - T1485
    - T1486
    - T1487
    - T1488
    - T1489
    - T1490
    - T1491
    - T1492
    - T1494
    - T1495
    - T1501
    - T1503
    - T1504
    - T1505
    - T1506
    - T1525
    - T1530
    - T1535
    - T1537
    - T1539
  - nist_sp_800-53:
    - AU-2
    - CM-1
    - CM-2
    - CM-6
    - CM-7
    - IA-5
    - IA-6
    - SC-20
    - SC-21
  - pci_dss_v3.2.1:
    - '2.2'
  condition: all
  rules:
  - c:modprobe -n -v hfsplus -> r:install /bin/false|install /bin/true|Module hfsplus
    not found
  - not c:lsmod -> r:hfsplus
- id: 36005
  title: Ensure mounting of squashfs filesystems is disabled.
  description: The squashfs filesystem type is a compressed read-only Linux filesystem
    embedded in small footprint systems (similar to cramfs). A squashfs image can
    be used without having to first decompress the image.
  rationale: Removing support for unneeded filesystem types reduces the local attack
    surface of the system. If this filesystem type is not needed, disable it.
  remediation: 'Edit or create a file in the /etc/modprobe.d/ directory ending in
    .conf Example: vim /etc/modprobe.d/squashfs.conf and add the following line: install
    squashfs /bin/true Run the following command to unload the squashfs module: #
    rmmod squashfs.'
  compliance:
  - cis:
    - 1.1.1.6
  - cis_csc_v7:
    - '5.1'
  - cmmc_v2.0:
    - AC.1.002
    - CM.2.061
    - SC.3.180
  - iso_27001-2013:
    - A.14.2.5
    - A.8.1.3
  - mitre_techniques:
    - T1003
    - T1011
    - T1015
    - T1017
    - T1019
    - T1028
    - T1034
    - T1035
    - T1036
    - T1037
    - T1044
    - T1047
    - T1051
    - T1053
    - T1054
    - T1055
    - T1058
    - T1067
    - T1070
    - T1072
    - T1073
    - T1075
    - T1076
    - T1077
    - T1078
    - T1080
    - T1081
    - T1084
    - T1086
    - T1087
    - T1088
    - T1089
    - T1092
    - T1096
    - T1097
    - T1098
    - T1100
    - T1110
    - T1112
    - T1130
    - T1133
    - T1134
    - T1136
    - T1137
    - T1138
    - T1139
    - T1142
    - T1145
    - T1146
    - T1147
    - T1148
    - T1150
    - T1156
    - T1157
    - T1165
    - T1166
    - T1169
    - T1173
    - T1174
    - T1175
    - T1176
    - T1177
    - T1178
    - T1184
    - T1187
    - T1190
    - T1196
    - T1197
    - T1198
    - T1199
    - T1200
    - T1201
    - T1206
    - T1208
    - T1209
    - T1210
    - T1214
    - T1215
    - T1218
    - T1485
    - T1486
    - T1487
    - T1488
    - T1489
    - T1490
    - T1491
    - T1492
    - T1494
    - T1495
    - T1501
    - T1503
    - T1504
    - T1505
    - T1506
    - T1525
    - T1530
    - T1535
    - T1537
    - T1539
  - nist_sp_800-53:
    - AU-2
    - CM-1
    - CM-2
    - CM-6
    - CM-7
    - IA-5
    - IA-6
    - SC-20
    - SC-21
  - pci_dss_v3.2.1:
    - '2.2'
  condition: all
  rules:
  - c:modprobe -n -v squashfs -> r:install /bin/false|install /bin/true|Module squashfs
    not found
  - not c:lsmod -> r:squashfs
- id: 36006
  title: Ensure mounting of udf filesystems is disabled.
  description: The udf filesystem type is the universal disk format used to implement
    ISO/IEC 13346 and ECMA-167 specifications. This is an open vendor filesystem type
    for data storage on a broad range of media. This filesystem type is necessary
    to support writing DVDs and newer optical disc formats.
  rationale: Removing support for unneeded filesystem types reduces the local attack
    surface of the system. If this filesystem type is not needed, disable it.
  remediation: 'Edit or create a file in the /etc/modprobe.d/ directory ending in
    .conf Example: vim /etc/modprobe.d/udf.conf and add the following line: install
    udf /bin/true Run the following command to unload the udf module: # rmmod udf.'
  compliance:
  - cis:
    - 1.1.1.7
  - cis_csc_v7:
    - '5.1'
  - cmmc_v2.0:
    - AC.1.002
    - CM.2.061
    - SC.3.180
  - iso_27001-2013:
    - A.14.2.5
    - A.8.1.3
  - mitre_techniques:
    - T1003
    - T1011
    - T1015
    - T1017
    - T1019
    - T1028
    - T1034
    - T1035
    - T1036
    - T1037
    - T1044
    - T1047
    - T1051
    - T1053
    - T1054
    - T1055
    - T1058
    - T1067
    - T1070
    - T1072
    - T1073
    - T1075
    - T1076
    - T1077
    - T1078
    - T1080
    - T1081
    - T1084
    - T1086
    - T1087
    - T1088
    - T1089
    - T1092
    - T1096
    - T1097
    - T1098
    - T1100
    - T1110
    - T1112
    - T1130
    - T1133
    - T1134
    - T1136
    - T1137
    - T1138
    - T1139
    - T1142
    - T1145
    - T1146
    - T1147
    - T1148
    - T1150
    - T1156
    - T1157
    - T1165
    - T1166
    - T1169
    - T1173
    - T1174
    - T1175
    - T1176
    - T1177
    - T1178
    - T1184
    - T1187
    - T1190
    - T1196
    - T1197
    - T1198
    - T1199
    - T1200
    - T1201
    - T1206
    - T1208
    - T1209
    - T1210
    - T1214
    - T1215
    - T1218
    - T1485
    - T1486
    - T1487
    - T1488
    - T1489
    - T1490
    - T1491
    - T1492
    - T1494
    - T1495
    - T1501
    - T1503
    - T1504
    - T1505
    - T1506
    - T1525
    - T1530
    - T1535
    - T1537
    - T1539
  - nist_sp_800-53:
    - AU-2
    - CM-1
    - CM-2
    - CM-6
    - CM-7
    - IA-5
    - IA-6
    - SC-20
    - SC-21
  - pci_dss_v3.2.1:
    - '2.2'
  condition: all
  rules:
  - c:/sbin/modprobe -n -v udf -> r:install /bin/false|install /bin/true|Module udf
    not found
  - not c:lsmod -> r:udf
- id: 36148
  title: Ensure SSH PermitEmptyPasswords is disabled.
  description: The PermitEmptyPasswords parameter specifies if the SSH server allows
    login to accounts with empty password strings.
  rationale: Disallowing remote shell access to accounts that have an empty password
    reduces the probability of unauthorized access to the system.
  remediation: 'Edit the /etc/ssh/sshd_config file to set the parameter as follows:
    PermitEmptyPasswords no.'
  compliance:
  - cis:
    - 5.2.11
  - cis_csc_v7:
    - '16.3'
  - mitre_techniques:
    - T1004
    - T1017
    - T1021
    - T1023
    - T1031
    - T1034
    - T1040
    - T1044
    - T1047
    - T1050
    - T1051
    - T1053
    - T1054
    - T1072
    - T1075
    - T1076
    - T1078
    - T1084
    - T1089
    - T1097
    - T1098
    - T1110
    - T1114
    - T1133
    - T1134
    - T1136
    - T1152
    - T1157
    - T1159
    - T1160
    - T1162
    - T1163
    - T1165
    - T1168
    - T1185
    - T1197
    - T1213
    - T1484
    - T1489
    - T1501
    - T1528
    - T1530
    - T1537
    - T1538
    - T1539
  - pci_dss_v3.2.1:
    - '8.3'
  condition: all
  rules:
  - c:sshd -T -> !r:^# && r:PermitEmptyPasswords\s*\t*no
- id: 36142
  title: Ensure SSH LogLevel is appropriate.
  description: INFO level is the basic level that only records login activity of SSH
    users. In many situations, such as Incident Response, it is important to determine
    when a particular user was active on a system. The logout record can eliminate
    those users who disconnected, which helps narrow the field. VERBOSE level specifies
    that login and logout activity as well as the key fingerprint for any SSH key
    used for login will be logged. This information is important for SSH key management,
    especially in legacy environments.
  rationale: SSH provides several logging levels with varying amounts of verbosity.
    DEBUG is specifically not recommended other than strictly for debugging SSH communications
    since it provides so much data that it is difficult to identify important security
    information.
  remediation: 'Edit the /etc/ssh/sshd_config file to set the parameter as follows:
    LogLevel VERBOSE OR LogLevel INFO.'
  references:
  - https://www.ssh.com/ssh/sshd_config/
  compliance:
  - cis:
    - 5.2.5
  - cis_csc_v7:
    - '6.2'
  - cmmc_v2.0:
    - AU.2.042
    - AU.5.055
  - iso_27001-2013:
    - A.12.4.1
  - nist_sp_800-53:
    - AU-12
    - AU-3
  - pci_dss_v3.2.1:
    - '10.2'
    - '10.3'
  condition: all
  rules:
  - c:sshd -T -> r:^\s*LogLevel\s+VERBOSE|^\s*loglevel\s+INFO
- id: 36150
  title: Ensure only strong Ciphers are used.
  description: This variable limits the ciphers that SSH can use during communication.
  rationale: Weak ciphers that are used for authentication to the cryptographic module
    cannot be relied upon to provide confidentiality or integrity, and system data
    may be compromised The DES, Triple DES, and Blowfish ciphers, as used in SSH,
    have a birthday bound of approximately four billion blocks, which makes it easier
    for remote attackers to obtain cleartext data via a birthday attack against a
    long-duration encrypted session, aka a "Sweet32" attack The RC4 algorithm, as
    used in the TLS protocol and SSL protocol, does not properly combine state data
    with key data during the initialization phase, which makes it easier for remote
    attackers to conduct plaintext-recovery attacks against the initial bytes of a
    stream by sniffing network traffic that occasionally relies on keys affected by
    the Invariance Weakness, and then using a brute-force approach involving LSB values,
    aka the "Bar Mitzvah" issue The passwords used during an SSH session encrypted
    with RC4 can be recovered by an attacker who is able to capture and replay the
    session Error handling in the SSH protocol; Client and Server, when using a block
    cipher algorithm in Cipher Block Chaining (CBC) mode, makes it easier for remote
    attackers to recover certain plaintext data from an arbitrary block of ciphertext
    in an SSH session via unknown vectors The mm_newkeys_from_blob function in monitor_wrap.c,
    when an AES-GCM cipher is used, does not properly initialize memory for a MAC
    context data structure, which allows remote authenticated users to bypass intended
    ForceCommand and login-shell restrictions via packet data that provides a crafted
    callback address.
  remediation: 'Edit the /etc/ssh/sshd_config file add/modify the Ciphers line to
    contain a comma separated list of the site approved ciphers Example: Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-
    gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr.'
  references:
  - https://nvd.nist.gov/vuln/detail/CVE-2016-2183
  - https://nvd.nist.gov/vuln/detail/CVE-2015-2808
  - https://www.kb.cert.org/vuls/id/565052
  - https://www.openssh.com/txt/cbc.adv
  - https://nvd.nist.gov/vuln/detail/CVE-2008-5161
  - https://nvd.nist.gov/vuln/detail/CVE-2013-4548
  compliance:
  - cis:
    - 5.2.13
  - cis_csc_v7:
    - '14.4'
  - cmmc_v2.0:
    - SC.3.177
    - SC.3.185
  - iso_27001-2013:
    - A.10.1.1
    - A.13.1.1
  - mitre_techniques:
    - T1040
    - T1070
    - T1114
    - T1119
    - T1145
    - T1208
    - T1492
    - T1493
    - T1527
    - T1530
  - pci_dss_v3.2.1:
    - '4.1'
  condition: none
  rules:
  - c:sshd -T -> r:^Ciphers && r:3des-cbc|aes128-cbc|aes192-cbc|aes256-cbc|arcfour|arcfour128|arcfour256|blowfish-cbc|cast128-cbc|rijndael-cbc@lysator.liu.se
- id: 36159
  title: Ensure SSH MaxStartups is configured.
  description: The MaxStartups parameter specifies the maximum number of concurrent
    unauthenticated connections to the SSH daemon.
  rationale: To protect a system from denial of service due to a large number of pending
    authentication connection attempts, use the rate limiting function of MaxStartups
    to protect availability of sshd logins and prevent overwhelming the daemon.
  remediation: 'Edit the /etc/ssh/sshd_config file to set the parameter as follows:
    maxstartups 10:30:60.'
  compliance:
  - cis:
    - 5.2.22
  - cis_csc_v7:
    - '5.1'
  - cmmc_v2.0:
    - AC.1.002
    - CM.2.061
    - SC.3.180
  - iso_27001-2013:
    - A.14.2.5
    - A.8.1.3
  - mitre_techniques:
    - T1003
    - T1011
    - T1015
    - T1017
    - T1019
    - T1028
    - T1034
    - T1035
    - T1036
    - T1037
    - T1044
    - T1047
    - T1051
    - T1053
    - T1054
    - T1055
    - T1058
    - T1067
    - T1070
    - T1072
    - T1073
    - T1075
    - T1076
    - T1077
    - T1078
    - T1080
    - T1081
    - T1084
    - T1086
    - T1087
    - T1088
    - T1089
    - T1092
    - T1096
    - T1097
    - T1098
    - T1100
    - T1110
    - T1112
    - T1130
    - T1133
    - T1134
    - T1136
    - T1137
    - T1138
    - T1139
    - T1142
    - T1145
    - T1146
    - T1147
    - T1148
    - T1150
    - T1156
    - T1157
    - T1165
    - T1166
    - T1169
    - T1173
    - T1174
    - T1175
    - T1176
    - T1177
    - T1178
    - T1184
    - T1187
    - T1190
    - T1196
    - T1197
    - T1198
    - T1199
    - T1200
    - T1201
    - T1206
    - T1208
    - T1209
    - T1210
    - T1214
    - T1215
    - T1218
    - T1485
    - T1486
    - T1487
    - T1488
    - T1489
    - T1490
    - T1491
    - T1492
    - T1494
    - T1495
    - T1501
    - T1503
    - T1504
    - T1505
    - T1506
    - T1525
    - T1530
    - T1535
    - T1537
    - T1539
  - nist_sp_800-53:
    - AU-2
    - CM-1
    - CM-2
    - CM-6
    - CM-7
    - IA-5
    - IA-6
    - SC-20
    - SC-21
  - pci_dss_v3.2.1:
    - '2.2'
  condition: all
  rules:
  - c:sshd -T -> n:^\s*maxstartups\s+(\d+):\d+:\d+ compare <= 10
  - c:sshd -T -> n:^\s*maxstartups\s+\d+:(\d+):\d+ compare <= 30
  - c:sshd -T -> n:^\s*maxstartups\s+\d+:\d+:(\d+) compare <= 60
- id: 36162
  title: Ensure password reuse is limited.
  description: The /etc/security/opasswd file stores the users' old passwords and
    can be checked to ensure that users are not recycling recent passwords.
  rationale: Forcing users not to reuse their past 5 passwords make it less likely
    that an attacker will be able to guess the password. Note that these change only
    apply to accounts configured on the local system.
  remediation: 'Set remembered password history to conform to site policy. Many distributions
    provide tools for updating PAM configuration, consult your documentation for details.
    If no tooling is provided edit the appropriate /etc/pam.d/ configuration file
    and add or modify the pam_pwhistory.so or pam_unix.so lines to include the remember
    option: password required pam_pwhistory.so remember=5 password sufficient pam_unix.so
    remember=5 Notes: Consult your documentation for the appropriate PAM file and
    module. Additional module options may be set, recommendation only covers those
    listed here.'
  compliance:
  - cis:
    - 5.3.3
  - cis_csc_v7:
    - '16'
  condition: any
  rules:
  - f:/etc/pam.d/system-auth -> r:^\s*password && r:pam_pwquality\.so\.+ && n:remember=(\d+)
    compare >= 5
  - f:/etc/pam.d/system-auth -> r:^\s*password && r:pam_unix\.so\.+ && n:remember=(\d+)
    compare >= 5
  - f:/etc/pam.d/common-auth -> r:^\s*password && r:pam_pwquality\.so\.+ && n:remember=(\d+)
    compare >= 5
  - f:/etc/pam.d/common-auth -> r:^\s*password && r:pam_unix\.so\.+ && n:remember=(\d+)
    compare >= 5
  - f:/etc/pam.d/password-auth -> r:^\s*password && r:pam_pwquality\.so\.+ && n:remember=(\d+)
    compare >= 5
  - f:/etc/pam.d/password-auth -> r:^\s*password && r:pam_unix\.so\.+ && n:remember=(\d+)
    compare >= 5
- id: 36164
  title: Ensure password expiration is 365 days or less.
  description: The PASS_MAX_DAYS parameter in /etc/login.defs allows an administrator
    to force passwords to expire once they reach a defined age. It is recommended
    that the PASS_MAX_DAYS parameter be set to less than or equal to 365 days.
  rationale: The window of opportunity for an attacker to leverage compromised credentials
    or successfully compromise credentials via an online brute force attack is limited
    by the age of the password. Therefore, reducing the maximum age of a password
    also reduces an attacker's window of opportunity.
  remediation: 'Set the PASS_MAX_DAYS parameter to conform to site policy in /etc/login.defs
    : PASS_MAX_DAYS 365 Modify user parameters for all users with a password set to
    match: # chage --maxdays 365 <user> Notes: You can also check this setting in
    /etc/shadow directly. The 5th field should be 365 or less for all users with a
    password. Note: A value of -1 will disable password expiration. Additionally the
    password expiration must be greater than the minimum days between password changes
    or users will be unable to change their password.'
  compliance:
  - cis:
    - 5.4.1.1
  - cis_csc_v7:
    - '4.4'
  - cmmc_v2.0:
    - IA.2.078
    - IA.2.079
  - iso_27001-2013:
    - A.9.4.3
  - mitre_techniques:
    - T1003
    - T1017
    - T1019
    - T1028
    - T1035
    - T1047
    - T1051
    - T1053
    - T1055
    - T1067
    - T1072
    - T1075
    - T1076
    - T1077
    - T1078
    - T1084
    - T1086
    - T1088
    - T1097
    - T1098
    - T1100
    - T1134
    - T1136
    - T1169
    - T1175
    - T1184
    - T1190
    - T1206
    - T1208
    - T1210
    - T1214
    - T1215
    - T1218
    - T1495
    - T1501
    - T1505
    - T1525
  - nist_sp_800-53:
    - IA-5 (1)
  condition: all
  rules:
  - f:/etc/login.defs -> n:^\s*PASS_MAX_DAYS\s*\t*(\d+) compare <= 365
- id: 36165
  title: Ensure minimum days between password changes is 7 or more.
  description: The PASS_MIN_DAYS parameter in /etc/login.defs allows an administrator
    to prevent users from changing their password until a minimum number of days have
    passed since the last time the user changed their password. It is recommended
    that PASS_MIN_DAYS parameter be set to 7 or more days.
  rationale: By restricting the frequency of password changes, an administrator can
    prevent users from repeatedly changing their password in an attempt to circumvent
    password reuse controls.
  remediation: 'Set the PASS_MIN_DAYS parameter to 7 in /etc/login.defs : PASS_MIN_DAYS
    7 Modify user parameters for all users with a password set to match: # chage --mindays
    7 <user> Notes: You can also check this setting in /etc/shadow directly. The 4th
    field should be 7 or more for all users with a password.'
  compliance:
  - cis:
    - 5.4.1.2
  - cis_csc_v7:
    - '4.4'
  - cmmc_v2.0:
    - IA.2.078
    - IA.2.079
  - iso_27001-2013:
    - A.9.4.3
  - mitre_techniques:
    - T1003
    - T1017
    - T1019
    - T1028
    - T1035
    - T1047
    - T1051
    - T1053
    - T1055
    - T1067
    - T1072
    - T1075
    - T1076
    - T1077
    - T1078
    - T1084
    - T1086
    - T1088
    - T1097
    - T1098
    - T1100
    - T1134
    - T1136
    - T1169
    - T1175
    - T1184
    - T1190
    - T1206
    - T1208
    - T1210
    - T1214
    - T1215
    - T1218
    - T1495
    - T1501
    - T1505
    - T1525
  - nist_sp_800-53:
    - IA-5 (1)
  condition: all
  rules:
  - f:/etc/login.defs -> n:^\s*PASS_MIN_DAYS\s*\t*(\d+) compare >= 7
- id: 36166
  title: Ensure password expiration warning days is 7 or more.
  description: The PASS_WARN_AGE parameter in /etc/login.defs allows an administrator
    to notify users that their password will expire in a defined number of days. It
    is recommended that the PASS_WARN_AGE parameter be set to 7 or more days.
  rationale: Providing an advance warning that a password will be expiring gives users
    time to think of a secure password. Users caught unaware may choose a simple password
    or write it down where it may be discovered.
  remediation: 'Set the PASS_WARN_AGE parameter to 7 in /etc/login.defs : PASS_WARN_AGE
    7 Modify user parameters for all users with a password set to match: # chage --warndays
    7 <user> Notes: You can also check this setting in /etc/shadow directly. The 6th
    field should be 7 or more for all users with a password.'
  compliance:
  - cis:
    - 5.4.1.3
  - cis_csc_v7:
    - '4.4'
  - cmmc_v2.0:
    - IA.2.078
    - IA.2.079
  - iso_27001-2013:
    - A.9.4.3
  - mitre_techniques:
    - T1003
    - T1017
    - T1019
    - T1028
    - T1035
    - T1047
    - T1051
    - T1053
    - T1055
    - T1067
    - T1072
    - T1075
    - T1076
    - T1077
    - T1078
    - T1084
    - T1086
    - T1088
    - T1097
    - T1098
    - T1100
    - T1134
    - T1136
    - T1169
    - T1175
    - T1184
    - T1190
    - T1206
    - T1208
    - T1210
    - T1214
    - T1215
    - T1218
    - T1495
    - T1501
    - T1505
    - T1525
  - nist_sp_800-53:
    - IA-5 (1)
  condition: all
  rules:
  - f:/etc/login.defs -> n:^\s*PASS_WARN_AGE\s*\t*(\d+) compare >= 7
- id: 36169
  title: Ensure access to the su command is restricted.
  description: The su command allows a user to run a command or shell as another user.
    The program has been superseded by sudo , which allows for more granular control
    over privileged access. Normally, the su command can be executed by any user.
    By uncommenting the pam_wheel.so statement in /etc/pam.d/su , the su command will
    only allow users in the wheel group to execute su.
  rationale: Restricting the use of su , and using sudo in its place, provides system
    administrators better control of the escalation of user privileges to execute
    privileged commands. The sudo utility also provides a better logging and audit
    mechanism, as it can log each command executed via sudo , whereas su can only
    record that a user executed the su program.
  remediation: 'Add the following line to the /etc/pam.d/su file: auth required pam_wheel.so
    use_uid Create a comma separated list of users in the wheel statement in the /etc/group
    file: wheel:x:10:root,<user list>.'
  compliance:
  - cis:
    - '5.6'
  - cis_csc_v7:
    - '5.1'
  - cmmc_v2.0:
    - AC.1.002
    - CM.2.061
    - SC.3.180
  - iso_27001-2013:
    - A.14.2.5
    - A.8.1.3
  - mitre_techniques:
    - T1003
    - T1011
    - T1015
    - T1017
    - T1019
    - T1028
    - T1034
    - T1035
    - T1036
    - T1037
    - T1044
    - T1047
    - T1051
    - T1053
    - T1054
    - T1055
    - T1058
    - T1067
    - T1070
    - T1072
    - T1073
    - T1075
    - T1076
    - T1077
    - T1078
    - T1080
    - T1081
    - T1084
    - T1086
    - T1087
    - T1088
    - T1089
    - T1092
    - T1096
    - T1097
    - T1098
    - T1100
    - T1110
    - T1112
    - T1130
    - T1133
    - T1134
    - T1136
    - T1137
    - T1138
    - T1139
    - T1142
    - T1145
    - T1146
    - T1147
    - T1148
    - T1150
    - T1156
    - T1157
    - T1165
    - T1166
    - T1169
    - T1173
    - T1174
    - T1175
    - T1176
    - T1177
    - T1178
    - T1184
    - T1187
    - T1190
    - T1196
    - T1197
    - T1198
    - T1199
    - T1200
    - T1201
    - T1206
    - T1208
    - T1209
    - T1210
    - T1214
    - T1215
    - T1218
    - T1485
    - T1486
    - T1487
    - T1488
    - T1489
    - T1490
    - T1491
    - T1492
    - T1494
    - T1495
    - T1501
    - T1503
    - T1504
    - T1505
    - T1506
    - T1525
    - T1530
    - T1535
    - T1537
    - T1539
  - nist_sp_800-53:
    - AU-2
    - CM-1
    - CM-2
    - CM-6
    - CM-7
    - IA-5
    - IA-6
    - SC-20
    - SC-21
  - pci_dss_v3.2.1:
    - '2.2'
  condition: all
  rules:
  - f:/etc/pam.d/su -> !r:# && r:auth && r:required && r:pam_wheel.so\s*\t*use_uid
- id: 36138
  title: Ensure at/cron is restricted to authorized users.
  description: Configure /etc/cron.allow and /etc/at.allow to allow specific users
    to use these services. If /etc/cron.allow or /etc/at.allow do not exist, then
    /etc/at.deny and /etc/cron.deny are checked. Any user not specifically defined
    in those files is allowed to use at and cron. By removing the files, only users
    in /etc/cron.allow and /etc/at.allow are allowed to use at and cron. Note that
    even though a given user is not listed in cron.allow , cron jobs can still be
    run as that user. The cron.allow file only controls administrative access to the
    crontab command for scheduling and modifying cron jobs.
  rationale: On many systems, only the system administrator is authorized to schedule
    cron jobs. Using the cron.allow file to control who can run cron jobs enforces
    this policy. It is easier to manage an allow list than a deny list. In a deny
    list, you could potentially add a user ID to the system and forget to add it to
    the deny files.
  remediation: 'Run the following commands to remove /etc/cron.deny and /etc/at.deny
    and create and set permissions and ownership for /etc/cron.allow and /etc/at.allow
    : # rm /etc/cron.deny # rm /etc/at.deny # touch /etc/cron.allow # touch /etc/at.allow
    # chmod og-rwx /etc/cron.allow # chmod og-rwx /etc/at.allow # chown root:root
    /etc/cron.allow # chown root:root /etc/at.allow.'
  compliance:
  - cis:
    - 5.1.8
  - cis_csc_v7:
    - '16'
  condition: all
  rules:
  - c:stat -L /etc/cron.deny -> r:No such file or directory$
  - c:stat -L /etc/at.deny -> r:No such file or directory$
  - c:stat -Lc "%a %A %u %U %g %G" /etc/cron.allow -> r:600 && r:0 root 0 root
  - c:stat -Lc "%a %A %u %U %g %G" /etc/at.allow -> r:600 && r:0 root 0 root
- id: 36168
  title: Ensure default group for the root account is GID 0.
  description: The usermod command can be used to specify which group the root user
    belongs to. This affects permissions of files that are created by the root user.
  rationale: Using GID 0 for the root account helps prevent root -owned files from
    accidentally becoming accessible to non-privileged users.
  remediation: 'Run the following command to set the root user default group to GID
    0 : # usermod -g 0 root.'
  compliance:
  - cis:
    - 5.4.3
  - cis_csc_v7:
    - '5.1'
  - cmmc_v2.0:
    - AC.1.002
    - CM.2.061
    - SC.3.180
  - iso_27001-2013:
    - A.14.2.5
    - A.8.1.3
  - mitre_techniques:
    - T1003
    - T1011
    - T1015
    - T1017
    - T1019
    - T1028
    - T1034
    - T1035
    - T1036
    - T1037
    - T1044
    - T1047
    - T1051
    - T1053
    - T1054
    - T1055
    - T1058
    - T1067
    - T1070
    - T1072
    - T1073
    - T1075
    - T1076
    - T1077
    - T1078
    - T1080
    - T1081
    - T1084
    - T1086
    - T1087
    - T1088
    - T1089
    - T1092
    - T1096
    - T1097
    - T1098
    - T1100
    - T1110
    - T1112
    - T1130
    - T1133
    - T1134
    - T1136
    - T1137
    - T1138
    - T1139
    - T1142
    - T1145
    - T1146
    - T1147
    - T1148
    - T1150
    - T1156
    - T1157
    - T1165
    - T1166
    - T1169
    - T1173
    - T1174
    - T1175
    - T1176
    - T1177
    - T1178
    - T1184
    - T1187
    - T1190
    - T1196
    - T1197
    - T1198
    - T1199
    - T1200
    - T1201
    - T1206
    - T1208
    - T1209
    - T1210
    - T1214
    - T1215
    - T1218
    - T1485
    - T1486
    - T1487
    - T1488
    - T1489
    - T1490
    - T1491
    - T1492
    - T1494
    - T1495
    - T1501
    - T1503
    - T1504
    - T1505
    - T1506
    - T1525
    - T1530
    - T1535
    - T1537
    - T1539
  - nist_sp_800-53:
    - AU-2
    - CM-1
    - CM-2
    - CM-6
    - CM-7
    - IA-5
    - IA-6
    - SC-20
    - SC-21
  - pci_dss_v3.2.1:
    - '2.2'
  condition: all
  rules:
  - f:/etc/passwd -> r:^root:\w:\w:0
- id: 36178
  title: Ensure password fields are not empty.
  description: An account with an empty password field means that anybody may log
    in as that user without providing a password.
  rationale: All accounts must have passwords or be locked to prevent the account
    from being used by an unauthorized user.
  remediation: 'If any accounts in the /etc/shadow file do not have a password, run
    the following command to lock the account until it can be determined why it does
    not have a password: # passwd -l <username> Also, check to see if the account
    is logged in and investigate what it is being used for to determine if it needs
    to be forced off.'
  compliance:
  - cis:
    - 6.2.1
  - cis_csc_v7:
    - '4.4'
  - cmmc_v2.0:
    - IA.2.078
    - IA.2.079
  - iso_27001-2013:
    - A.9.4.3
  - mitre_techniques:
    - T1003
    - T1017
    - T1019
    - T1028
    - T1035
    - T1047
    - T1051
    - T1053
    - T1055
    - T1067
    - T1072
    - T1075
    - T1076
    - T1077
    - T1078
    - T1084
    - T1086
    - T1088
    - T1097
    - T1098
    - T1100
    - T1134
    - T1136
    - T1169
    - T1175
    - T1184
    - T1190
    - T1206
    - T1208
    - T1210
    - T1214
    - T1215
    - T1218
    - T1495
    - T1501
    - T1505
    - T1525
  - nist_sp_800-53:
    - IA-5 (1)
  condition: none
  rules:
  - 'f:/etc/shadow -> !r:^# && r:^\w+::'
- id: 36183
  title: Ensure root PATH Integrity.
  description: The root user can execute any command on the system and could be fooled
    into executing programs unintentionally if the PATH is not set correctly.
  rationale: Including the current working directory (.) or other writable directory
    in root 's executable path makes it likely that an attacker can gain superuser
    access by forcing an administrator operating as root to execute a Trojan horse
    program.
  remediation: Correct or justify any items discovered in the Audit step.
  compliance:
  - cis:
    - 6.2.6
  - cis_csc_v7:
    - '5.1'
  - cmmc_v2.0:
    - AC.1.002
    - CM.2.061
    - SC.3.180
  - iso_27001-2013:
    - A.14.2.5
    - A.8.1.3
  - mitre_techniques:
    - T1003
    - T1011
    - T1015
    - T1017
    - T1019
    - T1028
    - T1034
    - T1035
    - T1036
    - T1037
    - T1044
    - T1047
    - T1051
    - T1053
    - T1054
    - T1055
    - T1058
    - T1067
    - T1070
    - T1072
    - T1073
    - T1075
    - T1076
    - T1077
    - T1078
    - T1080
    - T1081
    - T1084
    - T1086
    - T1087
    - T1088
    - T1089
    - T1092
    - T1096
    - T1097
    - T1098
    - T1100
    - T1110
    - T1112
    - T1130
    - T1133
    - T1134
    - T1136
    - T1137
    - T1138
    - T1139
    - T1142
    - T1145
    - T1146
    - T1147
    - T1148
    - T1150
    - T1156
    - T1157
    - T1165
    - T1166
    - T1169
    - T1173
    - T1174
    - T1175
    - T1176
    - T1177
    - T1178
    - T1184
    - T1187
    - T1190
    - T1196
    - T1197
    - T1198
    - T1199
    - T1200
    - T1201
    - T1206
    - T1208
    - T1209
    - T1210
    - T1214
    - T1215
    - T1218
    - T1485
    - T1486
    - T1487
    - T1488
    - T1489
    - T1490
    - T1491
    - T1492
    - T1494
    - T1495
    - T1501
    - T1503
    - T1504
    - T1505
    - T1506
    - T1525
    - T1530
    - T1535
    - T1537
    - T1539
  - nist_sp_800-53:
    - AU-2
    - CM-1
    - CM-2
    - CM-6
    - CM-7
    - IA-5
    - IA-6
    - SC-20
    - SC-21
  - pci_dss_v3.2.1:
    - '2.2'
  condition: all
  rules:
  - f:/root/.bash_profile -> r:umask && r:0027|0077
  - f:/root/.bashrc -> r:umask && r:0027|0077
- id: 36184
  title: Ensure all groups in /etc/passwd exist in /etc/group.
  description: Over time, system administration errors and changes can lead to groups
    being defined in /etc/passwd but not in /etc/group.
  rationale: Groups defined in the /etc/passwd file but not in the /etc/group file
    pose a threat to system security since group permissions are not properly managed.
  remediation: Analyze the output of the Audit step above and perform the appropriate
    action to correct any discrepancies found.
  compliance:
  - cis:
    - 6.2.15
  - cis_csc_v7:
    - '16'
  condition: all
  rules:
  - f:/etc/group -> !r:^# && r:shadow:\w*:\d+:$
- id: 36185
  title: Ensure no duplicate UIDs exist.
  description: Although the useradd program will not let you create a duplicate User
    ID (UID), it is possible for an administrator to manually edit the /etc/passwd
    file and change the UID field.
  rationale: Users must be assigned unique UIDs for accountability and to ensure appropriate
    access protections.
  remediation: Based on the results of the audit script, establish unique UIDs and
    review all files owned by the shared UIDs to determine which UID they are supposed
    to belong to.
  compliance:
  - cis:
    - 6.2.16
  - cis_csc_v7:
    - '16'
  condition: all
  rules:
  - c:sh -c "cut -f3 -d\":\" /etc/passwd | sort | uniq -dc | wc -l" -> n:^(\p*\d+)$
    compare == 0
- id: 36186
  title: Ensure no duplicate GIDs exist.
  description: Although the groupadd program will not let you create a duplicate Group
    ID (GID), it is possible for an administrator to manually edit the /etc/group
    file and change the GID field.
  rationale: User groups must be assigned unique GIDs for accountability and to ensure
    appropriate access protections.
  remediation: 'Based on the results of the audit script, establish unique GIDs and
    review all files owned by the shared GID to determine which group they are supposed
    to belong to. Notes: You can also use the grpck command to check for other inconsistencies
    in the /etc/group file.'
  compliance:
  - cis:
    - 6.2.17
  - cis_csc_v7:
    - '16'
  condition: all
  rules:
  - c:sh -c "cut -f3 -d\":\" /etc/group | sort | uniq -dc | wc -l" -> n:^(\p*\d+)$
    compare == 0
- id: 36187
  title: Ensure no duplicate user names exist.
  description: Although the useradd program will not let you create a duplicate user
    name, it is possible for an administrator to manually edit the /etc/passwd file
    and change the user name.
  rationale: If a user is assigned a duplicate user name, it will create and have
    access to files with the first UID for that username in /etc/passwd . For example,
    if "test4" has a UID of 1000 and a subsequent "test4" entry has a UID of 2000,
    logging in as "test4" will use UID 1000. Effectively, the UID is shared, which
    is a security problem.
  remediation: Based on the results of the audit script, establish unique user names
    for the users. File ownerships will automatically reflect the change as long as
    the users have unique UIDs.
  compliance:
  - cis:
    - 6.2.18
  - cis_csc_v7:
    - '16'
  condition: all
  rules:
  - c:sh -c "cut -f1 -d\":\" /etc/passwd | sort | uniq -dc | wc -l" -> n:^(\p*\d+)$
    compare == 0
- id: 36188
  title: Ensure no duplicate group names exist.
  description: Although the groupadd program will not let you create a duplicate group
    name, it is possible for an administrator to manually edit the /etc/group file
    and change the group name.
  rationale: If a group is assigned a duplicate group name, it will create and have
    access to files with the first GID for that group in /etc/group . Effectively,
    the GID is shared, which is a security problem.
  remediation: Based on the results of the audit script, establish unique names for
    the user groups. File group ownerships will automatically reflect the change as
    long as the groups have unique GIDs.
  compliance:
  - cis:
    - 6.2.19
  - cis_csc_v7:
    - '16'
  condition: all
  rules:
  - c:sh -c "cut -f1 -d\":\" /etc/group | sort | uniq -dc | wc -l" -> n:^(\p*\d+)$
    compare == 0
- id: 36189
  title: Ensure shadow group is empty.
  description: The shadow group allows system programs which require access the ability
    to read the /etc/shadow file. No users should be assigned to the shadow group.
  rationale: Any users assigned to the shadow group would be granted read access to
    the /etc/shadow file. If attackers can gain read access to the /etc/shadow file,
    they can easily run a password cracking program against the hashed passwords to
    break them. Other security information that is stored in the /etc/shadow file
    (such as expiration) could also be useful to subvert additional user accounts.
  remediation: Remove all users from the shadow group, and change the primary group
    of any users with shadow as their primary group.
  compliance:
  - cis:
    - 6.2.20
  - cis_csc_v7:
    - '5.1'
  - cmmc_v2.0:
    - AC.1.002
    - CM.2.061
    - SC.3.180
  - iso_27001-2013:
    - A.14.2.5
    - A.8.1.3
  - mitre_techniques:
    - T1003
    - T1011
    - T1015
    - T1017
    - T1019
    - T1028
    - T1034
    - T1035
    - T1036
    - T1037
    - T1044
    - T1047
    - T1051
    - T1053
    - T1054
    - T1055
    - T1058
    - T1067
    - T1070
    - T1072
    - T1073
    - T1075
    - T1076
    - T1077
    - T1078
    - T1080
    - T1081
    - T1084
    - T1086
    - T1087
    - T1088
    - T1089
    - T1092
    - T1096
    - T1097
    - T1098
    - T1100
    - T1110
    - T1112
    - T1130
    - T1133
    - T1134
    - T1136
    - T1137
    - T1138
    - T1139
    - T1142
    - T1145
    - T1146
    - T1147
    - T1148
    - T1150
    - T1156
    - T1157
    - T1165
    - T1166
    - T1169
    - T1173
    - T1174
    - T1175
    - T1176
    - T1177
    - T1178
    - T1184
    - T1187
    - T1190
    - T1196
    - T1197
    - T1198
    - T1199
    - T1200
    - T1201
    - T1206
    - T1208
    - T1209
    - T1210
    - T1214
    - T1215
    - T1218
    - T1485
    - T1486
    - T1487
    - T1488
    - T1489
    - T1490
    - T1491
    - T1492
    - T1494
    - T1495
    - T1501
    - T1503
    - T1504
    - T1505
    - T1506
    - T1525
    - T1530
    - T1535
    - T1537
    - T1539
  - nist_sp_800-53:
    - AU-2
    - CM-1
    - CM-2
    - CM-6
    - CM-7
    - IA-5
    - IA-6
    - SC-20
    - SC-21
  - pci_dss_v3.2.1:
    - '2.2'
  condition: all
  rules:
  - f:/etc/group -> !r:^# && r:^shadow:\w*:\d+:$
- id: 36094
  title: Ensure /etc/hosts.deny is configured.
  description: The /etc/hosts.deny file specifies which IP addresses are not permitted
    to connect to the host. It is intended to be used in conjunction with the /etc/hosts.allow
    file.
  rationale: The /etc/hosts.deny file serves as a failsafe so that any host not specified
    in /etc/hosts.allow is denied access to the system.
  remediation: 'Run the following command to create /etc/hosts.deny: # echo "ALL:
    ALL" >> /etc/hosts.deny Notes: Contents of the /etc/hosts.deny file may include
    additional options depending on your network configuration.'
  compliance:
  - cis:
    - 3.3.3
  - cis_csc_v7:
    - '9.4'
  - cmmc_v2.0:
    - CM.3.068
  - iso_27001-2013:
    - A.13.1.1
  - pci_dss_v3.2.1:
    - '1.4'
  condition: all
  rules:
  - f:/etc/hosts.deny
  - 'f:/etc/hosts.deny -> r:^ALL: ALL$'
- id: 36095
  title: Ensure permissions on /etc/hosts.allow are configured.
  description: The /etc/hosts.allow file contains networking information that is used
    by many applications and therefore must be readable for these applications to
    operate.
  rationale: It is critical to ensure that the /etc/hosts.allow file is protected
    from unauthorized write access. Although it is protected by default, the file
    permissions could be changed either inadvertently or through malicious actions.
  remediation: 'Run the following commands to set permissions on /etc/hosts.allow:
    # chown root:root /etc/hosts.allow # chmod 644 /etc/hosts.allow.'
  compliance:
  - cis:
    - 3.3.4
  - cis_csc_v7:
    - '5.1'
  - cmmc_v2.0:
    - AC.1.002
    - CM.2.061
    - SC.3.180
  - iso_27001-2013:
    - A.14.2.5
    - A.8.1.3
  - mitre_techniques:
    - T1003
    - T1011
    - T1015
    - T1017
    - T1019
    - T1028
    - T1034
    - T1035
    - T1036
    - T1037
    - T1044
    - T1047
    - T1051
    - T1053
    - T1054
    - T1055
    - T1058
    - T1067
    - T1070
    - T1072
    - T1073
    - T1075
    - T1076
    - T1077
    - T1078
    - T1080
    - T1081
    - T1084
    - T1086
    - T1087
    - T1088
    - T1089
    - T1092
    - T1096
    - T1097
    - T1098
    - T1100
    - T1110
    - T1112
    - T1130
    - T1133
    - T1134
    - T1136
    - T1137
    - T1138
    - T1139
    - T1142
    - T1145
    - T1146
    - T1147
    - T1148
    - T1150
    - T1156
    - T1157
    - T1165
    - T1166
    - T1169
    - T1173
    - T1174
    - T1175
    - T1176
    - T1177
    - T1178
    - T1184
    - T1187
    - T1190
    - T1196
    - T1197
    - T1198
    - T1199
    - T1200
    - T1201
    - T1206
    - T1208
    - T1209
    - T1210
    - T1214
    - T1215
    - T1218
    - T1485
    - T1486
    - T1487
    - T1488
    - T1489
    - T1490
    - T1491
    - T1492
    - T1494
    - T1495
    - T1501
    - T1503
    - T1504
    - T1505
    - T1506
    - T1525
    - T1530
    - T1535
    - T1537
    - T1539
  - nist_sp_800-53:
    - AU-2
    - CM-1
    - CM-2
    - CM-6
    - CM-7
    - IA-5
    - IA-6
    - SC-20
    - SC-21
  - pci_dss_v3.2.1:
    - '2.2'
  condition: all
  rules:
  - c:stat -Lc "%a %A %u %U %g %G" /etc/hosts.allow -> r:644 && r:0 root 0 root
- id: 36096
  title: Ensure permissions on /etc/hosts.deny are configured.
  description: The /etc/hosts.deny file contains network information that is used
    by many system applications and therefore must be readable for these applications
    to operate.
  rationale: It is critical to ensure that the /etc/hosts.deny file is protected from
    unauthorized write access. Although it is protected by default, the file permissions
    could be changed either inadvertently or through malicious actions.
  remediation: 'Run the following commands to set permissions on /etc/hosts.deny :
    # chown root:root /etc/hosts.deny # chmod 644 /etc/hosts.deny.'
  compliance:
  - cis:
    - 3.3.5
  - cis_csc_v7:
    - '5.1'
  - cmmc_v2.0:
    - AC.1.002
    - CM.2.061
    - SC.3.180
  - iso_27001-2013:
    - A.14.2.5
    - A.8.1.3
  - mitre_techniques:
    - T1003
    - T1011
    - T1015
    - T1017
    - T1019
    - T1028
    - T1034
    - T1035
    - T1036
    - T1037
    - T1044
    - T1047
    - T1051
    - T1053
    - T1054
    - T1055
    - T1058
    - T1067
    - T1070
    - T1072
    - T1073
    - T1075
    - T1076
    - T1077
    - T1078
    - T1080
    - T1081
    - T1084
    - T1086
    - T1087
    - T1088
    - T1089
    - T1092
    - T1096
    - T1097
    - T1098
    - T1100
    - T1110
    - T1112
    - T1130
    - T1133
    - T1134
    - T1136
    - T1137
    - T1138
    - T1139
    - T1142
    - T1145
    - T1146
    - T1147
    - T1148
    - T1150
    - T1156
    - T1157
    - T1165
    - T1166
    - T1169
    - T1173
    - T1174
    - T1175
    - T1176
    - T1177
    - T1178
    - T1184
    - T1187
    - T1190
    - T1196
    - T1197
    - T1198
    - T1199
    - T1200
    - T1201
    - T1206
    - T1208
    - T1209
    - T1210
    - T1214
    - T1215
    - T1218
    - T1485
    - T1486
    - T1487
    - T1488
    - T1489
    - T1490
    - T1491
    - T1492
    - T1494
    - T1495
    - T1501
    - T1503
    - T1504
    - T1505
    - T1506
    - T1525
    - T1530
    - T1535
    - T1537
    - T1539
  - nist_sp_800-53:
    - AU-2
    - CM-1
    - CM-2
    - CM-6
    - CM-7
    - IA-5
    - IA-6
    - SC-20
    - SC-21
  - pci_dss_v3.2.1:
    - '2.2'
  condition: all
  rules:
  - c:stat -Lc "%a %A %u %U %g %G" /etc/hosts.deny -> r:644 && r:0 root 0 root
- id: 36059
  title: Ensure chrony is configured.
  description: chrony is a daemon which implements the Network Time Protocol (NTP)
    is designed to synchronize system clocks across a variety of systems and use a
    source that is highly accurate. More information on chrony can be found at http://chrony.tuxfamily.org/.
    chrony can be configured to be a client and/or a server.
  rationale: If chrony is in use on the system proper configuration is vital to ensuring
    time synchronization is working properly. This recommendation only applies if
    chrony is in use on the system.
  remediation: 'Add or edit server or pool lines to /etc/chrony.conf as appropriate:
    server <remote-server> Configure chrony to run as the chrony user by configuring
    the appropriate startup script for your distribution. Startup scripts are typically
    stored in /etc/init.d or /etc/systemd.'
  compliance:
  - cis:
    - 2.2.1.3
  - cis_csc_v7:
    - '6.1'
  - cmmc_v2.0:
    - AU.2.043
  - iso_27001-2013:
    - A.12.4.4
  - nist_sp_800-53:
    - AU-8
  - pci_dss_v3.2.1:
    - '10.4'
  condition: all
  rules:
  - f:/etc/chrony.conf
  - f:/etc/chrony.conf -> r:^\s*\t*server|^\s*\t*pool
