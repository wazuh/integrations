<group name="beyondinsight_password_safe,">

  <!-- Rule 100000 - Parent rule for all BeyondInsight Password Safe events. -->
  <rule id="100000" level="3">
    <decoded_as>json</decoded_as>
    <field name="event.module">beyondinsight_password_safe</field>
    <description>BeyondInsight Password Safe event detected.</description>
  </rule>

  <!-- Rule 100001 - Rule for BeyondInsight asset logs. -->
  <rule id="100001" level="6">
    <if_sid>100000</if_sid>
    <field name="data_stream.dataset" type="pcre2">beyondinsight_password_safe\.asset</field>
    <description>BeyondInsight Password Safe Asset log event from $(beyondinsight_password_safe.asset.asset_name)</description>
  </rule>

  <!-- Rule 100002 - Rule for BeyondInsight managed account logs. -->
  <rule id="100002" level="6">
    <if_sid>100000</if_sid>
    <field name="data_stream.dataset" type="pcre2">beyondinsight_password_safe\.managedaccount</field>
    <description>BeyondInsight Password Safe Managed Account event for $(beyondinsight_password_safe.managedaccount.account_name)</description>
  </rule>

  <!-- Rule 100003 - Rule for BeyondInsight managed system logs. -->
  <rule id="100003" level="6">
    <if_sid>100000</if_sid>
    <field name="data_stream.dataset" type="pcre2">beyondinsight_password_safe\.managedsystem</field>
    <description>BeyondInsight Password Safe Managed System event for $(beyondinsight_password_safe.managedsystem.system_name)</description>
  </rule>

  <!-- Rule 100004 - Rule for BeyondInsight session logs (Informational). -->
  <rule id="100004" level="4">
    <if_sid>100000</if_sid>
    <field name="data_stream.dataset" type="pcre2">beyondinsight_password_safe\.session</field>
    <description>BeyondInsight Password Safe Session event for $(beyondinsight_password_safe.session.managed_account_name) on host $(beyondinsight_password_safe.session.asset_name)</description>
  </rule>

  <!-- Rule 100005 - Rule for BeyondInsight user audit logs (Informational - Login). -->
  <rule id="100005" level="7">
    <if_sid>100000</if_sid>
    <field name="data_stream.dataset" type="pcre2">beyondinsight_password_safe\.useraudit</field>
    <field name="beyondinsight_password_safe.useraudit.action_type">Login</field>
    <description>BeyondInsight Password Safe user $(beyondinsight_password_safe.useraudit.user_name) logged in from $(host.ip)</description>
  </rule>

</group>