<group name="aws_mq,">

  <!-- General Rules for AWS Amazon MQ -->

  <!-- Rule 100100: General rule for ActiveMQ audit logs. -->
  <rule id="100100" level="3">
    <if_sid>0</if_sid>
    <field name="data_stream.dataset">aws_mq.activemq_audit_logs</field>
    <description>AWS Amazon MQ ActiveMQ audit log detected.</description>
  </rule>

  <!-- Rule 100101: General rule for ActiveMQ general logs. -->
  <rule id="100101" level="3">
    <if_sid>0</if_sid>
    <field name="data_stream.dataset">aws_mq.activemq_general_logs</field>
    <description>AWS Amazon MQ ActiveMQ general log detected.</description>
  </rule>

  <!-- Rule 100102: General rule for RabbitMQ general logs. -->
  <rule id="100102" level="3">
    <if_sid>0</if_sid>
    <field name="data_stream.dataset">aws_mq.rabbitmq_general_logs</field>
    <description>AWS Amazon MQ RabbitMQ general log detected.</description>
  </rule>

  <!-- Rule 100103: General rule for ActiveMQ metrics logs. -->
  <rule id="100103" level="3">
    <if_sid>0</if_sid>
    <field name="data_stream.dataset">aws_mq.activemq_metrics</field>
    <description>AWS Amazon MQ ActiveMQ metrics log detected.</description>
  </rule>

  <!-- Rule 100104: General rule for RabbitMQ metrics logs. -->
  <rule id="100104" level="3">
    <if_sid>0</if_sid>
    <field name="data_stream.dataset">aws_mq.rabbitmq_metrics</field>
    <description>AWS Amazon MQ RabbitMQ metrics log detected.</description>
  </rule>


  <!-- Rule 100105: ActiveMQ login failure. -->
  <rule id="100105" level="8">
    <if_sid>100101</if_sid>
    <field name="message">Failed to add Connection</field>
    <description>Authentication failure on AWS Amazon MQ ActiveMQ.</description>
  </rule>

  <!-- Rule 100106: RabbitMQ TLS Protocol Version alert. -->
  <rule id="100106" level="7">
    <if_sid>100102</if_sid>
    <field name="message">TLS server: In state</field>
    <description>RabbitMQ TLS Protocol Version alert detected.</description>
  </rule>


</group>