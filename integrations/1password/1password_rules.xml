<group name="1password,">

  <!-- 1Password Audit Events -->
  <rule id="100000" level="0">
    <if_sid>0</if_sid>
    <field name="data_stream.dataset">1password.audit_events</field>
    <description>1Password: Audit Event.</description>
    <group>1password_audit,</group>
  </rule>

  <rule id="100001" level="9">
    <if_sid>100000</if_sid>
    <field name="event.action">suspend</field>
    <description>1Password: User account $(onepassword.object_uuid) suspended by actor $(user.id) from $(source.ip).</description>
    <group>account_management,suspension,</group>
  </rule>

  <rule id="100002" level="7">
    <if_sid>100000</if_sid>
    <field name="event.action">create|delete|update</field>
    <description>1Password: $(event.action) action on $(onepassword.object_type) $(onepassword.object_uuid) by actor $(user.id) from $(source.ip).</description>
    <group>account_management,policy_change,</group>
  </rule>

  <!-- 1Password Item Usages -->
  <rule id="100100" level="0">
    <if_sid>0</if_sid>
    <field name="data_stream.dataset">1password.item_usages</field>
    <description>1Password: Item Usage Event.</description>
    <group>1password_item_usage,</group>
  </rule>

  <rule id="100101" level="8">
    <if_sid>100100</if_sid>
    <field name="event.action">reveal</field>
    <description>1Password: Sensitive item $(onepassword.item_uuid) revealed by user $(user.email) from $(source.ip) using $(onepassword.client.app_name).</description>
    <group>sensitive_data_access,</group>
  </rule>

  <rule id="100102" level="6">
    <if_sid>100100</if_sid>
    <field name="event.action">copy|fill</field>
    <description>1Password: Item $(onepassword.item_uuid) $(event.action)ed by user $(user.email) from $(source.ip) using $(onepassword.client.app_name).</description>
    <group>sensitive_data_access,</group>
  </rule>

  <!-- 1Password Sign-in Attempts -->
  <rule id="100200" level="0">
    <if_sid>0</if_sid>
    <field name="data_stream.dataset">1password.signin_attempts</field>
    <description>1Password: Sign-in Attempt Event.</description>
    <group>1password_signin,</group>
  </rule>

  <rule id="100201" level="3">
    <if_sid>100200</if_sid>
    <field name="event.action">success</field>
    <description>1Password: Successful sign-in for user $(user.email) from $(source.ip) using $(onepassword.client.app_name).</description>
    <group>authentication_success,</group>
  </rule>

  <rule id="100202" level="7">
    <if_sid>100200</if_sid>
    <field name="event.action">failure</field>
    <description>1Password: Failed sign-in attempt for user $(user.email) from $(source.ip) using $(onepassword.client.app_name).</description>
    <group>authentication_failure,</group>
  </rule>

  <rule id="100203" level="10" frequency="6" timeframe="120" ignore="120">
    <if_matched_sid>100202</if_matched_sid>
    <same_source_ip />
    <description>1Password: Multiple failed sign-in attempts from $(source.ip).</description>
    <group>authentication_bruteforce,gdpr_IV_35.7.d,pci_dss_10.2.4,pci_dss_10.2.5,pci_dss_10.6.1,</group>
  </rule>

  <rule id="100204" level="10" frequency="6" timeframe="120" ignore="120">
    <if_matched_sid>100202</if_matched_sid>
    <same_field>user.email</same_field>
    <description>1Password: Multiple failed sign-in attempts for user $(user.email).</description>
    <group>authentication_bruteforce,gdpr_IV_35.7.d,pci_dss_10.2.4,pci_dss_10.2.5,pci_dss_10.6.1,</group>
  </rule>

</group>