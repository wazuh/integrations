<group name="azure,">

  <!-- Rule 100000: General rule for all Azure logs. -->
  <rule id="100000" level="3">
    <if_sid>0</if_sid>
    <field name="service.type">azure</field>
    <description>Azure log detected</description>
  </rule>

  <!-- Rule 100001: Rule for Azure App Insights logs. -->
  <!-- This rule extends the general Azure log rule. -->
  <rule id="100001" level="5">
    <if_sid>100000</if_sid>
    <field name="data_stream.dataset">azure.app_insights</field>
    <description>Azure App Insights log received.</description>
  </rule>

  <!-- Rule 100002: Rule for Azure App State logs. -->
  <!-- This rule also extends the general Azure log rule. -->
  <rule id="100002" level="5">
    <if_sid>100000</if_sid>
    <field name="data_stream.dataset">azure.app_state</field>
    <description>Azure App State log received.</description>
  </rule>

  <!-- Rule 100003: More specific rule for a particular App Insights request. -->
  <!-- This rule extends the App Insights rule and is triggered by a specific request name. -->
  <rule id="100003" level="7">
    <if_sid>100001</if_sid>
    <field name="azure.dimensions.request_name">GET Home/Index</field>
    <description>Azure App Insights GET Home/Index request detected.</description>
  </rule>

</group>