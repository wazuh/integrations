<group name="azure_openai,">

  <!-- A general rule for all Azure OpenAI logs to act as a parent for specific rules. -->
  <rule id="100001" level="3">
    <if_sid>0</if_sid>
    <match>azure</match>
    <description>Azure OpenAI log received.</description>
  </rule>


  <!-- General rule for any Azure OpenAI API call (RequestResponse category). -->
  <rule id="100002" level="4">
    <if_sid>100001</if_sid>
    <field name="azure.open_ai.category">RequestResponse</field>
    <description>Azure OpenAI API call detected: $(azure.open_ai.operation_name) from $(azure.open_ai.caller_ip_address).</description>
  </rule>

  <!-- Rule to alert on successful 'Create_Thread' API calls. -->
  <rule id="100003" level="5">
    <if_sid>100002</if_sid>
    <field name="azure.open_ai.operation_name">Create_Thread</field>
    <field name="azure.open_ai.result_signature">200</field>
    <description>Azure OpenAI API call 'Create_Thread' was successful.</description>
  </rule>

  
  <!-- A specific rule for the 'monitor' metricset logs. -->
  <rule id="100005" level="3">
    <if_sid>100001</if_sid>
    <field name="metricset.name">monitor</field>
    <description>Azure OpenAI monitor metric log received.</description>
  </rule>

</group>